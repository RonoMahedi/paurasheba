// $Id: $
/**
 * IMPORTANT NOTE: This compressed js file includes Zoho Forms Forms/Report live js.
 */
function ZFFormulaCondition(){this.fieldLinkName,this.operator,this.condValue,this.is_subform_child=!1,this.result=!1,this.group_name}var ZFFormulaConstants={VALUE:"value",FIELD_LINK_NAME:"field_link_name",COMP_OPER:"comparison_oper",LOGICAL_OPER:"logical_oper",CONDITIONS:"conditions",EXPRESSIONS:"expressions",EXPRESSION:"expression",LINK_NAME:"link_name",IS_SUBFORM_CHILD:"is_subform_child",OPERATOR:"operator",RESULT:"result",CONDN_VALUE:"condValue",FieldLinkName:"fieldLinkName",ROW_LINK_NAME:"row",OPT_GROUP_NAME:"group_name"},ZFLive=new function(){this.portalName,this.formLinkName,this.fileUploadFields=[],this.valueJson={},this.fetchedLatitude="",this.fetchedLongitude="",this.isReqFromMobile=!1,this.isFormAdmin,this.storedFiles={},this.allImageType=["jpeg","jpg","gif","png","tif","tiff","webp","jfif","ico"],this.sfUniqueValidator={}},ZFLiveErrorConstants={mandatoryerror:i18n.entervalue,mandatoryerrornumber:i18n.entervaluenumber,mandatoryerrorcaptcha:i18n.entervaluecaptcha,mandatoryerrorrecaptcha:i18n.entervaluerecaptcha,emailerror:i18n.entervalidmail,numbererror:i18n.entervalidnumber,decimalerror:i18n.invaliddecimal,invalidcurrency:i18n.invalidcurrency,decimallengtherror:i18n.moredecimalplaces,urlerror:i18n.invalidurl,phoneformaterror:i18n.invalidphone,phoneinitialvalueerror:i18n.invalidinitialphone,invalidUSAphone:i18n.invalidUSAphone,countrycodeformaterror:i18n.invalidcountrycode,choicemandatoryerror:i18n.selectchoice,optionmandatoryerror:i18n.chooseoption,datemandatoryerror:i18n.selectdate,selectcountrycode:i18n.selectcountrycode,ratingmandatoryerror:i18n.selectrating,timemandatoryerror:i18n.selecttime,incompletetimeerror:i18n.incompleteinputtime,incompleteinputtimetwentyfour:i18n.incompleteinputtimetwentyfour,decisionmandatoryerror:i18n.checkfield,fileuploadmandatoryerror:i18n.choosefile,fileuploadlimiterror:i18n.filescountexceed,uploadsize:i18n.uploadsize,signaturemandatoryerror:i18n.incompletesignature,matrixchoicemandatoryerror:i18n.matrixchoicemandatory,checktcfield:i18n.checktcfield,maxchoicelimit:i18n.maxchoicelimit,minchoicelimit:i18n.minchoicelimit,fileuploadmaxsize:i18n.fileuploadmaxsize,alloweddomain:i18n.alloweddomain,restricteddomain:i18n.restricteddomain,minvalerror:i18n.minvalerror,maxvalerror:i18n.maxvalerror,maxcharlimit:i18n.maxcharlimit,mincharlimit:i18n.mincharlimit,maxwordlimit:i18n.maxwordlimit,mindatelimit:i18n.mindatelimit,maxdatelimit:i18n.maxdatelimit,disabledayslimit:i18n.disabledayslimit,mindigitslimit:i18n.mindigitslimit,maxdigitslimit:i18n.maxdigitslimit,invaliddate:i18n.invaliddate,invaliddatetime:i18n.invaliddatetime,mindatetimelimit:i18n.mindatetimelimit,maxdatetimelimit:i18n.maxdatetimelimit,minonecharlimit:i18n.minonecharlimit,minonewordlimit:i18n.minonewordlimit,maxonecharlimit:i18n.maxonecharlimit,maxonewordlimit:i18n.maxonewordlimit,minwordlimit:i18n.minwordlimit,emailsdonotmatch:i18n.emailsdonotmatch,phonenosdonotmatch:i18n.phonenosdonotmatch,recaptchaerror:i18n.recaptchaerror,uploadservererror:i18n.uploadservererror,phoneformatnumeronlyerror:i18n.phoneformatnumeronlyerror,uploadservererror:i18n.uploadservererror,matrixtextinputlimit:i18n.matrixtextinputlimit,matrixchoicetextboxmandatory:i18n.matrixchoicetextboxmandatory},ZFSubFormFldLiveConstants={IS_SUBFORM_CHILD:"isSubFormChild"},ZFLiveConstants={VERIFICATIONCODE:{KEY:"verificationcode",DIGEST:"digest",CAPTCHAVAL:"captchavalue"},RESPONSE:{ERRORS:"errors",ERROR:"error",UNDEFINED:"undefined",FORM_STATUS:"form_status"},RECAPTCHA:{ERROR_CBOX:"verification_recaptchacbox",ERROR_INV:"verification_recaptchainv",CHECKBOX:"recaptchacbox",INVISIBLE:"recaptchainv"}};function focusFirstLiElemOnLoad(){var liToBeFocussed=$("#formBodyDiv").find("li[elname=livefield-elem]:visible").first(),compType=parseInt($(liToBeFocussed).attr("comptype"));if(isNaN(compType))if("PaymentAmount"==$(liToBeFocussed).attr("compname")&&0!=$(liToBeFocussed).find("input:enabled").length)$(liToBeFocussed).find("input:enabled:first").focus();else{var elemType=$(liToBeFocussed).attr("elemtype");if(void 0!==elemType&&"subFormField"==elemType)if("1"==$(liToBeFocussed).attr("viewtype")){var sfUls=$(liToBeFocussed).find('[elname="subFormFieldsUl"]');sfUls.length>0&&(liToBeFocussed=$(sfUls).find("li[elname=livefield-elem]:visible").first(),compType=parseInt($(liToBeFocussed).attr("comptype")),isNaN(compType)||focusFirstFieldLiElemOnLoad(liToBeFocussed,compType))}}else compType!=ZFFieldTypeConstants.DATE&&compType!=ZFFieldTypeConstants.DATETIME&&focusFirstFieldLiElemOnLoad(liToBeFocussed,compType)}function focusFirstFieldLiElemOnLoad(liToBeFocussed,compType){compType!=ZFFieldTypeConstants.DATE&&compType!=ZFFieldTypeConstants.DATETIME&&(compType==ZFFieldTypeConstants.ADDRESS?0==$(liToBeFocussed).find("span:first").find("select").length?$(liToBeFocussed).find("input:first").focus():$(liToBeFocussed).find("select:first").focus():compType===ZFFieldTypeConstants.ZOHO_CRM?ZFCrmLive.zfCrmLive.focusZohoCrmField(liToBeFocussed):0!=$(liToBeFocussed).find("input").length?$(liToBeFocussed).find("input:first").focus():compType===ZFFieldTypeConstants.TIME||compType===ZFFieldTypeConstants.DROPDOWN||compType===ZFFieldTypeConstants.MULTIPLE_CHOICE?$(liToBeFocussed).find("select:first").focus():compType===ZFFieldTypeConstants.MULTI_LINE?$(liToBeFocussed).find("textarea").focus():compType!==ZFFieldTypeConstants.RATING&&compType!==ZFFieldTypeConstants.SLIDER||$(liToBeFocussed).find("a:first").focus())}function disableButtonNotNeeded(){var fieldsCount=0;if($("#test").find("ul[elname=formBodyULName]").find("li").each(function(index,elem){null!=$(elem).attr("compname")&&(fieldsCount+=1)}),0==fieldsCount){var formElem=$("form[name=test]");$(formElem).find("button[elname=submit]").hide(),$(formElem).find("button[elname=save]").hide(),$(formElem).find("button[elname=review]").hide()}var descLiElem=$("#formBodyDiv").find("li[compname=HtmlText]");$(descLiElem).find(":button").prop("disabled",!0)}function addCustomCSSStyles(){if(!("opacity"in document.body.style))for(var customStyleTag=document.getElementById("CUSTOM_STYLE_TAG").styleSheet,rulesArrayInStyleTag=customStyleTag.rules,numOfRulesInStyleTag=rulesArrayInStyleTag.length,ruleIndex=0;ruleIndex<numOfRulesInStyleTag;ruleIndex++){var rule=rulesArrayInStyleTag[ruleIndex];if(null!==rule.selectorText&&"undefined"!=typeof rule.selectorText&&-1!==rule.selectorText.indexOf(":before")){var bgColor=rule.style.backgroundColor,opacity=(rule.style.backgroundImage,rule.style.opacity),pseudoSelector=rule.selectorText,selector=pseudoSelector.substring(0,pseudoSelector.indexOf(":")),opacityInHex=255*opacity,colorString="#"+(opacityInHex=convertDecToHex(opacityInHex))+bgColor.substring(1);if("-ms-filter"in document.body.style){var ie8FilterString='-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr='+colorString+",endColorstr="+colorString+')";';customStyleTag.addRule(selector,"background:transparent;"+ie8FilterString)}else{var ie7FilterString="filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="+colorString+",endColorstr="+colorString+");";customStyleTag.addRule(selector,"background:transparent;"+ie7FilterString+"zoom:1!important;")}customStyleTag.removeRule(ruleIndex),numOfRulesInStyleTag-=1}}"opacity"in document.body.style||"-ms-filter"in document.body.style||$(".inlineBlock").css("display","inline")}function constructNormalField(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("input").val())}function constructSignature(valueJson,elem){var linkName=$(elem).attr("compname"),signElem=document.getElementById("drawingCanvas-"+linkName),signWidth=signElem.width,signHeight=signElem.height,blankCanvas=document.createElement("canvas");blankCanvas.width=signWidth,blankCanvas.height=signHeight,blankCanvas.toDataURL()==signElem.toDataURL()?valueJson[linkName]="":valueJson[linkName]=signElem.toDataURL()}function constructTextArea(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("TextArea").val())}function constructDate(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("input").val())}function constructDateTime(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("input").val())}function constructTime(valueJson,elem){valueJson[$(elem).attr("compname")]=getTimeValueFromElem($(elem))}function getTimeValueFromElem(elem){var hours=$(elem).find('select[timecomp="hours"]').val(),minutes=$(elem).find('select[timecomp="minutes"]').val(),meridian=$(elem).find('select[timecomp="Meridiem"]').find("option:selected").attr("value");return""===hours||""===minutes||""===meridian?"":meridian===undefined?hours+":"+minutes:hours+":"+minutes+" "+meridian}function constructName(valueJson,elem){var namJsnObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namNw=$(elemnew).attr("complink"),val=$.trim($(elemnew).val()),elmid=$(elemnew).attr("id");namJsnObj[namNw]=elmid&&"-Select-"==val?"":val}),valueJson[$(elem).attr("compname")]=namJsnObj}function constructGeolocation(valueJson,elem){var geolocationJsonObj={};$(elem).find("input").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name");geolocationJsonObj[namenew]=$.trim($(elemnew).attr("value"))}),valueJson[$(elem).attr("compname")]=geolocationJsonObj}function constructAddress(valueJson,elem){var addressJsonObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namNw=$(elemnew).attr("complink"),val=$.trim($(elemnew).val()),elemid=$(elemnew).attr("id");addressJsonObj[namNw]=elemid&&"-Select-"==val?"":val}),valueJson[$(elem).attr("compname")]=addressJsonObj}function constructEmailField(valueJson,elem){$(elem).find("input").each(function(indexelem,elemnew){valueJson[$(elem).attr("compname")]=$.trim($(elemnew).val())})}function constructPhone(valueJson,elem){var phoneval="",linkName=$(elem).attr("compname");if($(elem).find("div[elname=phoneFld]").find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());phoneval+=val}),"true"==$(elem).find("input").attr("iscodeEnabled")){var countryCode="";""!=phoneval&&(countryCode=null!=(countryCode=$(elem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode)?"+"+countryCode:""),valueJson[linkName+"_country_code"]=countryCode}valueJson[linkName]=phoneval}function constructVerCodeField(valueJson,elem){var verCodeJson={},inputElem=$(elem).find("#verificationcodeTxt");$("#pop_captcha_li").is(":visible")&&(inputElem=$("#pop_captcha_li").find("#pop_captcha_input_id")),verCodeJson[ZFLiveConstants.VERIFICATIONCODE.DIGEST]=$(inputElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST),verCodeJson[ZFLiveConstants.VERIFICATIONCODE.CAPTCHAVAL]=$.trim($(inputElem).val()),valueJson[$(elem).attr("compname")]=verCodeJson}function constructDecimalField(valueJson,elem){var inpVal=$.trim($(elem).find("input").val()),decimalFormat=$(elem).attr("decimalformat");valueJson[$(elem).attr("compname")]=ZFUtil.getReformattedDecimal(inpVal,decimalFormat)}function getRatingClassName(ratingType){return 1===ratingType?"starON":2===ratingType?"lightON":3===ratingType?"shieldON":4===ratingType?"heartON":5===ratingType?"flagON":6===ratingType?"bulbON":void 0}function refreshRating(elem,ratingType){var parentElem=$(elem).parent();$(parentElem).find("a").each(function(index,elem){var name=$(elem).attr("name");$(elem).removeClass(getRatingClassName(ratingType)),$(elem).attr("elattr",""),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html("0"),$(elem).attr("value","")})}function mouseOverRating(elem,ratingElemCnt,totalCount,ratingType){var parentElem=$(elem).parent();$(parentElem).find("a").each(function(index,elem){if(index<ratingElemCnt){$(elem).addClass(getRatingClassName(ratingType));var name=$(elem).attr("name");$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(ratingElemCnt)}else $(elem).removeClass(getRatingClassName(ratingType))})}function mouseOutRating(elem,ratingElemCnt,totalCount,ratingType){var parentElem=$(elem).parent(),selCnt=$(parentElem).find("a[elattr=selected]").index();$(parentElem).find("a").each(function(index,elem){var name=$(elem).attr("name");selCnt>=index?($(elem).addClass(getRatingClassName(ratingType)),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(selCnt+1)):($(elem).removeClass(getRatingClassName(ratingType)),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(selCnt+1))})}function selectRating(elem,ratingElemCnt,totalCount,ratingType){var parentElem=$(elem).parent();$(elem).addClass("starON"),$(parentElem).find("a").each(function(index,elem){var name=$(elem).attr("name");$(elem).attr("elattr",""),index<ratingElemCnt&&($(elem).addClass(getRatingClassName(ratingType)),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(ratingElemCnt)),ratingElemCnt===index+1&&$(elem).attr("elattr","selected"),$(elem).attr("value",ratingElemCnt)})}function constructRating(valueJson,elem){var value="";$(elem).find("a").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");null!=val&&(value=val)}),valueJson[$(elem).attr("compname")]=value}function constructSlider(valueJson,elem){$(elem).find("div[name=slider]").each(function(index,elem){val=$(elem).attr("value")}),valueJson[$(elem).attr("compname")]=val}function constructDropdown(valueJson,elem,fldLinkName,fromReview){$(elem).find("select[name='"+fldLinkName+"']").each(function(indexelem,elemnew){"-Select-"==$(elemnew).val()?valueJson[$(elemnew).attr("name")]="":(valueJson[$(elemnew).attr("name")]=$(elemnew).val(),fromReview&&(valueJson[$(elemnew).attr("name")]=$(elemnew).find("option:selected").text()),$(elemnew).find("optgroup").length>0&&(valueJson[$(elemnew).attr("name")+"_group_name"]=fromReview?getGroupNameofSelectedChoice(elemnew,fldLinkName):getGroupValueofSelectedChoice(elemnew,fldLinkName)))})}function constructCheckBox(valueJson,elem,fromReview){var checkboxJsonArr=[];$(elem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&(fromReview?checkboxJsonArr.push($(elemnew).parent().find("label").text()):checkboxJsonArr.push(val))}),checkboxJsonArr.length>0?valueJson[$(elem).attr("compname")]=checkboxJsonArr:valueJson[$(elem).attr("compname")]=""}function constructRadio(valueJson,elem,fromReview){var value="";$(elem).find("input[type=radio]").each(function(indexelem,elemnew){$(elemnew).is(":checked")&&(value=$(elemnew).attr("allowothers")?$(elem).find("input[name=allow-others-text]").val():fromReview?$(elemnew).parent().find("label").text():$(elemnew).attr("value"))}),valueJson[$(elem).attr("compname")]=value}function constructMatrixChoice(valueJson,elem,fromReview){var matrixRowJson={},matrixRowArr=[],choiceType=$(elem).attr("choicetype");isValidMatrixChoiceType(choiceType)&&$(elem).find("tbody").find("tr").each(function(index1,elem1){var rowLinkName,matrxcolumnArr=[];if(choiceType==MatrixChoicesType.RADIO.CODE||choiceType==MatrixChoicesType.CHECKBOX.CODE?$(elem1).find("input:checked").each(function(index2,elem2){0==index2&&(rowLinkName=$(elem2).attr("name")),fromReview?matrxcolumnArr.push($(elem2).attr("columndisplay")):matrxcolumnArr.push($(elem2).attr("columnvalue"))}):choiceType==MatrixChoicesType.DROPDOWN.CODE?($(elem1).find("select").each(function(index2,elem2){0==index2&&(rowLinkName=$(elem2).attr("name"));var value=$.trim($(elem2).val());if(""!=value){var columnJson={};fromReview?(columnJson.columnname=$(elem2).attr("columndisplay"),columnJson.value=$(elem2).find("option:selected").text()):(columnJson.columnname=$(elem2).attr("columnvalue"),columnJson.value=value),matrxcolumnArr.push(columnJson)}}),fromReview||(rowLinkName+="-v1")):choiceType==MatrixChoicesType.TEXTBOX.CODE&&($(elem1).find("input").each(function(index2,elem2){0==index2&&(rowLinkName=$(elem2).attr("name"));var value=$.trim($(elem2).val());if(""!=value){var columnJson={};columnJson.columnname=fromReview?$(elem2).attr("columndisplay"):$(elem2).attr("columnvalue"),columnJson.value=value,matrxcolumnArr.push(columnJson)}}),fromReview||(rowLinkName+="-v1")),matrxcolumnArr.length>0&&(matrixRowJson[rowLinkName]=matrxcolumnArr),fromReview){var rowJson={};rowJson.row_link_name=rowLinkName,rowJson.qstn_name=$(elem1).find("th").text(),matrixRowArr.push(rowJson)}}),fromReview&&(valueJson.choice_type=choiceType,valueJson.rows=matrixRowArr),valueJson[$(elem).attr("compname")]=matrixRowJson}function constructMultiSelect(valueJson,elem,fromReview){var multiJsonArr=[];$(elem).find("select").each(function(indexelem,elemnew){for(var id=$(elemnew).attr("id"),txtSelectedObj=document.getElementById(id),i=0;i<txtSelectedObj.options.length;i++)if(txtSelectedObj.options[i].selected){multiJsonObj=new Object;var selectedVal=txtSelectedObj.options[i].value;fromReview&&(selectedVal=txtSelectedObj.options[i].text),multiJsonArr.push(selectedVal),0}multiJsonArr.length>0?valueJson[$(elem).attr("compname")]=multiJsonArr:valueJson[$(elem).attr("compname")]=""})}function constructDecision(valueJson,elem){$(elem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).is(":checked");val=val?"true":"false";var namenew=$(elemnew).attr("name");valueJson[namenew]=val})}function constructTCField(valueJson,elem,fromReview){var cbElem=$(elem).find("input[elname=statusCB]"),tcValue=$(cbElem).is(":checked")?"true":"false",namenew=$(cbElem).attr("name");if(fromReview)if("true"==tcValue){var statustext=$(elem).attr("statustext");valueJson[namenew]=statustext}else valueJson[namenew]="";else valueJson[namenew]=tcValue}function constructFileUpload(valueJson,elem){var filepatharr=[],namenew=$(elem).attr("compname");if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();""==(previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""))?valueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),valueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),valueJson[namenew+"-v1"]=filepatharr}else $(elem).find("input[elname="+$(elem).attr("compname")+"]").each(function(indexelem,elemnew){var value=$(elemnew).attr("filepath");if(""!=value){for(var splittedArr=value.split(","),index=0;index<splittedArr.length;index++)filepatharr.push(splittedArr[index]);valueJson[namenew+"-v1"]=filepatharr}else valueJson[namenew+"-v1"]=filepatharr})}function constructFileUpload_New(valueJson,elem){var filepatharr=[],namenew=$(elem).attr("compname");if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();""==(previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""))?valueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),valueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),valueJson[namenew+"-v1"]=filepatharr}else $(elem).find("ul[elname=fileElementUL]").find("li[elname!=templateFileElement]").each(function(index,elem){var value=$(elem).attr("uploadpath");typeof value!=ResponseKey.UNDEFINED&&""!=value&&filepatharr.push(value)}),valueJson[namenew+"-v2"]=filepatharr}function checkOthersBox(elem){$(elem).val().length>0?$(elem).parent().find("input[elname=radio-input]").prop("checked",!0):$(elem).parent().find("input[elname=radio-input]").prop("checked",!1)}function constructSignatureEdit(valueJson,elem,fromReview){var linkName=$(elem).attr("compname");if("none"==$("#signContainer-"+linkName).css("display")){var idVal="editsignContainer-"+linkName,imgId="img-"+linkName,srcElem=$(elem).find("div[id="+idVal+"]").find("img[id="+imgId+"]");valueJson[linkName]=fromReview?$(srcElem).attr("src"):$(srcElem).attr("value")}else constructSignature(valueJson,elem)}function constructPaymentFieldForUpdate(valueJson,elem){$(elem).find("select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name");valueJson[namenew]=$(elemnew).val()})}function constructPaymentField(valueJson,elem){var merchantType=$(elem).find("div[elname=merchantDiv]").attr("merchantType");if(null!=merchantType&&""!=merchantType){var paymentElem=$(elem).find("div[elname=paymentDetailsDiv]");$(paymentElem).find("input").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name");if(namenew==SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME){var payValue=$.trim($(elemnew).val());valueJson[namenew]=payValue}}),valueJson.merchant_type=merchantType}}function authNetResponseHandler(response){var paymentLi=$("#formBodyDiv").find(".pmnt"),paymentErrDiv=$(paymentLi).find("span[elname=authNetPaymentError]");if($("#paymentProcessingDiv").hide(),"Error"===response.messages.resultCode){for(var authNetErrMsg="",i=0;i<response.messages.message.length;i++)authNetErrMsg+=response.messages.message[i].text;ZFLive.enableSubmitBtn(),$(paymentLi).find("div[elname=authNetMerchantDiv]").addClass("error1"),$(paymentErrDiv).text(authNetErrMsg),animateErrorMsg(paymentErrDiv),showAndHidePage(paymentLi.parent().attr("page_no")),triggerFormResizeOnTimeOut(),focusFirstErrorElem(paymentLi),clearAuthNetCardData(),$("#pleaseWait_Div").hide(),cancelSubmitOrUpdateFormAction()}else $(paymentLi).find("div[elname=authNetMerchantDiv]").removeClass("error1"),$("#payment-error").hide(),useAuthNetOpaqueData(response.opaqueData),clearAuthNetCardData(),ZFLive.ValidateAndSubmitData()}function useAuthNetOpaqueData(opaqueData){var formBodyUL=$("#test").find("ul[elname=formBodyULName]");0==$("#authNetDataValue-li").length&&($(formBodyUL).last().append($('<li needdata="true" id="authNetDataValue-li" compname="authNetDataValue" mandatory="true"><input type="hidden" elname="authNetDataValue" /></li>')),$(formBodyUL).last().append($('<li needdata="true" id="authNetDataDescriptor-li" compname="authNetDataDescriptor" mandatory="true"><input type="hidden" elname="authNetDataDescriptor" /></li>'))),$(formBodyUL).find("input[elname=authNetDataValue]").val(opaqueData.dataValue),$(formBodyUL).find("input[elname=authNetDataDescriptor]").val(opaqueData.dataDescriptor)}function clearAuthNetCardData(){var authNetMerchantDiv=$("#formBodyDiv").find(".pmnt").find("div[elname=authNetMerchantDiv]");$(authNetMerchantDiv).find("input[elname=authNetAccNo]").val(""),$(authNetMerchantDiv).find("select[elname=authNetExpMonth] option:first").attr("selected","selected"),$(authNetMerchantDiv).find("select[elname=authNetExpYear] option:first").attr("selected","selected"),$(authNetMerchantDiv).find("input[elname=authNetCardCode]").val("")}function handlePaypalCkoutAction(respJson){setPopUpElemPosition($("#paypalCkoutActionDivCont")),$("#paypalCkoutActionDiv").show();var paypalCkIntentJson={};paypal.Buttons({style:{shape:"rect",color:"gold",layout:"vertical"},createOrder:function(data,actions){return respJson[ZFFormPayments.KEY.PAYMNT_ID_JSON][ZFFormPayments.PAYPAL_CKOUT.ORDERID]},onApprove:function(data,actions){return actions.order.capture().then(function(details){paypalCkIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=1,paypalCkoutStatusUpdate(details.id,paypalCkIntentJson,respJson)})},onError:function(err){paypalCkIntentJson[ZFLiveConstants.RESPONSE.ERROR]=err.message,paypalCkIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=2,paypalCkoutStatusUpdate(null,paypalCkIntentJson,respJson)},onCancel:function(data){paypalCkIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=3,paypalCkoutStatusUpdate(data.orderID,paypalCkIntentJson,respJson)}}).render("#paypalck-button-container")}function paypalCkoutStatusUpdate(orderID,paypalCkIntentJson,respJson){var sameFormUrl="";typeof respJson.same_form_url!==ResponseKey.UNDEFINED&&(sameFormUrl=respJson.same_form_url);var redirectURL=respJson.thankyou_page_URL,openRedirectURLIn=respJson.open_thankyou_page_URL_in,redirType=respJson.redirect_type,reqUri="/paypalckhdlr?custom="+respJson[ZFFormPayments.KEY.PAYMNT_ID_JSON][ZFFormPayments.KEY.REF_ID];null!=orderID&&(paypalCkIntentJson[ZFFormPayments.PAYPAL_CKOUT.ORDERID]=orderID);var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(paypalCkIntentJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){var paypalActDiv=$("#paypalCkoutActionDiv");paypalActDiv.hide(),paypalActDiv.find("#paypalck-button-container").html("");var paypalIntentResp=JSON.parse(jqXhr.responseText);if(200==jqXhr.status){if(6==paypalIntentResp.pmntstatusflag)performDefaultRedirection(redirectURL,openRedirectURLIn,sameFormUrl,ZFormType.FORMS,redirType);else if(4==paypalIntentResp.pmntstatusflag||5==paypalIntentResp.pmntstatusflag){for(var errMsg="",errArr=paypalIntentResp[ZFLiveConstants.RESPONSE.ERRORS],i=0;i<errArr.length;i++)for(var key in errArr[i])errMsg+=errArr[i][key];ZFLive.showPaymentFailRecordRetryErr(errMsg)}}else if(409==jqXhr.status||400==jqXhr.status){for(errMsg="",errArr=paypalIntentResp[ZFLiveConstants.RESPONSE.ERRORS],i=0;i<errArr.length;i++)for(var key in errArr[i])errMsg+=errArr[i][key];ZFLive.showPaymentFailRecordRetryErr(errMsg)}else ZFLive.showPaymentFailRecordRetryErr(paypalIntentResp)}};ZFUtil.sendAjax(ajaxOpts,this)}function stripeTokenHandler(result){var formBodyUL=$("#test").find("ul[elname=formBodyULName]");0==$("#stripeToken-li").length&&$(formBodyUL).last().append($('<li needdata="true" id="stripeToken-li" compname="stripeToken" mandatory="true"><input type="hidden" elname="stripeToken" /></li>')),$("#stripeToken-li").find("input[elname=stripeToken]").val(result.paymentMethod.id),ZFLive.stripeCard.clear(),ZFLive.ValidateAndSubmitData()}function fetchUserLocationSuccess(position){ZFLive.fetchedLatitude=parseFloat(position.coords.latitude).toFixed(7),ZFLive.fetchedLongitude=parseFloat(position.coords.longitude).toFixed(7)}function getSalesiqPhoneVal(elem){var salesIQPhone="";return $(elem).find("div[elname=phoneFld]").find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val()),isCountryCodeEnabled=$(elemnew).attr("iscodeenabled");if(isCountryCodeEnabled!=undefined&&"true"==isCountryCodeEnabled&&""!=val&&null!=val){var countryCode=$(elemnew).intlTelInput("getSelectedCountryData").dialCode;countryCode!=undefined&&(salesIQPhone="+"+countryCode)}salesIQPhone+=val}),salesIQPhone}function constructFormFieldDataJsonForSubmit(valueJson,elem){var comptype=parseInt($(elem).attr("comptype")),compname=$(elem).attr("compname");"subFormField"===$(elem).attr("elemtype")?(ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJson(valueJson,elem)):comptype===ZFFieldTypeConstants.ZOHO_CRM?ZFLive.mode===Mode.LIVE?ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(valueJson,elem,!1):ZFLive.mode===Mode.SAVED_RECORD&&ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(valueJson,elem,!0):compname==ZFFormPayments.STRIPE.TOKEN||compname==ZFFormPayments.AUTH_NET.DATA_VAL||compname==ZFFormPayments.AUTH_NET.DATA_DESC?constructNormalField(valueJson,elem):compname==SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME?constructPaymentField(valueJson,elem):constructFormFieldDataJsonCommon(valueJson,elem,!1)}function constructFormFieldDataJsonForSave(valueJson,elem){var comptype=parseInt($(elem).attr("comptype"));$(elem).attr("compname");"subFormField"===$(elem).attr("elemtype")?(ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJson(valueJson,elem)):comptype===ZFFieldTypeConstants.ZOHO_CRM?ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(valueJson,elem,!0):constructFormFieldDataJsonCommon(valueJson,elem,!1)}function constructFormFieldDataJsonCommon(valueJson,elem,fromReview){var comptype=parseInt($(elem).attr("comptype")),compname=$(elem).attr("compname");comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.WEBSITE?constructNormalField(valueJson,elem):comptype==ZFFieldTypeConstants.MULTI_LINE?constructTextArea(valueJson,elem):comptype==ZFFieldTypeConstants.DATE?constructDate(valueJson,elem):comptype===ZFFieldTypeConstants.DATETIME?constructDateTime(valueJson,elem):comptype==ZFFieldTypeConstants.TIME?constructTime(valueJson,elem):comptype==ZFFieldTypeConstants.NAME?constructName(valueJson,elem):comptype==ZFFieldTypeConstants.ADDRESS?constructAddress(valueJson,elem):comptype==ZFFieldTypeConstants.EMAIL?constructEmailField(valueJson,elem):comptype==ZFFieldTypeConstants.PHONE?constructPhone(valueJson,elem):comptype==ZFFieldTypeConstants.DROPDOWN?constructDropdown(valueJson,elem,compname,fromReview):comptype==ZFFieldTypeConstants.RADIO?constructRadio(valueJson,elem,fromReview):comptype==ZFFieldTypeConstants.CHECKBOX?constructCheckBox(valueJson,elem,fromReview):comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE?constructMultiSelect(valueJson,elem,fromReview):comptype==ZFFieldTypeConstants.DECISION_BOX?(fromReview&&(valueJson.display_name=$.trim($(elem).find("label").children("span").text())),constructDecision(valueJson,elem)):comptype==ZFFieldTypeConstants.TERMS_CONDITIONS?constructTCField(valueJson,elem,fromReview):comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD?fromReview?constructFileImageValForReview(valueJson,elem):ZFLive.isOldUploadType?constructFileUpload(valueJson,elem):constructFileUpload_New(valueJson,elem):comptype==ZFFieldTypeConstants.RATING?constructRating(valueJson,elem):comptype==ZFFieldTypeConstants.SLIDER?constructSlider(valueJson,elem):compname===ZFLiveConstants.VERIFICATIONCODE.KEY?constructVerCodeField(valueJson,elem):compname!==ZFLiveConstants.RECAPTCHA.CHECKBOX||getMSIEversion()<8?compname!==ZFLiveConstants.RECAPTCHA.INVISIBLE||getMSIEversion()<8?comptype==ZFFieldTypeConstants.SIGNATURE?constructSignatureEdit(valueJson,elem,fromReview):comptype==ZFFieldTypeConstants.GEOLOCATION?constructGeolocation(valueJson,elem):comptype==ZFFieldTypeConstants.IMAGE_CHOICE?constructImageChoiceField(valueJson,elem,fromReview):comptype==ZFFieldTypeConstants.MATRIX_CHOICE?constructMatrixChoice(valueJson,elem,fromReview):comptype!=ZFFieldTypeConstants.DECIMAL&&comptype!=ZFFieldTypeConstants.CURRENCY||constructDecimalField(valueJson,elem):ZFLive.valueJson["grecaptcha-inv"]=grecaptcha.getResponse():$("#pop_recaptchacbox-li").is(":visible")?ZFLive.valueJson["grecaptcha-cbox"]=grecaptcha.getResponse(ZFLive.popupReCaptcha):ZFLive.valueJson["grecaptcha-cbox"]=grecaptcha.getResponse()}function displaySplashMsg(){$("#splash_message_div").show(),$("#splash_message_div_cont").animate({opacity:"1",marginTop:"50"},600),$("#splash_message_div_cont").slideDown(500).delay(2e3).animate({opacity:"0.5",marginTop:"-50"},600).slideUp(500)}function setSplashMsg(finalHeight){$("#splash_message_div_cont").css("margin-top",finalHeight),$("#splash_message_div").fadeIn().delay(1e3).fadeOut()}function setFileClear(){var filePreviewDiv=$("#formDiv").find("li[elname=livefield-elem][comptype=19],li[elname=livefield-elem][comptype=32]");$(filePreviewDiv).each(function(idx,elem){var linkname=$(elem).attr("compname"),fileElementDiv=$("#formDiv").find("li[compname="+linkname+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)""!=$(fileElementDiv).attr("filepath")&&$(fileElementDiv[index]).find("div[elname=fileInputDiv]").attr("clearfile","false")})}function clearFilesOnError(){var fileList=$("#test").find("li[elname=livefield-elem][comptype=19],li[elname=livefield-elem][comptype=32]");$(fileList).each(function(idx,elem){var linkName=$(elem).attr("compname"),fileElementDiv=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++){var divFiles=$(fileElementDiv[index]).find("div[name=filePreviewDiv]"),singleFileDiv=$(fileElementDiv[index]).find("div[elname=fileInputDiv]");"true"==singleFileDiv.attr("clearfile")&&$(fileElementDiv[index]).attr("filepath",""),fileElem(singleFileDiv,divFiles,$(fileElementDiv[index]).attr("elname"))}})}function fileElem(singleFileDiv,divFiles,fldLinkName){if("true"==singleFileDiv.attr("clearfile")){singleFileDiv.show(),singleFileDiv.find("input[elname="+fldLinkName+"]").attr("filepath","");var inputFileEle=singleFileDiv.find("input[name="+fldLinkName+"]");inputFileEle.attr("value",""),inputFileEle.replaceWith(inputFileEle.clone());var hiddenInputElem=singleFileDiv.find("input[elname="+fldLinkName+"]");hiddenInputElem.attr("value",""),hiddenInputElem.attr("filepath",""),divFiles.hide(),divFiles.find("div[elname=filePathSpan]").text("")}}function performDefaultRedirection(redirectURL,openURL,sameFormUrl,formtype,redirType){openURL==OpenUrlWindowType.SAME_WINDOW?(1==document.getElementById("resizeform").value&&(redirType!=TYRedirectType.PLAIN_TEXT&&redirType!=TYRedirectType.RICH_TEXT&&redirType!=TYRedirectType.SAME_FORM&&redirType!=TYRedirectType.OTHER_FORM||(redirectURL=appendQueryString(redirectURL,"zf_rszfm=1"))),window.open(redirectURL,"_self")):openURL==OpenUrlWindowType.NEW_WINDOW?(window.open(redirectURL,"_blank"),0!==$.trim(sameFormUrl).length?(1==document.getElementById("resizeform").value&&(sameFormUrl=appendQueryString(sameFormUrl,"zf_rszfm=1")),window.open(sameFormUrl,"_self")):formtype===ZFormType.DOCSFORMS&&window.location.reload()):openURL==OpenUrlWindowType.PARENT_WINDOW&&window.open(redirectURL,"_parent")}function showInvalidEntriesMsg(errMsg){$("#errorMsgSpan").text(errMsg),$("#errorDiv").show(),$("#errorDiv").delay(2e3).fadeOut(300)}function showSavingElem(){var savingElem=$("#updateBtn").find("em[elem=loadingImgElem]");$(savingElem).show()}function hideSavingElem(){var savingElem=$("#updateBtn").find("em[elem=loadingImgElem]");$(savingElem).delay(500).hide(500)}function setPopUpElemPosition(elem){elem.css("position","absolute"),elem.css("top",Math.max(0,($(window).height()-elem.outerHeight())/3)+"px"),elem.css("left",Math.max(0,($(window).width()-elem.outerWidth())/2)+"px")}function setPopUpElemPositionNew(elem,refElem){elem.css("position","absolute"),window.top.location!==window.self.location&&$(window).height()>800?elem.css("top",Math.max(0,$(refElem).offset().top)+"px"):elem.css("top",Math.max(0,($(window).height()-elem.outerHeight())/3)+"px"),elem.css("left",Math.max(0,($(window).width()-elem.outerWidth())/2)+"px")}function setElemPositionForReview(elem){elem.css("position","absolute"),elem.css("top",Math.max(0,($(window).height()-elem.outerHeight())/16)+"px"),elem.css("left",Math.max(0,($(window).width()-elem.outerWidth())/2)+"px")}function checkMandatoryTime(idd){var id=$(idd).attr("id"),toReturn=!0;return $("#"+id).find("input,select").each(function(indexelem,elemnew){""!=$(elemnew).val()||(toReturn=!1)}),toReturn}function checkMandatoryReCaptcha(){return grecaptcha&&0!==grecaptcha.getResponse().length}function validateTime(idd){var id=$(idd).attr("id"),containsVal=!1;$("#"+id).find("input,select").each(function(indexelem,elemnew){"Meridiem"!=$(elemnew).attr("timecomp")&&""!=$(elemnew).val()&&(containsVal=!0)});var isValidTime=!0;return $("#"+id).find("input,select").each(function(indexelem,elemnew){1!=containsVal||""!=$(elemnew).val()||(isValidTime=!1)}),isValidTime}function checkMandatory(elem,compType){if(23==compType){var inputElem=$(elem).find("div[name=slider]").get(0);if(""==$.trim($(inputElem).attr("value")))return!1}else{inputElem=$(elem).find("input").get(0);if(""==$.trim($(inputElem).val()))return!1}return!0}function checkMandatoryForCompositeElem(elem,compType,showErrorBorder){var toReturn=!0;return $(elem).find("input").each(function(index,inpElem){"true"==$(inpElem).attr("mandatory")&&(""==$.trim($(inpElem).val())&&(toReturn=!1,showErrorBorder&&$(inpElem).parent().addClass("error1")))}),compType!=ZFFieldTypeConstants.ADDRESS&&compType!=ZFFieldTypeConstants.NAME||$(elem).find("select").each(function(myIndex,selElem){"true"==$(selElem).attr("mandatory")&&("-Select-"===$.trim($(selElem).val())&&(toReturn=!1,showErrorBorder&&$(selElem).parent().parent().addClass("error1")))}),!!toReturn}function doesAnyCompositeFieldHasValue(elem,compType){var toReturn=!1;return $(elem).find("input").each(function(index,inpElem){if(""!=$.trim($(inpElem).val()))return toReturn=!0,!1}),compType==ZFFieldTypeConstants.ADDRESS&&$(elem).find("select").each(function(myIndex,selElem){if("-Select-"!==$.trim($(selElem).val()))return toReturn=!0,!1}),!!toReturn}function doesAnyCompInTimeHasVal(elem){var toReturn=!1;return $(elem).find("input,select").each(function(indexelem,elemnew){if(""!=$(elemnew).val())return toReturn=!0,!1}),toReturn}function checkMandatoryTextArea(elem){var inputElem=$(elem).find("textarea").get(0);return""!=$.trim($(inputElem).val())}function checkMandatoryDropDown(elem,fldLinkName){var inputElem=$(elem).find("select[name='"+fldLinkName+"']").get(0);return"-Select-"!=$(inputElem).val()}function checkMandatorySignature(elem){var compname=$(elem).attr("compname"),signElem=document.getElementById("drawingCanvas-"+compname),flag=!1,editSignCont=$("#editsignContainer-"+compname);if($(editSignCont).length&&"none"!=$(editSignCont).css("display"))flag=!0;else{var blank=document.createElement("canvas");blank.width=signElem.width,blank.height=signElem.height;signElem.toDataURL();signElem.toDataURL()!=blank.toDataURL()&&(flag=!0)}return flag}function checkMandatoryRadio(elem){var checkedValues=[];return $(elem).find("input:radio:checked").each(function(index){if("radio-input"==$(this).attr("elname")){var val=$.trim($(this).parent().find("input[name=allow-others-text]").val());""!=val&&checkedValues.push(val)}else checkedValues.push($(this).val())}),0!=checkedValues.length}function checkMandatoryMatrixChoice(Elem){var choiceType=$(Elem).attr("choicetype");if(choiceType==MatrixChoicesType.RADIO.CODE||choiceType==MatrixChoicesType.CHECKBOX.CODE){var flag=!0;return $(Elem).find("tbody").find("tr").each(function(index,elem){if($(elem).find("input:checked").length<=0)return flag=!1}),flag}if(choiceType==MatrixChoicesType.DROPDOWN.CODE){flag=!0;return $(Elem).find("tbody").find("tr").each(function(index,elem){var hasRowContainsValue=!1;$(elem).find("select").each(function(index1,elem1){""==$.trim($(elem1).val())||(hasRowContainsValue=!0)}),hasRowContainsValue||(flag=!1)}),flag}if(choiceType==MatrixChoicesType.TEXTBOX.CODE){flag=!0;return $(Elem).find("tbody").find("tr").each(function(index,elem){var hasRowContainsValue=!1;$(elem).find("input[type=text]").each(function(index1,elem1){""==$.trim($(elem1).val())||(hasRowContainsValue=!0)}),hasRowContainsValue||(flag=!1)}),flag}}function checkMandatoryRating(elem){var checkedValues=[];return $(elem).find("a[elattr=selected]").each(function(index){checkedValues.push($(this).val())}),0!=checkedValues.length}function checkMandatoryCheckBox(elem){var checkedValues=[];return $(elem).find("input:checkbox:checked").each(function(index){checkedValues.push($(this).val())}),0!=checkedValues.length}function checkMandatoryMultiSelect(elem){return-1!=$(elem).find("select").get(0).selectedIndex}function checkMandatoryImageChoice(elem){var checkedValues=[],selectElem=$(elem).find("input");if(0!=selectElem.length)$(selectElem).each(function(){$(this).is(":checked")&&checkedValues.push($(this).attr("value"))});else{var divEle=$(elem).find("div[name=selectDiv]");$(divEle).each(function(){"selected"==$(this).attr("selected")&&checkedValues.push($(this).attr("value"))})}return 0!=checkedValues.length}function validateEmail(elem,compname,emailErrArray){var emailValue=$.trim($(elem).find("input:text[name="+compname+"]").val());if("undefined"!==emailValue&&""!==emailValue){if(!ZFUtil.validateEmailRegex(emailValue))return emailErrArray[0]=ZFLiveErrorConstants.emailerror,!1;if(!ZFLive.isSaveReq){var allowedDomain=$(elem).attr("allowed_domain_name"),restrictedDomain=$(elem).attr("restricted_domain_name"),domainOption=parseInt($(elem).attr("domain_option"));if(domainOption==EmailDomainOptions.ALLOW_SPECIFIC&&!isDomainExists(emailValue,allowedDomain))return allowedDomain=setdomainValues(allowedDomain),emailErrArray[0]=ZFUtil.replaceParams(ZFLiveErrorConstants.alloweddomain,allowedDomain),!1;if(domainOption==EmailDomainOptions.RESTRICT_SPECIFIC&&isDomainExists(emailValue,restrictedDomain))return restrictedDomain=setdomainValues(restrictedDomain),emailErrArray[0]=ZFUtil.replaceParams(ZFLiveErrorConstants.restricteddomain,restrictedDomain),!1}}return!0}function isDomainExists(emailValue,domainValues){if("undefined"!=emailValue&&""!=emailValue&&null!=domainValues&&""!=domainValues){var domainNameArr=domainValues.toLowerCase().split(","),emailPart=emailValue.split("@"),domainPart=$.trim(emailPart[1].toLowerCase());if(-1==$.inArray(domainPart,domainNameArr))return!1}return!0}function setdomainValues(domainValues){var domainValue;if(domainValues!=undefined&&""!=domainValues){var domainArr=domainValues.split(",");$.each(domainArr,function(index,value){domainValue!=undefined?domainValue+=", "+value:domainValue=value})}return domainValue}function validateInterNationalPhoneNumber(idd,errorIdd,countrycodePresent){var inputElem=$("#"+idd).find("div[elname=phoneFld]").find("input"),phoneFormatType=$(inputElem).attr("phoneFormatType"),rexp=/^[+]{0,1}[()0-9- ]+$/;phoneFormatType==ZFPhoneFormatValues.ONLY_NUMERIC?rexp=/^[0-9]+$/:countrycodePresent&&(rexp=/^[(0-9-][()0-9- ]*$/);var toReturn=!0;return $(inputElem).each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());""==val||rexp.test(val)||(phoneFormatType==ZFPhoneFormatValues.ONLY_NUMERIC?$(errorIdd).text(ZFLiveErrorConstants.phoneformatnumeronlyerror):countrycodePresent?$(errorIdd).text(ZFLiveErrorConstants.phoneinitialvalueerror):$(errorIdd).text(ZFLiveErrorConstants.phoneformaterror),toReturn=!1)}),toReturn}function countryCodeMandatoryCheck(elem){var countryCode=$(elem).find("div[elname=phoneFld]").find("input").intlTelInput("getSelectedCountryData").dialCode;return"undefined"!=countryCode&&null!=countryCode}function validateCountryCode(id){var countryCode=$("#"+id).find("div[elname=phoneFld]").find("input").intlTelInput("getSelectedCountryData").dialCode,isValid=!0;return countryCode==undefined||""==countryCode||/^[0-9]{1,4}$/.test(countryCode)||(isValid=!1),isValid}function validateUSAPhoneNumber(idd){var rexp=/^[0-9]+$/,toReturn=!0;return $("#"+idd).find("div[elname=phoneFld]").find("input").each(function(indexelem,elemnew){var val=$(elemnew).val();""==$.trim(val)||rexp.test(val)||(toReturn=!1)}),toReturn}function validateNumber(elem){var inputElem=$(elem).find("input").get(0),numValue=$.trim($(inputElem).val());if(null!=numValue&&""==!numValue){var strChar,result=!0;if("-"==numValue.charAt(0)&&1==numValue.length)return!1;for(i=0;i<numValue.length&&1==result;i++){if("-"==(strChar=numValue.charAt(i))&&0!=i)return!1;-1=="-0123456789".indexOf(strChar)&&(result=!1)}return result}return!0}function validateCurrency(elem){var format=$(elem).attr("decimalformat"),dLen=$(elem).attr("decimallength"),validChars=ZFUtil.getDecimalValidChar(format),inputElem=$(elem).find("input").get(0),numValue=$.trim($(inputElem).val()),hasNegValue="-"==numValue.charAt(0);if(!0===hasNegValue&&(validChars+="-"),null!=numValue&&""==!numValue){var strChar,result=!0;for(i=0;i<numValue.length&&1==result;i++)strChar=numValue.charAt(i),-1==validChars.indexOf(strChar)&&(result=!1);return result&&(result=hasNegValue?ZFUtil.checkDecimalFormat(numValue.substring(1,numValue.length),format,dLen):ZFUtil.checkDecimalFormat(numValue,format,dLen)),result}return!0}function validateDecimalLength(elem,decimalLen){var numValue=$(elem).find("input").val(),comptype=$(elem).attr("comptype"),format=$(elem).attr("decimalformat");if(comptype==ZFFieldTypeConstants.CURRENCY||comptype==ZFFieldTypeConstants.DECIMAL){if(numValue.indexOf(".")>=0&&(1==format||2==format)||numValue.indexOf(",")>=0&&(3==format||4==format))return!((3==format||4==format?numValue.substring(numValue.indexOf(",")+1).length:numValue.substring(numValue.indexOf(".")+1).length)>decimalLen)}else if(numValue.indexOf(".")>=0)return!(numValue.substring(numValue.indexOf(".")+1).length>decimalLen);return!0}function validatePayment(elem){var inputElem=$(elem).find("input").get(0),numValue=$.trim($(inputElem).val());if(null!=numValue&&""==!numValue){var strChar,result=!0;for(i=0;i<numValue.length&&1==result;i++)strChar=numValue.charAt(i),-1=="-0123456789.".indexOf(strChar)&&(result=!1);return result}return!0}function readFile_New(index,fileUploadLi,files,linkName,fieldType,count){var fileObj=files[index],fileName=fileObj.name,fileExtension=fileName.substr(fileName.lastIndexOf(".")+1),fileNamewithoutExt=fileName.slice(0,-fileExtension.length),fileType=fileObj.type;if(fileObj.size>2e7){var errorMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.uploadsize,20),fuErrTg=$("#test").find("#error-"+linkName);return fuErrTg.text(errorMsg),animateErrorMsg(fuErrTg),!1}var fileUploadUniqueName=linkName+"_fu"+count;if(ZFLive.storedFiles.hasOwnProperty(linkName))ZFLive.storedFiles[linkName][fileUploadUniqueName]=fileObj;else{var fileUploadJSON=[];fileUploadJSON[fileUploadUniqueName]=fileObj,ZFLive.storedFiles[linkName]=fileUploadJSON}var reader=new FileReader;return reader.onload=function(e){fileUploadLi.find("img[elname=fileImage]").attr("src",e.target.result),fileUploadLi.attr("elname","newlyAddedFUElement"),fileUploadLi.attr("name","singleFileElement"),fileUploadLi.attr("Linkname",fileUploadUniqueName),fileUploadLi.find("em[elname=fileName]").text(fileNamewithoutExt),fileUploadLi.find("b[elname=fileExtension]").text(fileExtension),fileUploadLi.find("p[elname=fileSize]").text(ZFLive.convertBytes(fileObj.size)),fileUploadLi.find("a[name=removeFileElement]").attr("elname",fileUploadUniqueName),fileType.match("image.*")?fileUploadLi.find("div[elname=fileNonImage]").hide():(fileUploadLi.find("a[elname=zoomIcon]").hide(),fileUploadLi.find("img[elname=fileImage]").hide()),fileUploadLi.show()},reader.readAsDataURL(fileObj),!0}function trimFileName(fileName){if(fileName)return fileName.length>15?fileName.substr(0,15)+"...":fileName}function removeErrorClass(){$("#formBodyDiv").find("li").each(function(index,elem){removeErrorFromLiElem(elem)})}function removeErrorFromLiElem(elem){var comptype=parseInt($(elem).attr("comptype"));if(comptype==ZFFieldTypeConstants.ADDRESS||comptype==ZFFieldTypeConstants.NAME||comptype==ZFFieldTypeConstants.GEOLOCATION)$(elem).find("div,span").each(function(index1,elem1){$(elem1).removeClass("error1")}),$(elem).removeClass("error");else if($(elem).attr("compname")==SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME)$(elem).find("div").each(function(index1,elem1){$(elem1).removeClass("error1")});else if(comptype==ZFFieldTypeConstants.EMAIL||comptype==ZFFieldTypeConstants.PHONE){var needReconf=$(elem).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var reconfErrorElem=$(elem).find("p[elname=reconf-error]");$(reconfErrorElem).is(":visible")||$(elem).removeClass("error")}else $(elem).removeClass("error")}else if(ZFLive.isOldUploadType||comptype!=ZFFieldTypeConstants.FILE_UPLOAD&&comptype!=ZFFieldTypeConstants.IMAGE_UPLOAD)comptype==ZFFieldTypeConstants.MATRIX_CHOICE?($(elem).removeClass("error"),$(elem).find("input").length>0&&$(elem).find("input").removeClass("errorMatrixInput")):$(elem).removeClass("error");else{0==$(elem).find("li.fileUploadError").length&&$(elem).removeClass("error")}"subFormField"===$(elem).attr("elemtype")&&("undefined"!=typeof ZFLive.sfUniqueValidator&&"undefined"!=typeof ZFLive.sfUniqueValidator[$(elem).attr("linkname")]&&delete ZFLive.sfUniqueValidator[$(elem).attr("linkname")],"2"==$(elem).attr("viewtype")&&$(elem).find('[elname="sfcardelem"]').find('[elname="sfCardInnerElem"]').removeClass("sfCardError"),$(elem).find('[elname="subFormFieldsUl"]').each(function(idx,ulElem){$(ulElem).find('[elname="sfEntryError"]').hide()})),$(elem).find("p[elname=error]").hide()}function removeReconfErrorFromLiElem(elem){var needReconf=$(elem).attr("need_reconf");typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf&&$(elem).find("p[elname=reconf-error]").slideUp();var parentErrorElem=$(elem).find("p[elname=error]");"none"==$(parentErrorElem).css("display")&&$(elem).removeClass("error")}function showSavePopUp(saveUrl,respJson){var saveUrlPopupDiv=$("#savePopUpDiv");$(saveUrlPopupDiv).find("textarea").val(saveUrl);var popupElem=$(saveUrlPopupDiv).find("div.popUpOuterSave");if($(saveUrlPopupDiv).find("div[elname=emailSavedLink]").removeClass("errSavemail").hide(),$(saveUrlPopupDiv).find("input[elname=emailID]").val(""),$(saveUrlPopupDiv).find("p[elname=errorMsg]").hide(),$(saveUrlPopupDiv).find("div[elname=succesDiv]").hide(),$(saveUrlPopupDiv).find("div[elname=emailtoDiv]").hide(),respJson.save_and_resume){var saveAndResumeObj=respJson.save_and_resume;if(saveAndResumeObj.allow_email_savedLink)$(saveUrlPopupDiv).find("button[elname=sendEmailBtn]").off().click(function(e){isIELessThan9()||e.preventDefault(),ZFLive.sendSavedUrlInEmail(this)}),$(saveUrlPopupDiv).find("div[elname=emailSavedLink]").show(),$(saveUrlPopupDiv).find("div[elname=emailtoDiv]").show();else if(saveAndResumeObj.to_addr){var succesDiv=$(saveUrlPopupDiv).find("div[elname=succesDiv]");$(succesDiv).find("em[elname=successDivMsg]").text(i18n.saveandresume_email_sent),$(succesDiv).find("em[elname=emailMsg]").text(saveAndResumeObj.to_addr),$(succesDiv).show(),$(saveUrlPopupDiv).find("div[elname=emailtoDiv]").show()}}$(saveUrlPopupDiv).show(),setPopupPositionNearFooter($(popupElem),!1)}function performPaymentAndSubmitData(merchantType){var payemntLi=$("#PaymentAmount-li"),parentUl=payemntLi.parent("ul[elname=formBodyULName]");"true"===payemntLi.attr("needdata")&&"true"==parentUl.attr("needpagedata")?merchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?ZFLive.generateStripeTokenAndSubmitData():merchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET?ZFLive.generatePaymentTokenAndSubmitData():ZFLive.ValidateAndSubmitData():ZFLive.ValidateAndSubmitData()}function showError(errorObj){var compname=errorObj[0],parentElem=$("#"+compname+"-li"),pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),setNeedDataForError(pageNum,$("#formBodyDiv").find("ul[elname=formBodyULName]").length),triggerFormResizeOnTimeOut(),focusFirstErrorElem(parentElem)}function showAndHidePage(pageNum){var formBodyDiv=$("#formBodyDiv"),formRedirectURL=$("#formRedirectURL");formBodyDiv.find("ul[elname=formBodyULName][page_no!="+pageNum+"]").hide(),formBodyDiv.find("ul[elname=formBodyULName][page_no="+pageNum+"]").show(),formRedirectURL.find("ul[elname=footer][page_no!="+pageNum+"]").hide(),formRedirectURL.find("ul[elname=footer][page_no="+pageNum+"]").show(),selectPage(pageNum)}function resetCaptcha(){var captchaHtml=$("#formBodyDiv").find("#verificationcode-li").html();if(null!==captchaHtml&&"undefined"!==$.type(captchaHtml)){var oldDigest=$("#verificationcode-li").find("#verificationcodeTxt").attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST),ajaxOpts={URI:"/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/captcha?olddigest="+oldDigest,METHOD:ZFHttp.GET,CSRF:ZFLive.csrf,ACCEPT:ZFMimeType.APPLICATION_JSON,CALLBACK:function(jsonData,ajaxOpts,jqXhr){var verCodeLiElem=$("#verificationcode-li"),captchaTextElem=$(verCodeLiElem).find("#verificationcodeTxt");if(200===jqXhr.status){var newDigest=JSON.parse(jqXhr.responseText)[ZFLiveConstants.VERIFICATIONCODE.DIGEST];$(verCodeLiElem).find("#zf-captcha").attr("src",ZFLive.accountsUrl+"/static/showcaptcha?digest="+newDigest),$(captchaTextElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST,newDigest)}else $(verCodeLiElem).find("#zf-captcha").attr("src",""),$(captchaTextElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST,"");$(captchaTextElem).val("")}};ZFUtil.sendAjax(ajaxOpts,this)}}function resetReCaptcha(){(document.getElementById("recaptcha_invisible")||document.getElementById("recaptcha_checkbox"))&&grecaptcha.reset()}function closeErrMsgPopUp(){$("body").removeClass("hideWindowScroll"),unBindKeyUpEvent(),$("#errmsg-div").hide()}function showPaymentErrPopUp(msg){ZFLive.disableSubmitBtn(),ZFLive.mode=Mode.LIVE,ZFLive.encodedString="",$("body").addClass("hideWindowScroll");var popupElem=$("#paymentsErr-div");$(popupElem).find("#popHeader").text(i18n.paymenttransaction),null!=msg&&""!=msg?$(popupElem).find("#msgBody").text(msg):$(popupElem).find("#msgBody").text(i18n.contactadmin),setPopUpElemPosition($("#paymentsErr-div-cont")),$(popupElem).show(),$(document).on("keyup",function(event){27===event.keyCode&&cancelPaymentError()})}function showErrorPopUp(headerMsg,bodyMsg){ZFLive.disableSubmitBtn(),$("body").addClass("hideWindowScroll");var popupElem=$("#settingsErr-div");$(popupElem).find("#popHeader").text(headerMsg),$(popupElem).find("#msgBody").text(bodyMsg),setPopUpElemPosition($("#settingsErr-div-cont")),$(popupElem).show(),$(document).on("keyup",function(event){27===event.keyCode&&closeErrorPopup()})}function closeErrorPopup(){ZFLive.enableSubmitBtn(),$("body").removeClass("hideWindowScroll"),unBindKeyUpEvent(),$("#settingsErr-div").hide()}function retryPaymentErrPopup(){$("body").removeClass("hideWindowScroll"),$("#paymentsErr-div").fadeToggle("fast","linear",function(){$("#paymentsErr-div").hide()}),ZFLive.isOldUploadType||reUploadAllFiles(),ZFLive.enableSubmitBtn(),unBindKeyUpEvent()}function cancelPaymentError(){window.location.reload()}function getConditionalExpression(formulaJson,isSubFormElem,rowId){var expression=formulaJson.default_expression,formulaRules=formulaJson.formula_rules;for(var ruleIdx in formulaRules){var rule=formulaRules[ruleIdx];if(ZFLive.evaluateConditionsForFormula(rule,isSubFormElem,rowId)){expression=formulaRules[ruleIdx][ZFFormulaConstants.EXPRESSION];break}}return expression}function isCurrFldInCondFormulaExps(currentFieldName,formulaJson){var fldsInCurrCondFormulaRuleExps=formulaJson.fields_in_formula_rule_expressions;return $.inArray(currentFieldName,fldsInCurrCondFormulaRuleExps)>=0}function calcFormFormulaWhichHasSFFormula(formulaLinkName){for(var formulaJsonArr=JSON.parse(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd];if(formulaJson.formula_type==ZFFormulaTypeConstants.CONDITIONAL){if(isCurrFldInCondFormulaExps(formulaLinkName,formulaJson))if(formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD])calcFormFormulaWhichHasSFFormula(formulaJson.link_name);else formulaExpressionParser(getConditionalExpression(formulaJson,!1,-1),formulaJson.link_name,!1,-1)}else isExpressionHasCurrentFld(formulaJsonArr[formulaInd].expression,formulaLinkName)&&(formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?calcFormFormulaWhichHasSFFormula(formulaJsonArr[formulaInd].link_name):formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!1,-1))}}function isValidField(fldLinkElem,fieldLinkName,isSubFormElem){if(isSubFormElem){var fldLiElem=$('li[compname="'+fieldLinkName+'"]');if($(fldLiElem).length>0){var parentSFLi,sfPopUp=$(fldLiElem).closest("#subFormPopUp");if($(sfPopUp).length>0){var sfLinkName=$(sfPopUp).attr("linkname");parentSFLi=$('li[compname="'+sfLinkName+'"]')}else parentSFLi=$(fldLiElem).closest('li[elemtype="subFormField"]');return"true"==$(parentSFLi).attr("needdata")&&"true"==$(parentSFLi).parent("ul").attr("needpagedata")}return!1}return"true"==$(fldLinkElem).attr("needdata")&&"true"==$(fldLinkElem).parent("ul").attr("needpagedata")}function evaluateFormulaInSubFormField(expression,formulaLinkName){$('li[linkname="'+formulaLinkName+'"]').each(function(index,formulaElem){var formulaParentElem=$(formulaElem).closest("ul");"subFormFieldsUl"==$(formulaParentElem).attr("elname")&&(isSubFormElem=!0,rowId=$(formulaParentElem).attr("rowid"),formulaExpressionParser(expression,formulaLinkName,isSubFormElem,rowId))})}function evaluateConditionalFormulaInSubFormField(formulaJson,formulaLinkName){$('li[linkname="'+formulaLinkName+'"]').each(function(index,formulaElem){var formulaParentElem=$(formulaElem).closest("ul");if("subFormFieldsUl"==$(formulaParentElem).attr("elname")){var rowId=$(formulaParentElem).attr("rowid");formulaExpressionParser(getConditionalExpression(formulaJson,!0,rowId),formulaLinkName,!0,rowId)}})}function setValueInFormula(formulaLinkName,result,isSubFormElem,rowId){var formulaFldLiElem,parsedResult=0;result=(result+"").replace(/[()]/g,""),isSubFormElem?setSubFormCardFormula(formulaFldLiElem=$('li[compname="'+formulaLinkName+"_"+rowId+'"]'),formulaLinkName,rowId,parsedResult):formulaFldLiElem=$('li[compname="'+formulaLinkName+'"]');var formulaFldTextElem=$(formulaFldLiElem).find(":text"),decimalLength=$(formulaFldLiElem).attr("decimallength");if(isFinite(result))if(-1==decimalLength){parsedResult=/^-?\d+$/.test(result)?parseFloat(result):parseFloat(result).toFixed(2)}else parsedResult=parseFloat(result).toFixed(decimalLength);else parsedResult=0;var decimalFormat=$(formulaFldLiElem).attr("decimalformat");if(parsedResult=ZFUtil.getFormattedDecimal(parsedResult,decimalFormat),$(formulaFldTextElem).val(parsedResult),ZFLive.prefillFieldLabel(formulaFldTextElem),null!=ZFLive.paymentMerchantList&&ZFLive.setValueInPayment(formulaLinkName),isSubFormElem&&setSfTotalVal(formulaFldLiElem),ZFLive.mode!=undefined&&!isSubFormElem){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules($(formulaFldTextElem),[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}}function setSubFormCardFormula(formulaFldLiElem,formulaLinkName,rowId,parsedResult){var sfPopUp=$(formulaFldLiElem).closest("#subFormPopUp");if($(sfPopUp).length>0){var sfLinkName=$(sfPopUp).attr("linkname"),sfLi=$('li[compname="'+sfLinkName+'"]'),formulaFldInCard=$(sfLi).find('div[elname="sfcardelem"][cardrowid="'+rowId+'"]').find('[elname="sfCardContDiv"][linkname="'+formulaLinkName+'"]');$(formulaFldInCard).length>0&&$(formulaFldInCard).find('[elname="recordVal"]').text(parsedResult)}else{sfLi=$(formulaFldLiElem).closest('li[elemtype="subFormField"]');if("2"==$(sfLi).attr("viewtype")){formulaFldInCard=$(sfLi).find('div[elname="sfcardelem"][cardrowid="'+rowId+'"]').find('[elname="sfCardContDiv"][linkname="'+formulaLinkName+'"]');$(formulaFldInCard).length>0&&$(formulaFldInCard).find('[elname="recordVal"]').text(parsedResult)}}}function isExpressionHasCurrentFld(expression,currentFieldName){if(void 0===expression||null==expression)return!1;var tempToken="",isExpHasCurrentFld=!1;for(expression=expression.replace(/ /g,""),i=0;i<expression.length;i++){var token=expression.charAt(i);if("-"!=token&&"+"!=token&&"*"!=token&&"/"!=token&&"("!=token&&")"!=token)tempToken+=token;else{if(tempToken==currentFieldName){isExpHasCurrentFld=!0;break}tempToken=""}}return tempToken==currentFieldName&&(isExpHasCurrentFld=!0),isExpHasCurrentFld}function formulaExpressionParser(expression,formulaLinkName,isSubFormElem,rowId){var tempToken="",expressionArr=[];for(expression=expression.replace(/ /g,""),iter=0;iter<expression.length;iter++){"-"!=(token=expression.charAt(iter))&&"+"!=token&&"*"!=token&&"/"!=token&&"("!=token&&")"!=token?tempToken+=token:(""!=tempToken&&(tempToken!=DateCalculationType.DAYS&&tempToken!=DateCalculationType.MONTHS&&tempToken!=DateCalculationType.YEARS&&tempToken!=DateCalculationType.HOURS&&tempToken!=DateCalculationType.MINUTES&&tempToken!=DateCalculationType.ROUNDUP&&tempToken!=DateCalculationType.ROUNDDOWN&&tempToken!=DateCalculationType.ROUND?addValueToExpArray(tempToken,expressionArr,isSubFormElem,rowId):expressionArr.push(tempToken)),expressionArr.push(token),tempToken="")}""!=tempToken&&addValueToExpArray(tempToken,expressionArr,isSubFormElem,rowId);for(var token,valueStack=[],operatorStack=[],dateCalcType=DateCalculationType.DAYS,index=0;index<expressionArr.length;index++)if("("==(token=expressionArr[index])||token==DateCalculationType.ROUNDUP||token==DateCalculationType.ROUNDDOWN||token==DateCalculationType.ROUND)operatorStack.push(token);else if("+"!=token&&"-"!=token&&"*"!=token&&"/"!=token&&"("!=token&&")"!=token&&token!=DateCalculationType.DAYS&&token!=DateCalculationType.MONTHS&&token!=DateCalculationType.YEARS&&token!=DateCalculationType.HOURS&&token!=DateCalculationType.MINUTES)valueStack.push(token);else if(")"==token){for(;"("!=operatorStack[operatorStack.length-1];)calculateFormulaFromStack(valueStack,operatorStack,dateCalcType),dateCalcType=DateCalculationType.DAYS;if(operatorStack.pop(),valueStack.length>0&&operatorStack.length>0){var roundVar=operatorStack[operatorStack.length-1];if(roundVar==DateCalculationType.ROUNDUP||roundVar==DateCalculationType.ROUNDDOWN||roundVar==DateCalculationType.ROUND){var valueToBeRounded=roundTheValueInFormula(valueStack.pop(),operatorStack.pop());valueStack.push(valueToBeRounded)}}}else if("+"==token||"-"==token||"*"==token||"/"==token){for(;0!=operatorStack.length&&leftHasGreaterPrecedence(operatorStack[operatorStack.length-1],token);)calculateFormulaFromStack(valueStack,operatorStack,dateCalcType);operatorStack.push(token)}else token!==DateCalculationType.DAYS&&token!==DateCalculationType.MONTHS&&token!==DateCalculationType.YEARS&&token!==DateCalculationType.HOURS&&token!==DateCalculationType.MINUTES||(dateCalcType=token);for(;0!=operatorStack.length;)calculateFormulaFromStack(valueStack,operatorStack,dateCalcType);setValueInFormula(formulaLinkName,valueStack.pop(),isSubFormElem,rowId);for(var formulaJsonArr=JSON.parse(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){if(formulaJsonArr[formulaInd].formula_type==ZFFormulaTypeConstants.CONDITIONAL){if(isCurrFldInCondFormulaExps(formulaLinkName,formulaJsonArr[formulaInd]))if(isSubFormElem||formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]){if(!isSubFormElem&&formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD])calculateFormulaForAllEntryInSubFormFld(formulaJsonArr[formulaInd]);else if(isSubFormElem&&formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]){formulaExpressionParser(expression=getConditionalExpression(formulaJsonArr[formulaInd],isSubFormElem,rowId),formulaJsonArr[formulaInd].link_name,isSubFormElem,rowId)}}else formulaExpressionParser(expression=getConditionalExpression(formulaJsonArr[formulaInd],isSubFormElem,rowId),formulaJsonArr[formulaInd].link_name,!1,-1)}else isExpressionHasCurrentFld(formulaJsonArr[formulaInd].expression,formulaLinkName)&&(isSubFormElem||formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?!isSubFormElem&&formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?calculateFormulaForAllEntryInSubFormFld(formulaJsonArr[formulaInd]):isSubFormElem&&formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]&&formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,isSubFormElem,rowId):formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!1,-1))}}function calculateFormulaForAllEntryInSubFormFld(formulaJson){var linkName=formulaJson.link_name,formula_type=formulaJson.formula_type;$('li[linkname="'+linkName+'"]').closest('ul[elname="subFormFieldsUl"]').each(function(idx,elem){formula_type==ZFFormulaTypeConstants.CONDITIONAL?formulaExpressionParser(getConditionalExpression(formulaJson,!0,parseInt($(elem).attr("rowid"))),linkName,!0,parseInt($(elem).attr("rowid"))):formulaExpressionParser(formulaJson.expression,linkName,!0,parseInt($(elem).attr("rowid")))}),calcFormFormulaWhichHasSFFormula(linkName)}function addValueToExpArray(tempToken,expressionArr,isSubFormElem,rowId){if(isFormField(tempToken)){var value=getValue(tempToken,isSubFormElem,rowId);null!=value&&""!=value||(value=0),expressionArr.push(value)}else expressionArr.push(tempToken)}function leftHasGreaterPrecedence(leftOptr,rightOptr){if("("==leftOptr)return!1;var operatorPrecedenceObj={"*":2,"/":2,"+":1,"-":1};return operatorPrecedenceObj[leftOptr]>=operatorPrecedenceObj[rightOptr]}function calculateFormulaFromStack(valueStack,operatorStack,dateCalcType){var rightOperand=valueStack.pop(),Operator=operatorStack.pop(),leftOperand=valueStack.pop(),result=0,dateFormat=$("#zf_date_format").val();switch(dateCalcType){case DateCalculationType.DAYS:result=getDaysDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat);break;case DateCalculationType.MONTHS:case DateCalculationType.YEARS:result=getMonthsOrYearsDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat);break;case DateCalculationType.HOURS:case DateCalculationType.MINUTES:result=getHoursOrMinutesDiffResult(leftOperand,rightOperand,Operator,dateCalcType)}valueStack.push(result)}function calculateFormula(expressionStr){var result=0;""!=expressionStr&&(result=new Function("return "+expressionStr)(),isFinite(result)||(result=0));return result}function calculateDate(leftOperand,rightOperand,operator,dateCalcType){var result=0,dateFormat=$("#zf_date_format").val();if(ZFUtil.validateDate(leftOperand,dateFormat)&&ZFUtil.validateDate(rightOperand,dateFormat)&&"-"===operator){var splitLeftDate=ZFUtil.splitDateVal(leftOperand,dateFormat),leftDate=new Date(splitLeftDate[2],splitLeftDate[1],splitLeftDate[0]),splitRightDate=ZFUtil.splitDateVal(rightOperand,dateFormat),rightDate=new Date(splitRightDate[2],splitRightDate[1],splitRightDate[0]);if(dateCalcType===DateCalculationType.DAYS)result=Math.floor((treatAsUTC(leftDate)-treatAsUTC(rightDate))/864e5);else if(dateCalcType===DateCalculationType.MONTHS){result=12*(splitLeftDate[2]-splitRightDate[2])+(splitLeftDate[1]-splitRightDate[1])}else if(dateCalcType===DateCalculationType.YEARS){result=splitLeftDate[2]-splitRightDate[2]}}return result}function getValue(fieldLinkName,isSubFormElem,rowId){var val="",fldLiElem=undefined,fieldLinkNameForGetVal=fieldLinkName;if(isSubFormElem!==undefined&&!0===isSubFormElem){var testForSubFormChildField=$('li[compname="'+fieldLinkName+"_"+rowId+'"]');if(1==$(testForSubFormChildField).length){fldLiElem=testForSubFormChildField;var sfPopUp=$(fldLiElem).closest("#subFormPopUp");if(fieldLinkNameForGetVal=fieldLinkName+"_"+rowId,0==$(sfPopUp).length)parentSFLi=$(fldLiElem).closest('li[elemtype="subFormField"]');else{var sfLinkName=$(sfPopUp).attr("linkname");parentSFLi=$('li[compname="'+sfLinkName+'"]')}if(0==ZFUtil.isFieldVisible(parentSFLi))return val;if("false"==$(parentSFLi).attr("needdata"))return val}else fldLiElem=$('li[compname="'+fieldLinkName+'"]')}else if(fldLiElem=$('li[compname="'+fieldLinkName+'"]'),0==$(fldLiElem).length){var subFormChildFieldsLi=$('li[linkname="'+fieldLinkName+'"]');if($(subFormChildFieldsLi).length>0){var parentSFLi=$($(subFormChildFieldsLi)[0]).closest('li[elemtype="subFormField"]');return 0==ZFUtil.isFieldVisible(parentSFLi)?val:"false"==$(parentSFLi).attr("needdata")?val:($(subFormChildFieldsLi).each(function(index,elem){if($(elem).attr("compname")!=fieldLinkName+"_0"){var thisVal=getValue(fieldLinkName,!0,parseInt($(elem).closest('ul[elname="subFormFieldsUl"]').attr("rowId")));null!=thisVal&&""!=thisVal&&thisVal!=undefined&&(val=Number(val)+Number(thisVal))}}),val)}}var needDataPage=fldLiElem.parent('ul[elname="formBodyULName"]').attr("needpagedata"),comptype=parseInt($(fldLiElem).attr("comptype"));if(comptype===ZFFieldTypeConstants.FORMULA)val=getFormulaValueFromLiElem(fldLiElem);else if("true"===$(fldLiElem).attr("needdata")){if("false"==needDataPage)return val;if(comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL){if(validateCurrency(fldLiElem)){var decimalFormat=$(fldLiElem).attr("decimalformat");val=ZFUtil.getReformattedDecimal($.trim($(fldLiElem).find("input").val()),decimalFormat)}}else if(comptype===ZFFieldTypeConstants.NUMBER)validateNumber(fldLiElem)&&(val=$.trim($(fldLiElem).find("input").val()));else if(comptype===ZFFieldTypeConstants.SLIDER)val=$(fldLiElem).find("div[name=slider]").attr("value");else if(comptype==ZFFieldTypeConstants.RATING)val=$(fldLiElem).find("a").attr("value");else if(comptype==ZFFieldTypeConstants.RADIO)$(fldLiElem).find("input:checked").each(function(index,elem){if($(elem).attr("allowothers")){var otherVal=$(fldLiElem).find("input[name=allow-others-text]").val();isNaN(otherVal)||(val=Number(val)+Number(otherVal))}else{var formulaVal=$(elem).attr("formula_val");formulaVal==undefined&&(formulaVal=""),val=Number(val)+Number(formulaVal)}});else if(comptype==ZFFieldTypeConstants.CHECKBOX)$(fldLiElem).find("input:checked").each(function(index,elem){var formulaVal=$(elem).attr("formula_val");formulaVal==undefined&&(formulaVal=""),val=Number(val)+Number(formulaVal)});else if(comptype==ZFFieldTypeConstants.DROPDOWN)$(fldLiElem).find("select[name='"+fieldLinkNameForGetVal+"']").find("option:selected").each(function(index,elem){var formulaVal=$(elem).attr("formula_val");formulaVal==undefined&&(formulaVal=""),val=Number(val)+Number(formulaVal)});else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE)$(fldLiElem).find("option:selected").each(function(index,elem){var formulaVal=$(elem).attr("formula_val");formulaVal==undefined&&(formulaVal=""),val=Number(val)+Number(formulaVal)});else if(comptype==ZFFieldTypeConstants.IMAGE_CHOICE)$(fldLiElem).find("div[elname=choiceContDiv]").each(function(index,elem){if($(elem).hasClass("selected")){var formulaVal=$(elem).find("img").attr("formula_val");formulaVal==undefined&&(formulaVal=""),val=Number(val)+Number(formulaVal)}});else if(comptype==ZFFieldTypeConstants.DATE||comptype==ZFFieldTypeConstants.DATETIME||comptype==ZFFieldTypeConstants.TIME)if(comptype==ZFFieldTypeConstants.DATE){var date=$.trim($(fldLiElem).find("input").val());ZFUtil.validateDate(date,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale"))&&(date=ZFUtil.convertToGeneralDate(date,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale")),val=date)}else if(comptype==ZFFieldTypeConstants.DATETIME){var dateTime=$.trim($(fldLiElem).find("input").val()),timeFormat=$(fldLiElem).attr("timeformat");ZFUtil.validateDateTime(dateTime,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale"),timeFormat)&&(dateTime=ZFUtil.convertToGeneralDateTime(dateTime,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale"),timeFormat),val=dateTime)}else if(comptype==ZFFieldTypeConstants.TIME){var timeValue="",hours=(timeFormat=$(fldLiElem).attr("timeformat"),$(fldLiElem).find('select[timecomp="hours"]').val()),minutes=$(fldLiElem).find('select[timecomp="minutes"]').val(),meridian=$(fldLiElem).find('select[timecomp="Meridiem"]').val();""!=(timeValue=""===hours||""===minutes||""===meridian?"":meridian===undefined?hours+":"+minutes:hours+":"+minutes+" "+meridian)&&ZFUtil.validateTimeFormat(timeValue,timeFormat)&&(val=meridian!=undefined?ZFUtil.getRailwayTime(timeValue):timeValue)}}return val}function getFormulaValueFromLiElem(formulaFldLiElem){var value=$.trim($(formulaFldLiElem).find(":text").val()),decimalFormat=$(formulaFldLiElem).attr("decimalformat");return value=ZFUtil.getReformattedDecimal(value,decimalFormat)}function isFormField(token){var isFormFld=!1;if(null!=ZFLive.formulaFieldsList)for(var fieldsArr=JSON.parse(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){if(fieldsArr[fldInd]==token){isFormFld=!0;break}}return isFormFld}function getFormFieldType(fldLnkName){return parseInt($("#test").find("li[linkname="+fldLnkName+"]").attr("comptype"))}function evalSliderExp(){return function(){ZFLive.evalExpression(this)}}function evalChoiceExpression(){return function(){ZFLive.evalExpression(this)}}function iterateSFUlAndBindForumula(liElem,linkName,compType){$(liElem).parent('[elname="subFormFieldsUl"]').length>0?$(liElem).each(function(){$(this).attr("compname")!==linkName+"_0"&&bindEventsOnFieldsForFormula(compType,$(this).attr("compname"))}):bindEventsOnFieldsForFormula(compType,linkName)}function bindEventsOnFieldsForFormula(compType,linkName){if(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL)$("li[compname="+linkName+"]").on("blur","input",function(){removeLeadingZeros($(this).closest("li")),ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.RATING)$("li[compname="+linkName+"]").on("click","a,span",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.SLIDER){var sliderElems=$("li[compname="+linkName+"]").find("a");for(index=0;index<sliderElems.length;index++)$(sliderElems[index]).parent().on("slidestop",evalSliderExp())}else if(compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX)$("li[compname="+linkName+"]").on("change","input",evalChoiceExpression());else if(compType==ZFFieldTypeConstants.DROPDOWN||compType==ZFFieldTypeConstants.MULTIPLE_CHOICE)$("li[compname="+linkName+"]").on("change","select",evalChoiceExpression());else if(compType==ZFFieldTypeConstants.DATETIME||compType==ZFFieldTypeConstants.DATE)$("li[compname="+linkName+"]").on("change","input",evalChoiceExpression());else if(compType==ZFFieldTypeConstants.TIME)$("li[compname="+linkName+"]").on("change","select",evalChoiceExpression());else if(compType==ZFFieldTypeConstants.SINGLE_LINE||compType==ZFFieldTypeConstants.EMAIL||compType==ZFFieldTypeConstants.WEBSITE||compType==ZFFieldTypeConstants.PHONE)$("li[compname="+linkName+"]").on("blur","input",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.NAME||compType==ZFFieldTypeConstants.ADDRESS)$("li[compname="+linkName+"]").on("change","select",function(){ZFLive.evalExpression(this)}),$("#test").find("li[compname="+linkName+"]").on("blur","input",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.MULTI_LINE)$("li[compname="+linkName+"]").on("change","textarea",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.DECISION_BOX||compType==ZFFieldTypeConstants.TERMS_CONDITIONS)$("li[compname="+linkName+"]").on("change","input",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.IMAGE_CHOICE){var liElem=$("#test").find("li[compname="+linkName+"]");if("imagePicker"!=liElem.find("div[elname=imageChoiceEle]").attr("choicetype")){var inputs=liElem.find("input");$(inputs).each(function(){var parentDiv=$(this).parent();$(this).on("click",function(){ZFLive.evalExpression(this)}),$(parentDiv).find("div").on("click",function(){ZFLive.evalExpression(this)}),$(parentDiv).find("b").on("click",function(){ZFLive.evalExpression(this)})})}else{var divEle=liElem.find("div[elname=choiceContDiv]");$(divEle).each(function(){$(this).find("div[name=selectDiv]").on("click",function(){ZFLive.evalExpression(this)}),$(this).find("b").on("click",function(){ZFLive.evalExpression(this)})})}}}function setZoomPopUpElemPosition(elem){elem.css("position","absolute"),elem.css("width",$(window).width()),elem.css("height",$(window).height())}function constructImageChoiceField(valueJson,elem,fromReview){var valueJsonArr=[];if("imagePicker"!=$(elem).find("div[elname=imageChoiceEle]").attr("choicetype")){var inputs=$(elem).find("input");$(inputs).each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&(fromReview?valueJsonArr.push($(elemnew).parent().find("b").text()):valueJsonArr.push(val))})}else{var divEle=$(elem).find("div[name=selectDiv]");$(divEle).each(function(){"selected"==$(this).attr("selected")&&valueJsonArr.push($(this).attr("value"))})}valueJsonArr.length>0?valueJson[$(elem).attr("compname")]=valueJsonArr:valueJson[$(elem).attr("compname")]=""}function goTo(pageNo){if("{}"===JSON.stringify(zfPageRule.pageRules)){var currentPg=$("#navigBar").attr("currentPage"),errorObj=[],formDiv=$("#formDiv");if(currentPg!=pageNo)if(document.activeElement.blur(),ZFLive.skipValidation||pageNo<currentPg?ZFLive.validatePage(currentPg,!0,!1):errorObj=ZFLive.validatePage(currentPg,!1,!1),0==errorObj.length){var newPageLi=formDiv.find("ul[elname=footer][page_no="+pageNo+"]");formDiv.find("ul[elname=footer][page_no="+currentPg+"]").hide(),$(newPageLi).show(),formDiv.find("ul[elname=formBodyULName][page_no="+currentPg+"]").hide();var nextPageUl=formDiv.find("ul[elname=formBodyULName][page_no="+pageNo+"]");$(nextPageUl).fadeIn(400,function(){setWidthForSFElem(nextPageUl),setWidthForCurrencySymbolInSubForm(nextPageUl)}),focusFirstField(nextPageUl),selectPage(pageNo),triggerFormResize()}else{var compname=errorObj[0];focusFirstErrorElem($("#"+compname+"-li"))}}}function focusFirstField(UlElem){var lielem=$(UlElem).find("li[elname=livefield-elem]:visible").first(),elemType=$(lielem).attr("elemtype");if(void 0!==elemType&&"subFormField"==elemType){if("2"==$(lielem).attr("viewtype"))$(lielem).focus();else{var sfUls=$(lielem).find('[elname="subFormFieldsUl"]');sfUls.length>0?focusFirstField($(sfUls).first()):$(lielem).focus()}}else{var comptype=lielem.attr("comptype"),compTypeInt=parseInt(comptype);if(1==comptype||3==comptype||4==comptype||7==comptype||8==comptype||9==comptype||10==comptype||11==comptype||13==comptype||14==comptype||18==comptype||19==comptype||20==comptype||30==comptype||32==comptype)$(lielem).find("input:first").focus();else if(2==comptype)$(lielem).find("textarea").focus();else if(6==comptype)$(lielem).find("select:first").focus();else if(12==comptype||15==comptype)$(lielem).find("select").focus();else if(29==comptype){var choiceType=$(lielem).find("div[elname=imageChoiceEle]").attr("choicetype");choiceType==ImageChoicesType.RADIO||choiceType==ImageChoicesType.CHECKBOX?$(lielem).find("input:first").focus():choiceType==ImageChoicesType.IMG_PICKER&&$(lielem).find("div[elname=choiceContDiv]:first").attr("tabindex","-1").focus()}else compTypeInt===ZFFieldTypeConstants.ZOHO_CRM?ZFCrmLive.zfCrmLive.focusZohoCrmField(lielem):$(lielem).focus()}}function focusFirstErrorElem(parentElem){var fieldType=parseInt($(parentElem).attr("comptype"));if(fieldType===ZFFieldTypeConstants.ZOHO_CRM)ZFCrmLive.zfCrmLive.focusZohoCrmField(parentElem);else if(fieldType==ZFFieldTypeConstants.ADDRESS||fieldType==ZFFieldTypeConstants.NAME||fieldType==ZFFieldTypeConstants.GEOLOCATION){$(parentElem).find("div,span").find(".error1:first").find(":input[type!=hidden]:first").focus()}else if(fieldType==ZFFieldTypeConstants.RATING||fieldType==ZFFieldTypeConstants.SIGNATURE||fieldType==ZFFieldTypeConstants.SLIDER)parentElem.focus();else if("subFormField"==$(parentElem).attr("elemtype")){var thisSubFormComp=$(parentElem).attr("compname"),thisSubFormErrorPos=$(parentElem).find("p#error-"+thisSubFormComp).offset().top,viewPortCenter=((viewportBottom=(viewportTop=$(window).scrollTop())+$(window).height())-viewportTop)/2;(thisSubFormErrorPos>viewportBottom||thisSubFormErrorPos<viewportTop)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-viewPortCenter},1e3)}else{if(fieldType===ZFFieldTypeConstants.EMAIL||fieldType===ZFFieldTypeConstants.PHONE){var errorElem=$(parentElem).find("p[elname=error]");if($(errorElem).is(":visible"))return void parentElem.find(":input[type!=hidden]:first").focus();var needReconf=$(parentElem).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var reconfErrorElem=$(parentElem).find("p[elname=reconf-error]");if($(reconfErrorElem).is(":visible"))return void(fieldType===ZFFieldTypeConstants.EMAIL?$(parentElem).find("span[elname=livefield-reconf-elem]").find("input").focus():$(parentElem).find("div[elname=confPhoneFld]").find("input").focus())}}parentElem.find(":input[type!=hidden]:first").focus()}if($(parentElem).parent('ul[elname="subFormFieldsUl"]').length>0){var sfParent=$(parentElem).closest('li[elemtype="subFormField"]');if("2"==$(sfParent).attr("viewtype")){var viewportTop,viewportBottom,rowId=$(parentElem).parent('ul[elname="subFormFieldsUl"]').attr("rowid"),posToFix=(thisSubFormErrorPos=$(sfParent).find('div[elname="sfcardelem"][cardrowid="'+rowId+'"]').offset().top,((viewportBottom=(viewportTop=$(window).scrollTop())+$(window).height())-viewportTop)/3);(thisSubFormErrorPos>viewportBottom||thisSubFormErrorPos<viewportTop)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-posToFix},1e3)}}}function setNeedDataForPrevPage(prevPageNum,currPage){prevPageNum=parseInt(prevPageNum)+1;for(var formBodyDiv=$("#formBodyDiv");prevPageNum<currPage;){var ulElem=formBodyDiv.find("ul[elname=formBodyULName][page_no="+prevPageNum+"]");ulElem.attr("needpagedata","true"),evalRulesOnNavigation(ulElem),prevPageNum++}ZFLive.evalExpressionOnFormLoad()}function setNeedDataForError(prevPageNum,currPage){for(var formBodyDiv=$("#formBodyDiv");prevPageNum<currPage;){var ulElem=formBodyDiv.find("ul[elname=formBodyULName][page_no="+prevPageNum+"]");"false"==ulElem.attr("needpagedata")&&(ulElem.attr("needpagedata","true"),evalRulesOnNavigation(ulElem)),prevPageNum++}ZFLive.evalExpressionOnFormLoad()}function evalRulesOnNavigation(ulElem){$(ulElem).find("li[elname=livefield-elem]").each(function(index,elem){"true"==$(elem).attr("needdata")&&reEvalFieldRules(elem)})}function setNeedDataForNextPage(currPage,nextPageNo){currPage=parseInt(currPage)+1;for(var formBodyDiv=$("#formBodyDiv");currPage<nextPageNo;){var ulElem=formBodyDiv.find("ul[elname=formBodyULName][page_no="+currPage+"]");ulElem.attr("needpagedata","false"),evalRulesOnNavigation(ulElem),currPage++}ZFLive.evalExpressionOnFormLoad()}function gotoNextPage(elem){var ulelem=$(elem).closest("ul"),pageNo=parseInt(ulelem.attr("page_no")),formDiv=$("#formDiv"),errorObj=[];if(document.activeElement.blur(),ZFLive.skipValidation?ZFLive.validatePage(pageNo,!0,!1):errorObj=ZFLive.validatePage(pageNo,!1,!1),0==errorObj.length){var nextPageNo=evalRulesAndGetNextPageNo(pageNo);setNeedDataForNextPage(pageNo,nextPageNo);var newPageLi=formDiv.find("ul[elname=footer][page_no="+nextPageNo+"]");formDiv.find("ul[elname=footer][page_no="+pageNo+"]").hide(),$(newPageLi).show(),$(newPageLi).find("div[elname=back]").attr("skip_pageno",pageNo),formDiv.find("ul[elname=formBodyULName][page_no="+pageNo+"]").hide();var nextPageUl=formDiv.find("ul[elname=formBodyULName][page_no="+nextPageNo+"]");$(nextPageUl).fadeIn(400,function(){setWidthForSFElem(nextPageUl),setWidthForCurrencySymbolInSubForm(nextPageUl)}),focusFirstField(nextPageUl),selectPage(nextPageNo),triggerFormResize()}else{var compname=errorObj[0];focusFirstErrorElem($("#"+compname+"-li"))}}function gotoPrev(elem){var ulelem=$(elem).closest("ul"),pageNo=parseInt(ulelem.attr("page_no")),formDiv=$("#formDiv"),prevPageLi=formDiv.find("ul[elname=footer][page_no="+pageNo+"]");prevPageLi.hide();var prevPageNo=prevPageLi.find("div[elname=back]").attr("skip_pageno");void 0===prevPageNo&&(prevPageNo=pageNo-1),setNeedDataForPrevPage(prevPageNo,pageNo);var newPageLi=formDiv.find("ul[elname=footer][page_no="+prevPageNo+"]");$(newPageLi).show(),document.activeElement.blur(),ZFLive.validatePage(pageNo,!0,!1),formDiv.find("ul[elname=formBodyULName][page_no="+pageNo+"]").hide();var prevPageUl=formDiv.find("ul[elname=formBodyULName][page_no="+prevPageNo+"]");$(prevPageUl).fadeIn(400,function(){setWidthForSFElem(prevPageUl),setWidthForCurrencySymbolInSubForm(prevPageUl)}),focusFirstField(prevPageUl),selectPage(prevPageNo),triggerFormResize()}function setSignatureElemWidth(elem){var signatureEle=$(elem).find("li[comptype=25]");$(signatureEle).each(function(ele){if($(this).is(":visible")){var canvasEle=$(this).find("canvas")[0];0==canvasEle.width&&(canvasEle.width=$(this).find("div[elname=signContainer]").width())}})}function setWidthForSFElem(pageUl){var formWidth=$('[elname="frmTemplate"]').width();formWidth>800&&$(pageUl).find('li[elemtype="subFormField"][needToResetWidth="true"]').each(function(index,elem){var isFldVisible=$(this).is(":visible");isFldVisible||$(this).show();var widthModificationRatioValue=(formWidth-72)/728,subFormLabelDiv=$(this).find('[elname="subFormLabelDiv"]');$(subFormLabelDiv).find("li").each(function(liIndex,liElem){if($(this).attr("compname")){var actualCompName=$(this).attr("compname").slice(6),elemToAdjWidth=$(liElem).find("label");if(elemToAdjWidth.length>0){var newWidth=$(elemToAdjWidth).width()*widthModificationRatioValue;if(elemToAdjWidth.width(newWidth),$(elem).find('li[linkname="'+actualCompName+'"]').find("div.tempContDiv").width(newWidth),"5"==$(this).attr("comptype")||"16"==$(this).attr("comptype")){var newWidthForInput=newWidth-24;$(elem).find('li[linkname="'+actualCompName+'"]').find("input").css("width",newWidthForInput)}if("4"==$(this).attr("comptype")){newWidthForInput=newWidth-39;$(elem).find('li[linkname="'+actualCompName+'"]').find("input").css("width",newWidthForInput)}}}}),isFldVisible||$(this).hide(),$(this).attr("needToResetWidth","false")})}function selectPage(pageNo){var navigBar=$("#navigBar");navigBar.attr("currentPage",pageNo);var navigType=navigBar.attr("navigtype"),tr=navigBar.find("tr:first");if(tr.find("td").addClass("unselected"),tr.find("td").removeClass("selected currentPTab"),1==navigType){for(var count=2*pageNo,i=0;i<count;i++)tr.find("td:eq("+i+")").addClass("selected").removeClass("unselected");tr.find("td:eq("+(count-2)+")").addClass("currentPTab")}else if(2==navigType){for(i=0;i<pageNo;i++)tr.find("td:eq("+i+")").addClass("selected").removeClass("unselected");tr.find("td:eq("+(pageNo-1)+")").addClass("currentPTab")}setSignatureElemWidth($("#formBodyDiv").find("ul[elname=formBodyULName][page_no="+pageNo+"]"))}function autoFillPayment(linkname){return function(){ZFLive.setValueInPayment(linkname)}}function getValidPaymentValue(value,pymntType){var validVal=value;if(""==value||value==undefined||isNaN(value))validVal=1==pymntType?0:"";else{validVal=/^-?\d+$/.test(value)?parseFloat(value):parseFloat(value).toFixed(2)}return validVal}function selectTxtAreaCont(txtAreaElem){$(txtAreaElem).select()}function selectTxtAreaContAndCopy(txtAreaElem){$(txtAreaElem).select(),document.execCommand("copy"),$(txtAreaElem).parent().find("[elname=copyClip]").show().delay("600").fadeOut("600")}function removeError(elem,errorIdd){$(elem).removeClass("error"),$(errorIdd).text("")}function redirectionAfterSubmission(respJson,formtype){var sameFormUrl="";respJson.hasOwnProperty("same_form_url")&&(sameFormUrl=respJson.same_form_url);var thankYouPageURL=respJson.thankyou_page_URL;if(0!==$.trim(thankYouPageURL).length){var redirType=respJson.redirect_type;performDefaultRedirection(thankYouPageURL,respJson.open_thankyou_page_URL_in,sameFormUrl,formtype,redirType)}}function calculateMinutesOrHours(leftOperand,rightOperand,operator,dateCalcType){var result=0,dateFormat=$("#zf_date_format").val();if("-"===operator&&0!=leftOperand&&0!=rightOperand){if(isValidDateTimeForFormula(rightOperand,dateFormat)&&isValidDateTimeForFormula(leftOperand,dateFormat)){var leftOperandDate=leftOperand.substring(0,leftOperand.indexOf(" ")),splitLeftDate=ZFUtil.splitDateVal(leftOperandDate,dateFormat),leftDate=new Date(splitLeftDate[2],splitLeftDate[1],splitLeftDate[0]),rightOperandDate=rightOperand.substring(0,rightOperand.indexOf(" ")),splitRightDate=ZFUtil.splitDateVal(rightOperandDate,dateFormat),rightDate=new Date(splitRightDate[2],splitRightDate[1],splitRightDate[0]),leftOperandHour=getTimeAsHourOfDateTime(splitMeridianAndGetTime(leftOperand.substring(leftOperand.indexOf(" ")+1,leftOperand.length))),rightOperandHour=getTimeAsHourOfDateTime(splitMeridianAndGetTime(rightOperand.substring(rightOperand.indexOf(" ")+1,rightOperand.length)));result=treatAsUTC(leftDate)+leftOperandHour-(treatAsUTC(rightDate)+rightOperandHour)}else if(isValideTimeForFormula(rightOperand)&&isValideTimeForFormula(leftOperand)){result=(leftOperandHour=getTimeAsHourOfDateTime(leftOperand))-(rightOperandHour=getTimeAsHourOfDateTime(rightOperand))}0!=result&&(dateCalcType==DateCalculationType.HOURS?result=parseInt(result/36e5):dateCalcType==DateCalculationType.MINUTES&&(result=parseInt(result/6e4)))}return result}function getTimeAsHourOfDateTime(operandTime){var hourAndMinute=$.trim(operandTime).split(":");return hourAndMinute.length>1?60*Number(hourAndMinute[0])*60*1e3+60*Number(hourAndMinute[1])*1e3:0}function splitMeridianAndGetTime(value){return value.split(" ").length>1?ZFUtil.getRailwayTime(value):value}function isValidDateTimeForFormula(operand,dateFormat){return"string"==typeof operand&&operand.indexOf(" ")>1&&ZFUtil.validateDateTime(operand,dateFormat)}function isValideTimeForFormula(operand){return"string"==typeof operand&&ZFUtil.validateTimeFormat(operand,2)}function roundTheValueInFormula(valueToBeRounded,roundOfType){return roundOfType==DateCalculationType.ROUNDUP?Math.ceil(valueToBeRounded):roundOfType==DateCalculationType.ROUNDDOWN?Math.floor(valueToBeRounded):roundOfType==DateCalculationType.ROUND?Math.round(valueToBeRounded):valueToBeRounded}function getMonthsOrYearsDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat){return isValidDateTimeForFormula(leftOperand,dateFormat)&&(leftOperand=leftOperand.substring(0,leftOperand.indexOf(" "))),isValidDateTimeForFormula(rightOperand,dateFormat)&&(rightOperand=rightOperand.substring(0,rightOperand.indexOf(" "))),calculateDate(leftOperand,rightOperand,Operator,dateCalcType)}function getDaysDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat){return ZFUtil.validateDate(leftOperand,dateFormat)||ZFUtil.validateDate(rightOperand,dateFormat)||isValidDateTimeForFormula(rightOperand,dateFormat)||isValidDateTimeForFormula(leftOperand,dateFormat)?(isValidDateTimeForFormula(leftOperand,dateFormat)&&(leftOperand=leftOperand.substring(0,leftOperand.indexOf(" "))),isValidDateTimeForFormula(rightOperand,dateFormat)&&(rightOperand=rightOperand.substring(0,rightOperand.indexOf(" "))),calculateDate(leftOperand,rightOperand,Operator,dateCalcType)):calculateFormula("("+leftOperand+")"+Operator+"("+rightOperand+")")}function getHoursOrMinutesDiffResult(leftOperand,rightOperand,Operator,dateCalcType){return calculateMinutesOrHours(leftOperand,rightOperand,Operator,dateCalcType)}function rangeValidationForTextFields(elem,errorIdd,dataSpecJson,comptype,compname){var inputLength=0,minLen=dataSpecJson[DataSpecConst.MIN_LEN],maxLen=dataSpecJson[DataSpecConst.MAX_LEN];if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.CHARACTERS){if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.EMAIL?inputLength=$.trim($(elem).find("input").val()).length:comptype==ZFFieldTypeConstants.MULTI_LINE&&(inputLength=$.trim($(elem).find("textarea").val()).length),inputLength<minLen)return errMsg=1===minLen?ZFLiveErrorConstants.minonecharlimit:ZFLiveErrorConstants.mincharlimit.replace("{0}",minLen.toString()),$(errorIdd).text(errMsg),!1;if(inputLength>maxLen)return errMsg=1===maxLen?ZFLiveErrorConstants.maxonecharlimit:ZFLiveErrorConstants.maxcharlimit.replace("{0}",maxLen.toString()),comptype==ZFFieldTypeConstants.EMAIL&&hideFieldReConfErr(compname),$(errorIdd).text(errMsg),!1}else if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.WORDS&&comptype==ZFFieldTypeConstants.MULTI_LINE){var errMsg,wordArr=$.trim($(elem).find("textarea").val()).match(/\S+/g);if((inputLength=null!==wordArr?wordArr.length:0)<minLen)return errMsg=1===minLen?ZFLiveErrorConstants.minonewordlimit:ZFLiveErrorConstants.minwordlimit.replace("{0}",minLen.toString()),$(errorIdd).text(errMsg),!1;if(inputLength>maxLen)return errMsg=1===maxLen?ZFLiveErrorConstants.maxonewordlimit:ZFLiveErrorConstants.maxwordlimit.replace("{0}",maxLen.toString()),$(errorIdd).text(errMsg),!1}return!0}function hideFieldReConfErr(compname){var reconfCompname=compname+"-reconf",reconfErrorId=ZFLive.errorId(reconfCompname);"none"!=$(reconfErrorId).css("display")&&$(reconfErrorId).hide()}function setSfTotalValForSlider(compName){setSfTotalVal($('li[elname=livefield-elem][compname="'+compName+'"]'))}function setSfTotalVal(elem){var parentElname=$(elem).closest("ul").attr("elname");if(void 0!==parentElname&&"subFormFieldsUl"==parentElname){var sfLi=$(elem).closest('li[elemtype="subFormField"]');if($(sfLi).length>0&&"true"==$(sfLi).attr("show_summary")){var comptype=parseInt($(elem).attr("comptype"));comptype!==ZFFieldTypeConstants.NUMBER&&comptype!==ZFFieldTypeConstants.DECIMAL&&comptype!==ZFFieldTypeConstants.CURRENCY&&comptype!==ZFFieldTypeConstants.FORMULA&&comptype!==ZFFieldTypeConstants.SLIDER||setValueForSummary($(sfLi),$(elem))}}}function initializeSFSummary(){$("#formBodyDiv").find('li[elemtype="subFormField"][show_summary=true]').each(function(idx,sfLi){resetSFSummary($(sfLi))})}function setValueInFldLabel(compname,val){val!=undefined&&""!==val.trim()||(val="___");var prefillStr="setlabel_"+compname,prefillSpan=$("#formBodyDiv").find("span[elname="+prefillStr+"]");$(prefillSpan).hide(),$(prefillSpan).text(val),$(prefillSpan).fadeIn("fast"),triggerFormResizeOnTimeOut()}function isAllowedFldTypeForPrefillLabel(fldType){return fldType==ZFFieldTypeConstants.SINGLE_LINE||fldType==ZFFieldTypeConstants.NUMBER||fldType==ZFFieldTypeConstants.ADDRESS||fldType==ZFFieldTypeConstants.NAME||fldType==ZFFieldTypeConstants.DROPDOWN||fldType==ZFFieldTypeConstants.RADIO||fldType==ZFFieldTypeConstants.EMAIL||fldType==ZFFieldTypeConstants.WEBSITE||fldType==ZFFieldTypeConstants.PHONE||fldType==ZFFieldTypeConstants.DATE||fldType==ZFFieldTypeConstants.DATETIME||fldType==ZFFieldTypeConstants.TIME||fldType==ZFFieldTypeConstants.CURRENCY||fldType==ZFFieldTypeConstants.SLIDER||fldType==ZFFieldTypeConstants.RATING||fldType==ZFFieldTypeConstants.FORMULA||fldType==ZFFieldTypeConstants.DECIMAL}function isFieldPrefilledByUrl(compname){if(ZFLive.prefillFieldsList!=undefined)for(var fldsArr=JSON.parse(ZFLive.prefillFieldsList),index=0;index<fldsArr.length;index++){if(fldsArr[index]===compname)return!0}return!1}function setErrorForConfirm(elemId,reconfElemId,errorText){"none"==$(elemId).css("display")&&($(reconfElemId).text(errorText),animateErrorMsg_250(reconfElemId))}function getPhoneValWithCountryCode(parentLiElem,linkName){var countryCode=$(parentLiElem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode;return countryCode=null!=countryCode?"+"+countryCode:""}function checkAndRemoveReconfError(inp1,inp2,parentLiElem){if(""!=$.trim(inp1)){if(""!=$.trim(inp2)&&$.trim(inp1)==$.trim(inp2))return removeReconfErrorFromLiElem(parentLiElem),!0}else if(""==$.trim(inp2))return removeReconfErrorFromLiElem(parentLiElem),!0;return!1}function showWarningErrorMsg(elem,errorIdd,compname){if($(elem).hasClass("error"))$(errorIdd).addClass("rangeError"),animateErrorMsg(errorIdd);else{var lastErrorIdd,comptype=parseInt($(elem).attr("comptype"));typeof ZFLive.lastErrorComp===ResponseKey.UNDEFINED||$("li[elname=livefield-elem][compname="+ZFLive.lastErrorComp+"]").hasClass("error")?typeof lastErrorIdd===ResponseKey.UNDEFINED&&(comptype==ZFFieldTypeConstants.DATE||comptype==ZFFieldTypeConstants.DATETIME?$(errorIdd).addClass("warningMessage").show():($(errorIdd).addClass("warningMessage"),animateErrorMsg_250(errorIdd))):(lastErrorIdd=ZFLive.errorId(ZFLive.lastErrorComp),$(lastErrorIdd).removeClass("warningMessage").hide(),comptype==ZFFieldTypeConstants.DATE||comptype==ZFFieldTypeConstants.DATETIME?$(errorIdd).addClass("warningMessage").show():($(errorIdd).addClass("warningMessage"),animateErrorMsg_250(errorIdd))),ZFLive.lastErrorComp=compname}$("#formBodyDiv").find("li[comptype="+ZFFieldTypeConstants.MATRIX_CHOICE+"]").length>0&&$("#formBodyDiv").find("li[comptype="+ZFFieldTypeConstants.MATRIX_CHOICE+"]").each(function(index,elem){$(elem).find("p[elname=error]").is(":visible")||$(elem).find("input").removeAttr("isLastError").removeClass("errorMatrixInput")})}function inputAddedToField(elem,comptype,fromClientValidation){if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.CURRENCY||comptype==ZFFieldTypeConstants.DATE||comptype==ZFFieldTypeConstants.DATETIME||comptype==ZFFieldTypeConstants.WEBSITE)return $.trim($(elem).find("input").val()).length>0;if(comptype==ZFFieldTypeConstants.MULTI_LINE)return $.trim($(elem).find("textarea").val()).length>0;if(comptype==ZFFieldTypeConstants.PHONE){var hasNoInput=!0;return $(elem).find("div[elname=phoneFld]").find("input").each(function(inde,elemnew){return hasNoInput=0===$.trim($(elemnew).val()).length}),!hasNoInput}return comptype==ZFFieldTypeConstants.EMAIL?$.trim($(elem).find("input:first").val()).length>0:comptype==ZFFieldTypeConstants.MATRIX_CHOICE&&!fromClientValidation&&("true"!=$(elem).attr("mandatory")||checkMandatoryMatrixChoice(elem))}function needConf(elem){var needReconf=$(elem).attr("need_reconf");return typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf}function needToValidatePhone(compname,toCompareElname){var needToValidate=!1;if($(document.activeElement).closest("li[elname=livefield-elem]").attr("compname")===compname){var closestDivElname=$(document.activeElement).closest("div[name=phone-elements]").attr("elname");typeof closestDivElname!=undefined&&closestDivElname==toCompareElname&&(needToValidate=!0)}else needToValidate=!0;return needToValidate}function validateConstrLiElem(elem,compname,errorIdd,inputElem){var constrJson=ZFLive.constraintJson,linkname=$(elem).attr("linkname"),comptype=parseInt($(elem).attr("comptype")),ismandatory=$(elem).attr("mandatory"),isInputAddedToField=inputAddedToField(elem,comptype,!0);if("true"==ismandatory)if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE){if(!isInputAddedToField){if(comptype==ZFFieldTypeConstants.DATE)return $(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror),!1;if(comptype===ZFFieldTypeConstants.DATETIME)return $(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror),!1;if(comptype===ZFFieldTypeConstants.PHONE){var fldDiv=$(elem).find("div[elname=phoneFormatElem]"),phoneFormat=$(fldDiv).attr("phoneFormat");return this.hideFieldReConfErr(compname),phoneFormat===ZFPhoneFormatConstants.USAFORMAT?(setTimeout(function(){needToValidatePhone(compname,"confPhoneFld")&&($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber),showWarningErrorMsg(elem,errorIdd,compname),isSfChild(elem)&&clearSFUniqueError(elem))},0),undefined):($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber),!1)}if(comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.CURRENCY)return $(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber),!1;if(comptype===ZFFieldTypeConstants.EMAIL){var reconfCompname=compname+"-reconf",reconfErrorId=ZFLive.errorId(reconfCompname);return $(reconfErrorId).is(":visible")&&$(reconfErrorId).hide(),$(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),!1}return $(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),!1}}else{if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS)return!!checkMandatoryForCompositeElem(elem,comptype,!1)||(setTimeout(function(){$(document.activeElement).closest("li[elname=livefield-elem]").attr("compname")!==compname&&($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),showWarningErrorMsg(elem,errorIdd,compname))},0),undefined);comptype===ZFFieldTypeConstants.MATRIX_CHOICE&&(checkMandatoryMatrixChoice(elem)?$(elem).hasClass("error")&&removeErrorFromLiElem(elem):setTimeout(function(){$(document.activeElement).closest("li[elname=livefield-elem]").attr("compname")!==compname&&($(elem).find("input").removeClass("errorMatrixInput"),$(errorIdd).text(ZFLiveErrorConstants.matrixchoicetextboxmandatory),isMatrixChoiceRangeErrAvailableAfterClientValidation(errorIdd)?$(elem).addClass("error"):showWarningErrorMsg(elem,errorIdd,compname))},0))}if(isInputAddedToField||comptype===ZFFieldTypeConstants.MATRIX_CHOICE){if(typeof constrJson[linkname]!==ResponseKey.UNDEFINED){var dataSpecJson=constrJson[linkname];if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.MULTI_LINE)return rangeValidationForTextFields(elem,errorIdd,dataSpecJson,comptype,compname);if(comptype===ZFFieldTypeConstants.NUMBER){if(validateNumber(elem)){var inputVal=$.trim($(elem).find("input[type=text]").val());return rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype)}return $(errorIdd).text(ZFLiveErrorConstants.numbererror),!1}if(comptype===ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY){inputVal=$.trim($(elem).find("input[type=text]").val());if(decimLenFormValidation(elem,errorIdd,comptype)){var decimalFormat=$(elem).attr("decimalformat");return inputVal=$.trim(ZFUtil.getReformattedDecimal(inputVal,decimalFormat)),rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype)}return!1}if(comptype==ZFFieldTypeConstants.DATE)return rangeValidationForDate(elem,dataSpecJson,errorIdd,comptype);if(comptype==ZFFieldTypeConstants.DATETIME)return rangeValidationForDateTime(elem,dataSpecJson,errorIdd,comptype);if(comptype==ZFFieldTypeConstants.EMAIL){var emailErrArray=new Array;return validateEmail(elem,compname,emailErrArray)?rangeValidationForTextFields(elem,errorIdd,dataSpecJson,comptype,compname):(hideFieldReConfErr(compname),$(errorIdd).text(emailErrArray[0]),!1)}if(comptype==ZFFieldTypeConstants.MATRIX_CHOICE)return setTimeout(function(){needMatrixRangeValidation(elem,compname)&&(isMatrixChoiceRangeErrAvailableAfterClientValidation(errorIdd)?(rangeValidationForMatrixChoiceFields(elem,errorIdd,dataSpecJson,undefined)?$(errorIdd).removeClass("rangeError").hide():($(errorIdd).addClass("rangeError"),animateErrorMsg(errorIdd)),$(elem).removeClass("error")):rangeValidationForMatrixChoiceFields(elem,errorIdd,dataSpecJson,inputElem))},0),undefined;if(comptype==ZFFieldTypeConstants.PHONE){fldDiv=$(elem).find("div[elname=phoneFormatElem]"),phoneFormat=$(fldDiv).attr("phoneFormat"),ismandatory=$(elem).attr("mandatory"),reconfCompname=compname+"-reconf";return $(reconfCompname).hide(),setTimeout(function(){if(needToValidatePhone(compname,"confPhoneFld"))if(validatePhoneField(elem,errorIdd,ismandatory)&&phoneLengthCheck(elem,errorIdd,dataSpecJson)){$(document.activeElement).parents("div[name=phone-elements]").attr("elname");$(errorIdd).removeClass("rangeError").removeClass("warningMessage"),$(elem).find("p[elname=error]").hide();var reconf_input=$(elem).find("div[elname=confPhoneFld]").find("input");needConf(elem)&&$.trim($(reconf_input).val()).length>0?ZFLive.checkPhFldIdentical(elem,compname,!0,!1)?isSfChild(elem)?validateSFUniqueness(elem):removeErrorFromLiElem(elem):isSfChild(elem)&&clearSFUniqueError(elem):isSfChild(elem)?validateSFUniqueness(elem):removeErrorFromLiElem(elem)}else hideFieldReConfErr(compname),showWarningErrorMsg(elem,errorIdd,compname),isSfChild(elem)&&clearSFUniqueError(elem);else isSfChild(elem)&&validateSFUniqueness(elem)},0),undefined}}else if(comptype==ZFFieldTypeConstants.WEBSITE&&!ZFUtil.validateLiveUrl($(elem).find("input").val()))return $(errorIdd).text(ZFLiveErrorConstants.urlerror),!1}else comptype==ZFFieldTypeConstants.PHONE&&removeReconfErrorFromLiElem(elem);return!0}function phoneLengthCheck(elem,errorIdd,dataSpecJson){var numOfDigits=0;if($(elem).find("div[elname=phoneFormatElem]").attr("phoneFormat")==ZFPhoneFormatConstants.INTERNATIONAL){if($(elem).find("div[elname=phoneFld]").find("input").each(function(indexelem,inpElem){numOfDigits+=getNumberOfDigitsInString($.trim($(inpElem).val()))}),numOfDigits<dataSpecJson[DataSpecConst.MIN_LEN])return $(errorIdd).text(ZFLiveErrorConstants.mindigitslimit.replace("{0}",dataSpecJson[DataSpecConst.MIN_LEN])),!1;if(numOfDigits>dataSpecJson[DataSpecConst.MAX_LEN])return $(errorIdd).text(ZFLiveErrorConstants.maxdigitslimit.replace("{0}",dataSpecJson[DataSpecConst.MAX_LEN])),!1}return!0}function rangeValidationForDate(elem,dataSpecJson,errorIdd,comptype){var inpVal=$.trim($(elem).find("input").val()),dateFormat=$("#zf_date_format").val(),dateLocale=$("#zf_date_format").attr("dateLocale"),clientDateFormat=$(elem).find("div[elname][datelocale]").attr("elname");if(!(ZFUtil.validateDate(inpVal,dateFormat,dateLocale)&&inpVal.length>0))return $(errorIdd).text(ZFLiveErrorConstants.invaliddate),!1;var dynamicMaxJson=dataSpecJson[DataSpecConst.MAX_LIMIT],dynamicMinJson=dataSpecJson[DataSpecConst.MIN_LIMIT],dateElem=ZFUtil.splitDateVal(inpVal,dateFormat,dateLocale),userDate=new Date(dateElem[2],dateElem[1],dateElem[0]),dateRangeType=dataSpecJson[DataSpecConst.TYPE];if("2"==dateRangeType){var limitDateElem=getCurrentDateElemForLimit(dateFormat,dateLocale),limitDate=new Date(limitDateElem[2],limitDateElem[1],limitDateElem[0]);if(typeof dataSpecJson[DataSpecConst.INCLUDE_TODAY]==ResponseKey.UNDEFINED||dataSpecJson[DataSpecConst.INCLUDE_TODAY]||limitDate.setDate(limitDate.getDate()-1),(dayDiff=ZFUtil.getDateDiff(userDate,limitDate))<0){var errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",convertJsDateTimeToNormal(limitDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}else if("3"==dateRangeType){limitDateElem=getCurrentDateElemForLimit(dateFormat,dateLocale),limitDate=new Date(limitDateElem[2],limitDateElem[1],limitDateElem[0]);if(typeof dataSpecJson[DataSpecConst.INCLUDE_TODAY]==ResponseKey.UNDEFINED||dataSpecJson[DataSpecConst.INCLUDE_TODAY]||limitDate.setDate(limitDate.getDate()+1),(dayDiff=ZFUtil.getDateDiff(limitDate,userDate))<0){errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",convertJsDateTimeToNormal(limitDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}else if("4"==dateRangeType){limitDateElem=getCurrentDateElemForLimit(dateFormat,dateLocale),limitDate=new Date(limitDateElem[2],limitDateElem[1],limitDateElem[0]);if(typeof(dayDiff=ZFUtil.getDateDiff(limitDate,userDate))!=ResponseKey.UNDEFINED&&0!=dayDiff){errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",convertJsDateTimeToNormal(limitDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}else{var dateLocaleConvertedLimit;if("5"==dateRangeType||"7"==dateRangeType)if(typeof dataSpecJson[DataSpecConst.FROM_DATE]!==ResponseKey.UNDEFINED){if(dateComparision(inpVal,dateLocaleConvertedLimit=ZFUtil.getCurrentDateInLocale(dataSpecJson[DataSpecConst.FROM_DATE],clientDateFormat,dateLocale),dateFormat,dateLocale)){errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",dateLocaleConvertedLimit);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.MIN_LIMIT]!==ResponseKey.UNDEFINED){var minDate=getDateLimit(elem,dynamicMinJson,dateFormat,dateLocale,dataSpecJson[DataSpecConst.DISABLED_DAYS]);if(typeof minDate!=ResponseKey.UNDEFINED)if((dayDiff=ZFUtil.getDateDiff(minDate,userDate))<0){errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",convertJsDateTimeToNormal(minDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}if("6"==dateRangeType||"7"==dateRangeType)if(typeof dataSpecJson[DataSpecConst.TO_DATE]!==ResponseKey.UNDEFINED){if(dateComparision(dateLocaleConvertedLimit=ZFUtil.getCurrentDateInLocale(dataSpecJson[DataSpecConst.TO_DATE],clientDateFormat,dateLocale),inpVal,dateFormat,dateLocale)){errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",dateLocaleConvertedLimit);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.MAX_LIMIT]!==ResponseKey.UNDEFINED){var dayDiff,maxDate=getDateLimit(elem,dynamicMaxJson,dateFormat,dateLocale,dataSpecJson[DataSpecConst.DISABLED_DAYS]);if(typeof maxDate!=ResponseKey.UNDEFINED)if((dayDiff=ZFUtil.getDateDiff(userDate,maxDate))<0){errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",convertJsDateTimeToNormal(maxDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}}if(typeof dataSpecJson[DataSpecConst.DISABLED_DAYS]!==ResponseKey.UNDEFINED){var disabledDays=dataSpecJson[DataSpecConst.DISABLED_DAYS];if(!ZFUtil.blockDays(userDate,disabledDays)[0]){errMsg=ZFLiveErrorConstants.disabledayslimit.replace("{0}",getDayName(userDate.getDay(),dateLocale));return $(errorIdd).text(errMsg),!1}}return!0}function rangeValidationForDateTime(elem,dataSpecJson,errorIdd,comptype){var dateTime=$.trim($(elem).find("input").val()),dateFormat=$("#zf_date_format").val(),dateLocale=$("#zf_date_format").attr("dateLocale"),timeFormat=$(elem).attr("timeformat");$(elem).find("div[elname][datelocale]").attr("elname");if(!ZFUtil.validateDateTime(dateTime,dateFormat,dateLocale,timeFormat))return $(errorIdd).text(ZFLiveErrorConstants.invaliddatetime),!1;var jsDateTime=new Date(ZFUtil.convertToGeneralDateTime(dateTime,dateFormat,dateLocale,timeFormat)),dynamicMaxJson=dataSpecJson[DataSpecConst.DYNAMIC_TO_DATE],dynamicMinJson=dataSpecJson[DataSpecConst.DYNAMIC_FROM_DATE];dateTime.indexOf(" ");if(timeFormat!=TimeFormat.HOURS_12.CODE||"dd-mmm-yyyy"!=dateFormat.toLowerCase()&&"dd-mmmm-yyyy"!=dateFormat.toLowerCase()&&"mmmm-dd-yyyy"!=dateFormat.toLowerCase()||ZFUtil.getSplitIndexofDateTime(dateTime),typeof dataSpecJson[DataSpecConst.FROM_DATE]!==ResponseKey.UNDEFINED){var fromDate=dataSpecJson[DataSpecConst.FROM_DATE];if(compareDateTimeValues(dateTime,fromDate,dateFormat,dateLocale,timeFormat)){var errMsg=ZFLiveErrorConstants.mindatetimelimit.replace("{0}",fromDate);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.DYNAMIC_FROM_DATE]!==ResponseKey.UNDEFINED){var minDateTime=ZFUtil.getDateTimeFromDynamicJson(elem,dynamicMinJson,dateFormat,dateLocale,"min");if(typeof minDateTime!=ResponseKey.UNDEFINED&&minDateTime.getTime()>jsDateTime.getTime()){errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",convertJsDateTimeToNormal(minDateTime,dateFormat,dateLocale,!0));return $(errorIdd).text(errMsg),!1}}if(typeof dataSpecJson[DataSpecConst.TO_DATE]!==ResponseKey.UNDEFINED){var toDate=dataSpecJson[DataSpecConst.TO_DATE];if(compareDateTimeValues(toDate,dateTime,dateFormat,dateLocale,timeFormat)){errMsg=ZFLiveErrorConstants.maxdatetimelimit.replace("{0}",toDate);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.DYNAMIC_TO_DATE]!==ResponseKey.UNDEFINED){var maxDateTime=ZFUtil.getDateTimeFromDynamicJson(elem,dynamicMaxJson,dateFormat,dateLocale,"max",dynamicMinJson,minDateTime);if(typeof maxDateTime!=ResponseKey.UNDEFINED&&maxDateTime.getTime()<jsDateTime.getTime()){errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",convertJsDateTimeToNormal(maxDateTime,dateFormat,dateLocale,!0));return $(errorIdd).text(errMsg),!1}}if(typeof dataSpecJson[DataSpecConst.DISABLED_DAYS]!==ResponseKey.UNDEFINED){var disabledDays=dataSpecJson[DataSpecConst.DISABLED_DAYS];if(!ZFUtil.blockDays(jsDateTime,disabledDays)[0]){errMsg=ZFLiveErrorConstants.disabledayslimit.replace("{0}",getDayName(jsDateTime.getDay(),dateLocale));return $(errorIdd).text(errMsg),!1}}return!0}function convertGenDateTimeWithLocale(genDateTime,clientDateFormat,dateLocale){var genDateTime_datevalue=getDateFromDateTimeValue(genDateTime),genDate_LocaleConvLimit=ZFUtil.getCurrentDateInLocale(genDateTime_datevalue,clientDateFormat,dateLocale),genDateTime_timevalue=getTimeFromDateTimeValue(genDateTime);return genDate_LocaleConvLimit+" "+(genDateTime_timevalue="AM"==genDateTime_timevalue.substring(genDateTime_timevalue.indexOf(" ")+1,genDateTime_timevalue.length)?genDateTime_timevalue.substring(0,genDateTime_timevalue.indexOf(" ")+1)+CustomDateLocale[dateLocale].AM:genDateTime_timevalue.substring(0,genDateTime_timevalue.indexOf(" ")+1)+CustomDateLocale[dateLocale].PM)}function decimLenFormValidation(elem,errorIdd,comptype){var decimallength=$(elem).attr("decimallength");if(!validateDecimalLength(elem,decimallength)){var errMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.decimallengtherror,decimallength);return $(errorIdd).text(errMsg),!1}if(!validateCurrency(elem)){var format=$(elem).attr("decimalformat");return errMsg=comptype==ZFFieldTypeConstants.CURRENCY?ZFUtil.replaceParams(ZFLiveErrorConstants.invalidcurrency,ZFUtil.getDecimalErrorNO(format)):ZFUtil.replaceParams(ZFLiveErrorConstants.decimalerror,ZFUtil.getDecimalErrorNO(format)),$(errorIdd).text(errMsg),!1}return!0}function validatePhoneField(elem,errorIdd,ismandatory){var id=$(elem).attr("id"),fldDiv=$(elem).find("div[elname=phoneFormatElem]");if($(fldDiv).attr("phoneFormat")==ZFPhoneFormatConstants.USAFORMAT){var inValidFormat=!1,inpElem=$(fldDiv).find("div[elname=phoneFld]").find("input"),conLen=$.trim($(inpElem[0]).val()).length,firstLen=$.trim($(inpElem[1]).val()).length,secLen=$.trim($(inpElem[2]).val()).length;if(0==conLen&&0==firstLen&&0==secLen?inValidFormat=!1:$(fldDiv).find("div[elname=phoneFld]").find("input").each(function(index,phelem){var elname=$(phelem).attr("elname"),valLen=$.trim($(phelem).val()).length;"countrycode"==elname||"first"==elname?valLen<3&&(inValidFormat=!0):"second"==elname&&valLen<4&&(inValidFormat=!0)}),inValidFormat)return $(errorIdd).text(ZFLiveErrorConstants.invalidUSAphone),!1;if(!validateUSAPhoneNumber(id))return $(errorIdd).text(ZFLiveErrorConstants.invalidUSAphone),!1}else if("true"==$(elem).find("input").attr("iscodeEnabled")){if(!validateInterNationalPhoneNumber(id,errorIdd,!0))return!1;if("true"==ismandatory&&!countryCodeMandatoryCheck(elem))return $(errorIdd).text(ZFLiveErrorConstants.selectcountrycode),!1;if(!validateCountryCode(id))return $(errorIdd).text(ZFLiveErrorConstants.countrycodeformaterror),!1}else if(!validateInterNationalPhoneNumber(id,errorIdd,!1))return!1;return!0}function rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype){if(!1===dataSpecJson[DataSpecConst.IS_NEGATIVE]&&"-"==inputVal.charAt(0)){var errMsg=ZFLiveErrorConstants.minvalerror.replace("{0}","0");return $(errorIdd).text(errMsg),!1}if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.DIGITS){var minLen=dataSpecJson[DataSpecConst.MIN_LEN],maxLen=dataSpecJson[DataSpecConst.MAX_LEN],numOfDigits=getNumberOfDigitsInString(inputVal);if(numOfDigits<minLen||numOfDigits>maxLen){errMsg=getErrMessageForDigitValidation(numOfDigits,minLen,maxLen);return $(errorIdd).text(errMsg),!1}}else if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.VALUES){if(typeof dataSpecJson[DataSpecConst.MIN_VAL]!==ResponseKey.UNDEFINED&&check_Lessthan(inputVal,dataSpecJson[DataSpecConst.MIN_VAL],comptype)){errMsg=ZFLiveErrorConstants.minvalerror.replace("{0}",dataSpecJson[DataSpecConst.MIN_VAL].toString());return $(errorIdd).text(errMsg),!1}if(typeof dataSpecJson[DataSpecConst.MAX_VAL]!==ResponseKey.UNDEFINED&&check_Greaterthan(inputVal,dataSpecJson[DataSpecConst.MAX_VAL],comptype)){errMsg=ZFLiveErrorConstants.maxvalerror.replace("{0}",dataSpecJson[DataSpecConst.MAX_VAL].toString());return $(errorIdd).text(errMsg),!1}}return!0}function getErrMessageForDigitValidation(numOfDigits,minLen,maxLen){return numOfDigits<minLen?ZFLiveErrorConstants.mindigitslimit.replace("{0}",minLen.toString()):numOfDigits>maxLen?ZFLiveErrorConstants.maxdigitslimit.replace("{0}",maxLen.toString()):void 0}function checkDatePicker(input){isIELessThan9()||typeof ZFLive.constraintJson===ResponseKey.UNDEFINED||setTimeout(function(){0===$(document.activeElement).closest("div[id=ui-datepicker-div]").length&&ZFLive.validateFieldConstraint(input)},0)}function getNumberOfDigitsInString(str){var numArr=str.match(/\d{1}/g);return null!==numArr?numArr.length:0}function isValidMatrixChoiceType(matrixChoiceType){return matrixChoiceType==MatrixChoicesType.RADIO.CODE||matrixChoiceType==MatrixChoicesType.CHECKBOX.CODE||matrixChoiceType==MatrixChoicesType.DROPDOWN.CODE||matrixChoiceType==MatrixChoicesType.TEXTBOX.CODE}function convertJsDateTimeToNormal(jsDate,dateFormat,dateLocale,needTime){var normalDateTime,datesep;(dateFormat=dateFormat.toLowerCase()).indexOf("-")>=0?datesep="-":dateFormat.indexOf("/")>=0?datesep="/":dateFormat.indexOf(".")>=0&&(datesep=".");var date=jsDate.getDate(),year=jsDate.getFullYear(),monthNo=jsDate.getMonth(),month=monthNo+1;if(month=month<10?"0"+month:month,"dd-mmm-yyyy"==dateFormat){var monthArray=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");typeof dateLocale!=ResponseKey.UNDEFINED&&(monthArray=CustomDateLocale[dateLocale].monthNamesShort),month=monthArray[monthNo]}else if("dd-mmmm-yyyy"==dateFormat||"mmmm-dd-yyyy"==dateFormat){monthArray=new Array("January","February","March","April","May","June","July","August","September","October","November","December");typeof dateLocale!=ResponseKey.UNDEFINED&&(monthArray=CustomDateLocale[dateLocale].monthNames),month=monthArray[monthNo]}if(date=date<10?"0"+date:date,"dd-mmm-yyyy"==dateFormat||"dd-mmmm-yyyy"==dateFormat?normalDateTime=date+datesep+month+datesep+year:"yyyy/mm/dd"==dateFormat||"yyyy-mm-dd"==dateFormat?normalDateTime=year+datesep+month+datesep+date:"mm-dd-yyyy"==dateFormat||"mm/dd/yyyy"==dateFormat||"mmmm-dd-yyyy"==dateFormat?normalDateTime=month+datesep+date+datesep+year:"dd.mm.yyyy"!=dateFormat&&"dd-mm-yyyy"!=dateFormat&&"dd/mm/yyyy"!=dateFormat||(normalDateTime=date+datesep+month+datesep+year),needTime){var meridiem="AM",hours=jsDate.getHours();hours>=12&&(hours-=12,meridiem="PM"),"AM"==meridiem?meridiem=CustomDateLocale[dateLocale].AM:"PM"==meridiem&&(meridiem=CustomDateLocale[dateLocale].PM),0==hours&&(hours=12),hours=hours<10?"0"+hours:hours;var minutes=jsDate.getMinutes();normalDateTime=normalDateTime+" "+hours+":"+(minutes=minutes<10?"0"+minutes:minutes)+" "+meridiem}return normalDateTime}function getDayName(day,dateLocale){var dayNamesArray=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");return typeof dateLocale!=ResponseKey.UNDEFINED&&(dayNamesArray=CustomDateLocale[dateLocale].dayNames),dayNamesArray[day]}function setWidthForCurrencySymbolInSubForm(pageUl){$(pageUl).find('li[elemtype="subFormField"][viewtype="1"]').each(function(sfInd,sfLi){$(sfLi).find('[elname="subFormLabelDiv"]').length>0&&$(sfLi).find('[elname="subFormLabelDiv"]').is(":visible")&&($(sfLi).find("ul[elname=subFormFieldsCloneUl]").show(),$(sfLi).find("li[comptype=4]").each(function(index,elem){var symbolWidth=$(elem).find("span[elname=currencySymbolSpan]").outerWidth(!0)+1,totalWidth=$(elem).find("div[elname=tempContDiv]").outerWidth(!0);$(elem).find("input").css("width",totalWidth-symbolWidth)}),$(sfLi).find("ul[elname=subFormFieldsCloneUl]").hide(),$(sfLi).find("ul[elname=subFormFieldsUl]").find("li[comptype=4]").each(function(index,elem){var symbolWidth=$(elem).find("span[elname=currencySymbolSpan]").outerWidth(!0)+1,totalWidth=$(elem).find("div[elname=tempContDiv]").outerWidth(!0);$(elem).find("input").css("width",totalWidth-symbolWidth)}))})}function recaptcha_callback_inv(){$("#pleaseWait_Div").hide(),ZFLive.isSaveReq?ZFLive.ProceedToSave(!1):ZFLive.mode==Mode.EDIT?ZFLive.ProceedToUpdate():ZFLive.ProceedToSubmit()}function recaptcha_callback_cbox(){var elem=$("#recaptchacbox-li");$(elem).find("p[elname=error]").hide()}function preventCutCopyPasteInEmailReconf(){$("#formDiv").find("li[comptype="+ZFFieldTypeConstants.EMAIL+"]").find("span[elname=livefield-reconf-elem]").find("input").on("cut copy paste",function(e){e.preventDefault()})}function preventCutCopyPasteInPhoneReconf(){$("#formDiv").find("li[comptype="+ZFFieldTypeConstants.PHONE+"]").find("div[elname=confPhoneFld]").find("input").on("cut copy paste",function(e){e.preventDefault()})}function reUploadAllFiles(){for(var key in ZFLive.storedFiles){var fileUploadJSON=ZFLive.storedFiles[key],liElem=$("#"+key+"-li");Object.keys(fileUploadJSON).length>0&&($(liElem).find("li[elname=newlyAddedFUElement]").remove(),ZFLive.reAddMultipleFileUploadFields(fileUploadJSON,key))}}function readFileAgain(fileObj,fileUploadLi,linkName,fileUploadUniqueName){var fileName=fileObj.name,fileExtension=fileName.substr(fileName.lastIndexOf(".")+1),fileNamewithoutExt=fileName.slice(0,-fileExtension.length),fileType=fileObj.type;if(fileObj.size>2e7){var errorMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.uploadsize,20),rdFileErrTg=$("#test").find("#error-"+linkName);return rdFileErrTg.text(errorMsg),animateErrorMsg(rdFileErrTg),!1}var reader=new FileReader;return reader.onload=function(e){fileUploadLi.find("img[elname=fileImage]").attr("src",e.target.result),fileUploadLi.attr("elname","newlyAddedFUElement"),fileUploadLi.attr("name","singleFileElement"),fileUploadLi.attr("Linkname",fileUploadUniqueName),fileUploadLi.find("em[elname=fileName]").text(fileNamewithoutExt),fileUploadLi.find("b[elname=fileExtension]").text(fileExtension),fileUploadLi.find("p[elname=fileSize]").text(ZFLive.convertBytes(fileObj.size)),fileUploadLi.find("a[name=removeFileElement]").attr("elname",fileUploadUniqueName),fileType.match("image.*")?fileUploadLi.find("div[elname=fileNonImage]").hide():(fileUploadLi.find("a[elname=zoomIcon]").hide(),fileUploadLi.find("img[elname=fileImage]").hide()),fileUploadLi.show()},reader.readAsDataURL(fileObj),!0}$(document).ready(function(){ZFLive.enableSubmitBtn(),setMaxWidthForDescriptionFieldImages($("#formDiv").width()),preventCutCopyPasteInEmailReconf(),preventCutCopyPasteInPhoneReconf(),document.fonts&&document.fonts.ready.then(function(){triggerFormResize()})}),ZFLive.generatePaymentTokenAndSubmitData=function(){$("#paymentProcessingDiv").show(),setPopUpElemPosition($("#paymentProcessingDivCont"));var paymentLI=$("#formBodyDiv").find(".pmnt"),authNetMerchantDiv=$(paymentLI).find("div[elname=authNetMerchantDiv]"),secureDataToAuthNet={cardData:{cardNumber:$(authNetMerchantDiv).find("input[elname=authNetAccNo]").val(),month:$(authNetMerchantDiv).find("select[elname=authNetExpMonth]").find("option:selected").val(),year:$(authNetMerchantDiv).find("select[elname=authNetExpYear]").find("option:selected").val(),cardCode:$(authNetMerchantDiv).find("input[elname=authNetCardCode]").val()},authData:{clientKey:ZFLive.authNetPublicClientKey,apiLoginID:ZFLive.authNetApiLoginID}};Accept.dispatchData(secureDataToAuthNet,authNetResponseHandler)},ZFLive.createStripeCardAndMount=function(){ZFLive.stripeCard=ZFLive.stripeElements.create("card",{style:{base:{color:"#444444",fontFamily:"Open Sans, Consolas, Menlo, monospace",fontSize:"13px","::placeholder":{color:"#7b7c86"},":-webkit-autofill":{color:"#7b7c86"}},invalid:{color:"#ff0000","::placeholder":{color:"#7b7c86"}}}}),ZFLive.stripeCard.mount("#stripe-card-element")},ZFLive.generateStripeTokenAndSubmitData=function(){$("#paymentProcessingDiv").show(),setPopUpElemPosition($("#paymentProcessingDivCont"));var paymentLi=$("#PaymentAmount-li"),stripeDiv=$(paymentLi).find("div[elname=stripeMerchantDiv]"),nameOnCard=$(stripeDiv).find("input[elname=stripeCardName]").val(),options={};""!=$.trim(nameOnCard)&&(options={billing_details:{name:nameOnCard}}),ZFLive.stripeObj.createPaymentMethod("card",ZFLive.stripeCard,options).then(function(result){if($("#paymentProcessingDiv").hide(),result.error){ZFLive.enableSubmitBtn(),$(paymentLi).find("div[elname=stripeMerchantDiv]").addClass("error1");var stripeErrElem=$(paymentLi).find("span[elname=stripePaymentError]");$(stripeErrElem).text(result.error.message),animateErrorMsg(stripeErrElem),showAndHidePage(paymentLi.parent().attr("page_no")),triggerFormResizeOnTimeOut(),ZFLive.stripeCard.focus(),cancelSubmitOrUpdateFormAction()}else $(paymentLi).find("div[elname=stripeMerchantDiv]").removeClass("error1"),$("#payment-error").hide(),stripeTokenHandler(result)})},ZFLive.handleStripePayIntentAction=function(respJson){respJson[ZFFormPayments.STRIPE.INTENT].requires_action?ZFLive.stripePaymentIntentAction(respJson):ZFLive.showPaymentFailRecordRetryErr(i18n.formPaymentError)},ZFLive.stripePaymentIntentAction=function(respJson){$("#merchantActionDiv").show(),setPopUpElemPosition($("#merchantActionDivCont"));var stripeActionJson=respJson[ZFFormPayments.STRIPE.INTENT],sameFormUrl="";typeof respJson.same_form_url!==ResponseKey.UNDEFINED&&(sameFormUrl=respJson.same_form_url);var redirectURL=respJson.thankyou_page_URL,openRedirectURLIn=respJson.open_thankyou_page_URL_in,redirType=respJson.redirect_type;ZFLive.stripeObj.handleCardAction(stripeActionJson.payment_intent_client_secret).then(function(result){var stripeIntentJson={referenceid:respJson[ZFFormPayments.KEY.REF_ID]};if(result.error){var errMsg="";typeof result.error.message!==ResponseKey.UNDEFINED?errMsg=result.error.message:typeof result.error.payment_intent!==ResponseKey.UNDEFINED&&typeof result.error.payment_intent.last_payment_error!==ResponseKey.UNDEFINED&&(errMsg=result.error.payment_intent.last_payment_error.message),stripeIntentJson.errormsg=errMsg,stripeIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=2}else stripeIntentJson[ZFFormPayments.STRIPE.INTENT_ID]=result.paymentIntent.id,stripeIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=0;ZFLive.performStripeIntentCapturedRedir(stripeIntentJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType)})},ZFLive.performStripeIntentCapturedRedir=function(stripeIntentJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType){var formPerma=document.getElementById("formPerma").value;0===formPerma.length?reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/stripeintentcapture":reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/stripeintentcapture";var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(stripeIntentJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){$("#merchantActionDiv").hide();var stripeResp=JSON.parse(jqXhr.responseText);if(200==jqXhr.status){if(1==stripeResp.pmntstatusflag)performDefaultRedirection(redirectURL,openRedirectURLIn,sameFormUrl,ZFormType.FORMS,redirType);else if(2==stripeResp.pmntstatusflag){for(var errMsg="",errArr=stripeResp[ZFLiveConstants.RESPONSE.ERRORS],i=0;i<errArr.length;i++)for(var key in errArr[i])errMsg+=errArr[i][key];ZFLive.showPaymentFailRecordRetryErr(errMsg)}}else if(409==jqXhr.status||400==jqXhr.status){errMsg="";if(typeof stripeResp[ZFLiveConstants.RESPONSE.ERROR]!=ResponseKey.UNDEFINED&&typeof stripeResp[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS]!=ResponseKey.UNDEFINED){showErrorPopUp(stripeResp[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS],i18n.contactadmin)}else{for(errArr=stripeResp[ZFLiveConstants.RESPONSE.ERRORS],i=0;i<errArr.length;i++)for(var key in errArr[i])errMsg+=errArr[i][key];ZFLive.showPaymentFailRecordRetryErr(errMsg)}}else ZFLive.showPaymentFailRecordRetryErr(stripeResp)}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.fetchUserLocation=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(fetchUserLocationSuccess)},ZFLive.SubmitData=function(){var formPerma=document.getElementById("formPerma").value,paymentForm=$("#isPaymentForm").val();ZFLive.valueJson={},$("#test").find("ul[elname=formBodyULName]").children("li").each(function(index,elem){var id=$(elem).attr("id"),needdata=$(elem).attr("needdata"),needPageData=$(elem).parent("ul").attr("needpagedata");id&&"true"==needdata&&"true"==needPageData&&constructFormFieldDataJsonForSubmit(ZFLive.valueJson,elem)}),ZFLive.mode==Mode.SAVED_RECORD&&(ZFLive.valueJson.record_perma=ZFLive.encodedString);var antiSpamCheckUrl=$("#antispam-url-id").val(),reqUri="",formtype=parseInt($("#formType").val());if(formtype===ZFormType.FORMS){var referrerName=$.trim($("#referrerName").val());""!=referrerName&&"null"!=referrerName&&null!=referrerName||(referrerName=document.referrer),referrerName.indexOf(antiSpamCheckUrl)>-1&&(referrerName=""),""!=referrerName&&(ZFLive.valueJson.REFERRER_NAME=referrerName),1==ZFLive.isGeolocationEnabled&&ZFUtil.validateLatitudeFormat(ZFLive.fetchedLatitude)&&ZFUtil.validateLongitudeFormat(ZFLive.fetchedLongitude)&&(ZFLive.valueJson[SystemGeneratedField.ZF_ADDED_LATITUDE.LINK_NAME]=ZFLive.fetchedLatitude,ZFLive.valueJson[SystemGeneratedField.ZF_ADDED_LONGITUDE.LINK_NAME]=ZFLive.fetchedLongitude);var zc_gad=$.trim($("#zc_gad").val());""!=zc_gad&&zc_gad!=undefined&&(ZFLive.valueJson.GOOGLE_CLICK_ID=zc_gad);var utmParamInpElems=$("#zf_utmTrack").find("input[elname=utmParamInp]");if(utmParamInpElems.length>0){var utmParamValJson={};$(utmParamInpElems).each(function(idx,inpElem){var utmVal=$(inpElem).val();if(typeof utmVal!==ResponseKey.UNDEFINED&&""!=utmVal){var utmPLinkName=$(inpElem).attr("name");utmParamValJson[utmPLinkName]=utmVal}}),ZFLive.valueJson.UTM_PARAM=utmParamValJson}var langCode=$.trim($("#langcode").val());""!=langCode&&langCode!=undefined&&(ZFLive.valueJson[SystemGeneratedField.ADDED_LANGUAGE.LINK_NAME]=langCode),window.top.location!==window.self.location&&(ZFLive.valueJson[ZSRedir.ZS_IF_DOMAIN]=document.referrer),reqUri=0===formPerma.length?"/"+this.portalName+"/form/"+this.formLinkName+"/records":"/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/records"}else formtype!==ZFormType.DOCSFORMS&&formtype!==ZFormType.WRITERFORMS||(reqUri="true"===$("#isDocsPublicForm").val()?"/"+this.portalName+"/form/"+this.formLinkName+"/pushdata/public?rid="+$("#formrid").val():"/"+this.portalName+"/form/"+this.formLinkName+"/pushdata");var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/zoho.forms-v1+json",DATA:JSON.stringify(ZFLive.valueJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),xmlString=jqXhr.responseText,200==jqXhr.status){var isValidJson=isValidJSON(xmlString);if(ZFLive.performPageSenseIntegration(),ZFLive.performSalesIQIntegration(),"true"!==paymentForm||isValidJson){var respJson=JSON.parse(xmlString);"true"===paymentForm&&typeof respJson[ZFFormPayments.STRIPE.INTENT]!==ResponseKey.UNDEFINED?ZFLive.handleStripePayIntentAction(respJson):"true"===paymentForm&&typeof respJson[ZFFormPayments.KEY.PAYMNT_ID_JSON]!==ResponseKey.UNDEFINED&&respJson[ZFFormPayments.KEY.PAYMNT_ID_JSON][ZFFormPayments.KEY.MERCHANT_TYPE]==ZFFormPayments.MERCHANT_TYPE.PAYPAL_CKOUT?handlePaypalCkoutAction(respJson):respJson.hasOwnProperty("splash_message")?(ZFLive.showSplashMessage(respJson.splash_message),setTimeout(function(){redirectionAfterSubmission(respJson,formtype)},2e3)):redirectionAfterSubmission(respJson,formtype)}else $("#paymentRedirectDiv").show(),setPopUpElemPosition($("#paymentRedirectDivCont")),$("#paymentDummyDiv").html(xmlString)}else ZFLive.enableSubmitBtn(),ZFLive.modifyAndNoteFilePathValInClient(),cancelSubmitOrUpdateFormAction(),400==jqXhr.status||401==jqXhr.status||403==jqXhr.status||404==jqXhr.status||409==jqXhr.status?(ZFLive.resetCurrentDateRef(),ZFLive.constructLiveErrorMessage(jqXhr),triggerFormResizeOnTimeOut()):500==jqXhr.status||503==jqXhr.status?500===jqXhr.status&&"Email not confirmed"===jqXhr.responseText?animateErrorMsg($("#errorDiv")):showInvalidEntriesMsg(i18n.internalserver):showInvalidEntriesMsg(i18n.invalidentriesfound),(isIELessThan10()||isWindowSafari())&&clearFilesOnError()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.performPageSenseIntegration=function(){ZFLive.isPageSenseIntegrationEnabled&&(window.pagesense=window.pagesense||[],window.pagesense.push(["trackEvent","zps-integration-custom-event"]))},ZFLive.performSalesIQIntegration=function(){if(ZFLive.isSalesIQIntegrationEnabled){var visitorinfo={};$("#formBodyDiv").find("li").each(function(index,elem){var fieldType=parseInt($(elem).attr("comptype")),fieldLinkName=$(elem).attr("compname");if(fieldType===ZFFieldTypeConstants.SINGLE_LINE||fieldType===ZFFieldTypeConstants.NAME||fieldType===ZFFieldTypeConstants.PHONE||fieldType===ZFFieldTypeConstants.EMAIL)for(var idx=0;idx<ZFLive.salesIQFieldsArray.length;idx++){var salesIQObj=ZFLive.salesIQFieldsArray[idx],zfFieldName=salesIQObj.formFieldName;if(fieldType===ZFFieldTypeConstants.SINGLE_LINE){if(fieldLinkName===zfFieldName){var salesIQValue=$(elem).find("input").val(),salesIQFieldName=salesIQObj.salesIQFieldName;salesIQValue&&("Phone"===salesIQFieldName&&(visitorinfo.contactnumber=salesIQValue),"Name"===salesIQFieldName&&(visitorinfo.name=salesIQValue))}}else if(fieldType===ZFFieldTypeConstants.NAME)fieldLinkName===zfFieldName&&$(elem).find("input,select").each(function(indexelem,elemnew){if(fieldLinkName===zfFieldName&&$(elemnew).attr("complink")===salesIQObj.fieldCompLinkName){var salesIQName=$(elemnew).val();salesIQName&&(visitorinfo.name=salesIQName)}});else if(fieldType===ZFFieldTypeConstants.EMAIL){if(fieldLinkName===zfFieldName){var salesIQEmail=$(elem).find("input:first").val();salesIQEmail&&(visitorinfo.email=salesIQEmail)}}else if(fieldType===ZFFieldTypeConstants.PHONE&&fieldLinkName===zfFieldName){var salesIQPhone=getSalesiqPhoneVal(elem);salesIQPhone&&(visitorinfo.contactnumber=salesIQPhone)}}}),parent.postMessage(JSON.stringify({type:"zoho.salesiq.apimessage",visitor:visitorinfo}),"*")}},ZFLive.showSplashMessage=function(splashMsg){if($("#splash_msg_text").text(splashMsg),0==ZFLive.isEmbedded)displaySplashMsg();else if(1==ZFLive.isEmbedded){var event=ZFLive.currEvent,scrollTop=$(window).scrollTop();if(event!=undefined&&(1==event.which||isMSIEbrowser()&&getMSIEversion()<=8&&0==event.which)){var submitBtnElem=$("#formDiv").find("ul[elname=footer]");if(submitBtnElem!=undefined)setSplashMsg(submitBtnElem.position().top-scrollTop+20);else displaySplashMsg()}else{var currFocusElem=ZFLive.currentFocusElem;if(currFocusElem!=undefined)setSplashMsg(currFocusElem.position().top+currFocusElem.outerHeight()/2-scrollTop);else displaySplashMsg()}}},ZFLive.modifyAndNoteFilePathValInClient=function(){if(ZFLive.mode==Mode.SAVED_RECORD)ZFLive.updateAndRemoveErrorFiles();else for(var key in ZFLive.storedFiles)$("#test").find("input[elname="+key+"]").attr("filepath","")},ZFLive.updateAndRemoveErrorFiles=function(){for(var key in ZFLive.storedFiles){var filePathString=$("#test").find("input[elname="+key+"]").attr("filepath");if(typeof filePathString!=ResponseKey.UNDEFINED&&""!=filePathString){var filePathArray=filePathString.split(","),fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFilePath in fileUploadJSON){var filepathtobedeleted=$("#"+key+"-div-files").find("a[elname="+uniqueFilePath+"]").attr("filepath");$("#test").find("a[elname="+uniqueFilePath+"]").attr("filepath","");var index=filePathArray.indexOf(filepathtobedeleted);-1!=index&&filePathArray.splice(index,1)}$("#test").find("input[elname="+key+"]").attr("filepath",filePathArray)}}},ZFLive.constructLiveErrorMessage=function(jqXhr){try{var onfocus,responseJson=JSON.parse(jqXhr.responseText),errArr=responseJson[ZFLiveConstants.RESPONSE.ERRORS],displayedErr=!1,hiddenFieldError=!1;if($.type(errArr)!==ZFLiveConstants.RESPONSE.UNDEFINED&&errArr.length>0)for(var msg="",pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length,i=0;i<errArr.length;i++)for(var key in errArr[i])if(key===ZFLiveConstants.VERIFICATIONCODE.KEY){var vCodeLi=$("#verificationcode-li"),vCodeErrTg=$(vCodeLi).find("#error-verificationcode");vCodeErrTg.text(i18n.wrongverificationcode),animateErrorMsg(vCodeErrTg),$(vCodeLi).addClass("error"),0===i&&(onfocus=$(vCodeLi).find(":input[type!=hidden]:first")),displayedErr=!0}else if(key===ZFLiveConstants.RECAPTCHA.ERROR_INV)showErrorPopUp(ZFLiveErrorConstants.recaptchaerror,i18n.contactadmin),displayedErr=!0;else if(key===ZFLiveConstants.RECAPTCHA.ERROR_CBOX){vCodeLi=$("#recaptchacbox-li");var reCapErrTg=$(vCodeLi).find("#error-recaptchacbox");reCapErrTg.text(ZFLiveErrorConstants.recaptchaerror),animateErrorMsg(reCapErrTg),displayedErr=!0}else if(-1!==key.indexOf("SubForm")){var subFormErrJson=errArr[i][key],entrysInErrorCount=0;for(var entryIndex in subFormErrJson)if("entry_limit"===entryIndex){if("true"==(parentElem=$("#"+key+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){$(parentElem).find("p#error-"+key).text(subFormErrJson[entryIndex]),animateErrorMsg($(parentElem).find("p#error-"+key));var pageNum=$(parentElem).parent().attr("page_no");0==i&&(showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount),onfocus=$(parentElem).find(":input[type!=hidden]:first")),displayedErr=!0}else hiddenFieldError=!0}else{for(var errorArrayInSubFormRow=subFormErrJson[entryIndex],subFormLi=$("#"+key+"-li"),subFormEntryRowInUI=$(subFormLi).find('ul[elname="subFormFieldsUl"][isvalidentry="true"]')[entryIndex],rowIndex=$(subFormEntryRowInUI).attr("rowId"),sfViewType=$(subFormLi).attr("viewtype"),arrIndex=0;arrIndex<errorArrayInSubFormRow.length;arrIndex++)for(var childElemKey in errorArrayInSubFormRow[arrIndex])if("unique_error"==childElemKey){var sfUniqueErrJson=errorArrayInSubFormRow[arrIndex][childElemKey],uniqueErrorFields=sfUniqueErrJson.fields;for(sfUniqueFldIdx=0;sfUniqueFldIdx<uniqueErrorFields.length;sfUniqueFldIdx++){var childElemKeyInUI=uniqueErrorFields[sfUniqueFldIdx]+"_"+parseInt(rowIndex);if("true"==(parentElem=$("#"+childElemKeyInUI+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){parentElem.addClass("error"),displayedErr=!0;pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");if(0==i&&0==entrysInErrorCount&&0==arrIndex&&0==sfUniqueFldIdx){showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount);var firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=$(firstErrElem),5!==(compType=parseInt(firstErrElem.parent().parent().parent().attr("compType")))&&16!==compType||$("#ui-datepicker-div").hide()}}}if($(subFormEntryRowInUI).find('p[elname="sfEntryError"]').text(sfUniqueErrJson.msg),animateErrorMsg($(subFormEntryRowInUI).find('p[elname="sfEntryError"]')),"2"==sfViewType){var sfCardWithErr=$(subFormLi).find('div[elname="sfcardelem"][cardrowid="'+rowIndex+'"]');if($(sfCardWithErr).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),0==i&&0==entrysInErrorCount&&0==arrIndex){var thisSubFormErrorPos=$(sfCardWithErr).offset().top,posToFix=((viewportBottom=(viewportTop=$(window).scrollTop())+$(window).height())-viewportTop)/3;(thisSubFormErrorPos>viewportBottom||thisSubFormErrorPos<viewportTop)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-posToFix},1e3)}}}else{childElemKeyInUI=childElemKey+"_"+parseInt(rowIndex);if("true"==(parentElem=$("#"+childElemKeyInUI+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");if(0==i&&0==entrysInErrorCount&&0==arrIndex){showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount);firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=$(firstErrElem),5!==(compType=parseInt(firstErrElem.parent().parent().parent().attr("compType")))&&16!==compType||$("#ui-datepicker-div").hide()}if(typeof(fieldType=$(parentElem).attr("comptype"))===ResponseKey.UNDEFINED||parseInt(fieldType)!==ZFFieldTypeConstants.ADDRESS&&parseInt(fieldType)!==ZFFieldTypeConstants.NAME){parentElem.addClass("error");var sfErrTg=$("#error-"+childElemKeyInUI);sfErrTg.text(errorArrayInSubFormRow[arrIndex][childElemKey]),animateErrorMsg(sfErrTg)}else ZFLive.showComponentMandatoryError(errorArrayInSubFormRow[arrIndex][childElemKey],parentElem,childElemKeyInUI);if("2"==sfViewType){sfCardWithErr=$(subFormLi).find('div[elname="sfcardelem"][cardrowid="'+rowIndex+'"]');if($(sfCardWithErr).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),0==i&&0==entrysInErrorCount&&0==arrIndex){var viewportTop,viewportBottom;thisSubFormErrorPos=$(sfCardWithErr).offset().top,posToFix=((viewportBottom=(viewportTop=$(window).scrollTop())+$(window).height())-viewportTop)/3;(thisSubFormErrorPos>viewportBottom||thisSubFormErrorPos<viewportTop)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-posToFix},1e3)}}displayedErr=!0}else hiddenFieldError=!0}"2"==sfViewType&&("true"==subFormLi.attr("needdata")&&ZFUtil.isFieldVisible(subFormLi)?($(subFormLi).find("p#error-"+key).text(i18n.subformcarderrgeneral),animateErrorMsg($(subFormLi).find("p#error-"+key)),displayedErr=!0):hiddenFieldError=!0),entrysInErrorCount++}}else if("FormPayment"==key||"PaymentAmount"==key||"merchant_type"==key){if(msg=errArr[i][key],"true"==(parentElem=$("#PaymentAmount-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){pageNum=$(parentElem).parent().attr("page_no");if(0==i&&(showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount),onfocus=$(parentElem).find(":input[type!=hidden]:first")),parentElem.addClass("error"),"PaymentAmount"==key||"merchant_type"==key){var pymntErrID=$("#error-PaymentAmount");$(pymntErrID).text(errArr[i][key]),animateErrorMsg(pymntErrID),displayedErr=!0}}if("FormPayment"==key){var paymentTransMsg="";msg==PaymentTransFailureType.PYMNT_NOT_PROCESSED?paymentTransMsg=paymentTransMsg+i18n.paymentnotprocessed+" "+i18n.paymentretry:msg==PaymentTransFailureType.PYMNT_NOT_PROCESSED_CNTCT_ADMIN?paymentTransMsg+=i18n.formPaymentError:paymentTransMsg=paymentTransMsg+msg+" "+i18n.paymentretry,showPaymentErrPopUp(paymentTransMsg),displayedErr=!0}}else{var parentElem;if("true"==(parentElem=$("#"+key+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var fieldType;pageNum=$(parentElem).parent().attr("page_no");if(0==i){showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount);var compType;firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=$(firstErrElem),5!==(compType=parseInt(firstErrElem.parent().parent().parent().attr("compType")))&&16!==compType||$("#ui-datepicker-div").hide()}if(typeof(fieldType=$(parentElem).attr("comptype"))!==ResponseKey.UNDEFINED&&parseInt(fieldType)===ZFFieldTypeConstants.ZOHO_CRM){var errElem=$(parentElem).find('p[elname="error"]');$(errElem).text(errArr[i][key]),animateErrorMsg(errElem),parentElem.addClass("error")}else if(typeof fieldType===ResponseKey.UNDEFINED||parseInt(fieldType)!==ZFFieldTypeConstants.ADDRESS&&parseInt(fieldType)!==ZFFieldTypeConstants.NAME)if(typeof fieldType!==ResponseKey.UNDEFINED&&parseInt(fieldType)==ZFFieldTypeConstants.MATRIX_CHOICE&&parseInt($(parentElem).attr("choiceType"))==MatrixChoicesType.TEXTBOX.CODE&&errArr[i][key].error_message!=undefined){var errorRows=errArr[i][key].error_rows;for(rowIndex=0;rowIndex<errorRows.length;rowIndex++){addMatrixTextBoxErrorJson(errorRows[rowIndex],parentElem)}(errTg=$("#error-"+key)).addClass("rangeError").text(errArr[i][key].error_message),animateErrorMsg(errTg)}else{var errTg;parentElem.addClass("error"),(errTg=$("#error-"+key)).text(errArr[i][key]),animateErrorMsg(errTg)}else ZFLive.showComponentMandatoryError(errArr[i][key],parentElem,key);displayedErr=!0}else hiddenFieldError=!0}if(hiddenFieldError)ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.checkfieldconfiguration):showErrorPopUp(i18n.errorinformsubmission,i18n.contactadmin);else if(!displayedErr){if(409===jqXhr.status)if(typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!=ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS]!=ResponseKey.UNDEFINED)showErrorPopUp(responseJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS],i18n.contactadmin);else showErrorPopUp(i18n.formclosed,i18n.contactadmin);else 400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error!==ResponseKey.UNDEFINED?ZFLive.isFormAdmin?showErrorPopUp(i18n.oopserrmsg,responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error):showErrorPopUp(i18n.oopserrmsg,i18n.contactadmin):400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].INVALID_RCD_PERMA!==ResponseKey.UNDEFINED?ZFLive.isFormAdmin?showErrorPopUp(i18n.oopserrmsg,i18n.erroroccurred):showErrorPopUp(i18n.oopserrmsg,i18n.contactadmin):400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].INVALID_ENC_KEY!==ResponseKey.UNDEFINED?showErrorPopUp(i18n.oopserrmsg,i18n.erroroccurred):400===jqXhr.status&&typeof errArr[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&"FORM_DATA_ENCRYPTION_PROCESSING"===errArr[ZFLiveConstants.RESPONSE.ERROR]?ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.formdataencryptionprocessing):showErrorPopUp(i18n.formdataencryptionprocessing,i18n.contactadmin):showErrorPopUp(i18n.invalidentriesfound,i18n.correctentries)}"none"==$("#settingsErr-div").css("display")&&$(onfocus).focus(),resetCaptcha(),resetReCaptcha()}catch(error){ZFLive.disableSubmitBtn();var msgElm=$("#settingsErr-div");setPopUpElemPosition(msgElm),$(msgElm).css("position","fixed"),$(msgElm).show(),$("#popHeader").text("Error occured while submit the form"),$("#msgBody").text(jqXhr.responseText),showInvalidEntriesMsg(jqXhr.responseText),resetCaptcha(),resetReCaptcha()}},ZFLive.showComponentMandatoryError=function(compErrJson,parentElem,key){var compErrMsg="";for(var compIndex in compErrJson)""==compErrMsg&&(compErrMsg=compErrJson[compIndex]),$(parentElem).find("input[complink="+compIndex+"],select[complink="+compIndex+"]").closest("span").addClass("error1");var errTg=$("#error-"+key);errTg.text(compErrMsg),animateErrorMsg(errTg)},ZFLive.disableSubmitBtn=function(){var submitBtn=$('button[elname="submit"]');$(submitBtn).prop("disabled",!0),$(submitBtn).removeClass("fmSmtButtom"),$(submitBtn).addClass("disabledSubmitButtom")},ZFLive.enableSubmitBtn=function(){var submitBtn=$('button[elname="submit"]');$(submitBtn).prop("disabled",!1),$(submitBtn).removeClass("disabledSubmitButtom"),$(submitBtn).addClass("fmSmtButtom")},ZFLive.disableReviewBtn=function(){var reviewBtn=$('button[elname="review"]');$(reviewBtn).prop("disabled",!0),$(reviewBtn).removeClass("fmSmtButtom"),$(reviewBtn).addClass("disabledSubmitButtom")},ZFLive.enableReviewBtn=function(){var reviewBtn=$('button[elname="review"]');$(reviewBtn).prop("disabled",!1),$(reviewBtn).removeClass("disabledSubmitButtom"),$(reviewBtn).addClass("fmSmtButtom")},ZFLive.enableSaveBtn=function(){var submitBtn=$('button[elname="save"]');$(submitBtn).prop("disabled",!1),$(submitBtn).removeClass("disabledSubmitButtom"),$(submitBtn).addClass("fmSmtButtom")},ZFLive.disableSaveBtn=function(){var submitBtn=$('button[elname="save"]');$(submitBtn).prop("disabled",!0),$(submitBtn).removeClass("fmSmtButtom"),$(submitBtn).addClass("disabledSubmitButtom")},ZFLive.disableUpdateBtn=function(){$("#updateBtn").prop("disabled",!0)},ZFLive.enableUpdateBtn=function(){$("#updateBtn").prop("disabled",!1)},ZFLive.focusNext=function(elem,event){9!=event.keyCode&&16!=event.keyCode&&(event.keyCode>=37&&event.keyCode<=40||("countrycode"==$(elem).attr("elname")?3==$(elem).val().length&&$(elem).parent().parent().find('input[elname="first"]').focus():"first"==$(elem).attr("elname")&&3==$(elem).val().length&&$(elem).parent().parent().find('input[elname="second"]').focus()))},ZFLive.updateData=function(){ZFLive.valueJson={},ZFLive.commentJson={};var formPerma=document.getElementById("formPerma").value,putUri="";putUri=0!==formPerma.length?"/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/publicrecord/"+ZFLive.encodedString:"/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/record/"+ZFLive.encodedString+"/edit",$("#test").find("ul[elname=formBodyULName]").children("li").each(function(index,elem){var id=$(elem).attr("id"),sendFieldValue=!0;if("false"!=$(elem).parent("ul").attr("needpagedata")&&"false"!==$(elem).attr("needdata")||(sendFieldValue=!1),id&&sendFieldValue&&ZFUtil.isFieldVisible(elem)){var elemtype=$(elem).attr("elemtype"),compname=$(elem).attr("compname");"subFormField"===elemtype?(ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonOnUpdate(ZFLive.valueJson,elem)):compname!=SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME&&constructFormFieldDataJsonCommon(ZFLive.valueJson,elem,!1)}}),showSavingElem();var ajaxOpts={URI:putUri,METHOD:"PUT",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(ZFLive.valueJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),$("#disableDiv").hide(),xmlString=jqXhr.responseText,hideSavingElem(),200==jqXhr.status){ZFLive.storedFiles={},ZFLive.submitButtonClicked=!1;var msgElm=$("#updatedMsgDiv");setTimeout(function(){$(msgElm).show(),$(msgElm).delay(500).fadeOut(300),ZFLive.enableUpdateBtn()},500),responseJson=JSON.parse(jqXhr.responseText);var encodedString=responseJson.encoded_string;if(0!==formPerma.length){var editTKurl="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/thankyou/formperma/"+formPerma+"?record_perma="+encodedString+"&edit=true";1==document.getElementById("resizeform").value&&(editTKurl+="&zf_rszfm=1"),window.location.href=editTKurl}else window.location.href="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/thankyou?record_perma="+encodedString+"&edit=true"}else if(500==jqXhr.status)ZFLive.enableUpdateBtn(),showInvalidEntriesMsg(i18n.internalserver);else if(400==jqXhr.status||401==jqXhr.status||403==jqXhr.status||404==jqXhr.status||409==jqXhr.status){ZFLive.resetCurrentDateRef(),ZFLive.enableUpdateBtn(),ZFLive.updateAndRemoveErrorFiles();try{isActionRestricted(jqXhr)?showRestrictionPopup():ZFLive.showRecordUpdateErrorResp(jqXhr)}catch(error){setPopUpElemPosition(msgElm=$("#settingsErr-div")),$(msgElm).css("position","fixed"),$(msgElm).show(),$("#popHeader").text("Error occured while update the form"),$("#msgBody").text(xmlString),showInvalidEntriesMsg(xmlString)}resetCaptcha(),resetReCaptcha(),(isIELessThan10()||isWindowSafari())&&clearFilesOnError()}else showInvalidEntriesMsg(i18n.invalidentriesfound),resetCaptcha(),resetReCaptcha()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.showRecordUpdateErrorResp=function(jqXhr){var onfocus,responseJson=JSON.parse(jqXhr.responseText),errArr=responseJson[ZFLiveConstants.RESPONSE.ERRORS],displayedErr=!1,hiddenFieldError=!1;if($.type(errArr)!==ZFLiveConstants.RESPONSE.UNDEFINED&&errArr.length>0)for(var i=0;i<errArr.length;i++)for(var key in errArr[i])if(key===ZFLiveConstants.VERIFICATIONCODE.KEY){if($("#captcha-popup-div").is(":visible"))if(1==errArr.length){resetCaptchaForPopup();var errElem=$("#pop_captcha_li").find("#error-verificationcode-pop");$(errElem).text(i18n.wrongverificationcode),animateErrorMsg(errElem),onfocus=$("#pop_captcha_li").find(":input[type!=hidden]:first"),bindKeyUpEventForCaptchaPopup()}else closeCaptchaPopUp();else{errElem=$("#verificationcode-li").find("#error-verificationcode");$(errElem).text(i18n.wrongverificationcode),animateErrorMsg(errElem),$("#verificationcode-li").addClass("error"),0===i&&(onfocus=$("#verificationcode-li").find(":input[type!=hidden]:first"))}displayedErr=!0}else if(key===ZFLiveConstants.RECAPTCHA.ERROR_INV)showErrorPopUp(ZFLiveErrorConstants.recaptchaerror,i18n.contactadmin),displayedErr=!0;else if(key===ZFLiveConstants.RECAPTCHA.ERROR_CBOX){if($("#captcha-popup-div").is(":visible"))if(1==errArr.length){var recapCbErrTg=$("#captcha-popup-div").find("#error-recaptchacbox-pop");recapCbErrTg.text(ZFLiveErrorConstants.recaptchaerror),animateErrorMsg(recapCbErrTg),bindKeyUpEventForCaptchaPopup()}else closeCaptchaPopUp();else{var vCodeErrTg=$("#recaptchacbox-li").find("#error-recaptchacbox");$(vCodeErrTg).text(ZFLiveErrorConstants.recaptchaerror),animateErrorMsg(vCodeErrTg)}displayedErr=!0}else if(-1!==key.indexOf("SubForm")){var subFormErrJson=errArr[i][key],entrysInErrorCount=0;for(var entryIndex in subFormErrJson)if("entry_limit"===entryIndex){var parentElem=$("#"+key+"-li");if($(parentElem).find("p#error-"+key).text(subFormErrJson[entryIndex]),animateErrorMsg($(parentElem).find("p#error-"+key)),"true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).parent().attr("page_no");if(0==i)showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length);displayedErr=!0}else hiddenFieldError=!0}else{for(var errorArrayInSubFormRow=subFormErrJson[entryIndex],subFormLi=$("#"+key+"-li"),subFormEntryRowInUI=$(subFormLi).find('ul[elname="subFormFieldsUl"][isvalidentry="true"]')[entryIndex],rowIndex=$(subFormEntryRowInUI).attr("rowId"),sfViewType=$(subFormLi).attr("viewtype"),arrIndex=0;arrIndex<errorArrayInSubFormRow.length;arrIndex++)for(var childElemKey in errorArrayInSubFormRow[arrIndex])if("unique_error"==childElemKey){var sfUniqueErrJson=errorArrayInSubFormRow[arrIndex][childElemKey],uniqueErrorFields=sfUniqueErrJson.fields;for(sfUniqueFldIdx=0;sfUniqueFldIdx<uniqueErrorFields.length;sfUniqueFldIdx++){var childElemKeyInUI=uniqueErrorFields[sfUniqueFldIdx]+"_"+parseInt(rowIndex);if("true"==(parentElem=$("#"+childElemKeyInUI+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){parentElem.addClass("error"),displayedErr=!0;pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");if(0==i&&0==entrysInErrorCount&&0==arrIndex&&0==sfUniqueFldIdx){showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount);var firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=$(firstErrElem),5!==(compType=parseInt(firstErrElem.parent().parent().parent().attr("compType")))&&16!==compType||$("#ui-datepicker-div").hide()}}}if($(subFormEntryRowInUI).find('p[elname="sfEntryError"]').text(sfUniqueErrJson.msg),animateErrorMsg($(subFormEntryRowInUI).find('p[elname="sfEntryError"]')),"2"==sfViewType){var sfCardWithErr=$(subFormLi).find('div[elname="sfcardelem"][cardrowid="'+rowIndex+'"]');if($(sfCardWithErr).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),0==i&&0==entrysInErrorCount&&0==arrIndex){var thisSubFormErrorPos=$(sfCardWithErr).offset().top,posToFix=((viewportBottom=(viewportTop=$(window).scrollTop())+$(window).height())-viewportTop)/3;(thisSubFormErrorPos>viewportBottom||thisSubFormErrorPos<viewportTop)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-posToFix},1e3)}}}else{childElemKeyInUI=childElemKey+"_"+parseInt(rowIndex);if("true"==(parentElem=$("#"+childElemKeyInUI+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var compType;pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");if(0==i&&0==entrysInErrorCount&&0==arrIndex)showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length);if(0==i&&0==entrysInErrorCount&&0==arrIndex)onfocus=firstErrElem=parentElem.find(":input[type!=hidden]:first"),5!==(compType=parseInt(firstErrElem.parent().parent().parent().attr("compType")))&&16!==compType||$("#ui-datepicker-div").hide();if(typeof(fieldType=$(parentElem).attr("comptype"))===ResponseKey.UNDEFINED||parseInt(fieldType)!==ZFFieldTypeConstants.ADDRESS&&parseInt(fieldType)!==ZFFieldTypeConstants.NAME){parentElem.addClass("error");var sfChErrTg=$("#error-"+childElemKeyInUI);sfChErrTg.text(errorArrayInSubFormRow[arrIndex][childElemKey]),animateErrorMsg(sfChErrTg)}else ZFLive.showComponentMandatoryError(errorArrayInSubFormRow[arrIndex][childElemKey],parentElem,childElemKeyInUI);if("2"==sfViewType){sfCardWithErr=$(subFormLi).find('div[elname="sfcardelem"][cardrowid="'+rowIndex+'"]');if($(sfCardWithErr).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),0==i&&0==entrysInErrorCount&&0==arrIndex){var viewportTop,viewportBottom;thisSubFormErrorPos=$(sfCardWithErr).offset().top,posToFix=((viewportBottom=(viewportTop=$(window).scrollTop())+$(window).height())-viewportTop)/3;(thisSubFormErrorPos>viewportBottom||thisSubFormErrorPos<viewportTop)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-posToFix},1e3)}}displayedErr=!0}else hiddenFieldError=!0}"2"==sfViewType&&("true"==subFormLi.attr("needdata")&&ZFUtil.isFieldVisible(subFormLi)?($(subFormLi).find("p#error-"+key).text(i18n.subformcarderrgeneral),animateErrorMsg($(subFormLi).find("p#error-"+key)),displayedErr=!0):hiddenFieldError=!0),entrysInErrorCount++}}else{if("true"==(parentElem=$("#"+key+"-li")).attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageCount,fieldType;pageNum=$(parentElem).parent().attr("page_no");if(0==i)showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length);if(typeof(fieldType=$(parentElem).attr("comptype"))!==ResponseKey.UNDEFINED&&parseInt(fieldType)===ZFFieldTypeConstants.ZOHO_CRM){errElem=$(parentElem).find('p[elname="error"]');$(errElem).text(errArr[i][key]),animateErrorMsg(errElem),parentElem.addClass(" error")}else if(typeof fieldType===ResponseKey.UNDEFINED||parseInt(fieldType)!==ZFFieldTypeConstants.ADDRESS&&parseInt(fieldType)!==ZFFieldTypeConstants.NAME)if(typeof fieldType!==ResponseKey.UNDEFINED&&parseInt(fieldType)==ZFFieldTypeConstants.MATRIX_CHOICE&&parseInt($(parentElem).attr("choiceType"))==MatrixChoicesType.TEXTBOX.CODE&&errArr[i][key].error_message!=undefined){var errorRows=errArr[i][key].error_rows;for(rowIndex=0;rowIndex<errorRows.length;rowIndex++){addMatrixTextBoxErrorJson(errorRows[rowIndex],parentElem)}var matxErrTg=$("#error-"+key);matxErrTg.addClass("rangeError").text(errArr[i][key].error_message),animateErrorMsg(matxErrTg)}else{var errTg=$("#error-"+key);errTg.text(errArr[i][key]),animateErrorMsg(errTg),parentElem.addClass(" error")}else ZFLive.showComponentMandatoryError(errArr[i][key],parentElem,key);displayedErr=!0}else hiddenFieldError=!0}if(hiddenFieldError)ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.checkfieldconfiguration):showErrorPopUp(i18n.errorinformsubmission,i18n.contactadmin);else if(!displayedErr){if(409===jqXhr.status)if(typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!=ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS]!=ResponseKey.UNDEFINED)showErrorPopUp(responseJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS],i18n.contactadmin);else showErrorPopUp(i18n.formclosed,i18n.contactadmin);else 400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error!==ResponseKey.UNDEFINED?ZFLive.isFormAdmin?showErrorPopUp(i18n.oopserrmsg,responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error):showErrorPopUp(i18n.oopserrmsg,i18n.contactadmin):400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].INVALID_ENC_KEY!==ResponseKey.UNDEFINED?showErrorPopUp(i18n.oopserrmsg,i18n.erroroccurred):400===jqXhr.status&&typeof errArr[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&"FORM_DATA_ENCRYPTION_PROCESSING"===errArr[ZFLiveConstants.RESPONSE.ERROR]?ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.formdataencryptionprocessing):showErrorPopUp(i18n.formdataencryptionprocessing,i18n.contactadmin):typeof errArr[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&"ACCESS_DENIED"===errArr[ZFLiveConstants.RESPONSE.ERROR]?window.location.href="/showinfo?key=noaccess":showErrorPopUp(i18n.invalidentriesfound,i18n.correctentries)}"none"==$("#settingsErr-div").css("display")&&$(onfocus).focus()},ZFLive.performRazorPaymentCapture=function(razorPayToken,orderId,razorPaySignature,referenceId,redirectURL,openRedirectURLIn,sameFormUrl,redirType){var razorPayIdJson={razorpaytoken:razorPayToken,razororderid:orderId,razorpaysignature:razorPaySignature,referenceid:referenceId,pmntstatusflag:1};this.performRazorPaymentCaptureRedirection(razorPayIdJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType)},ZFLive.performRazorPaymentFailureRedirection=function(orderId,referenceId,redirectURL,openRedirectURLIn,pmntstatusflag,sameFormUrl,redirType){var razorPayIdJson={razororderid:orderId,referenceid:referenceId,pmntstatusflag:pmntstatusflag};this.performRazorPaymentCaptureRedirection(razorPayIdJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType)},ZFLive.performRazorPaymentCaptureRedirection=function(razorPayIdJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType){var formPerma=document.getElementById("formPerma").value;0===formPerma.length?reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/razorpaymentcapture":reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/razorpaymentcapture";var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(razorPayIdJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){$("#pleaseWait_Div").hide(),$("#paymentRedirectDiv").removeClass("dim-div3"),$("#paymentRedirectDiv").hide();var responseJson=JSON.parse(jqXhr.responseText);if(200==jqXhr.status){if("captured"==responseJson.pmntstatusflag)performDefaultRedirection(redirectURL,openRedirectURLIn,sameFormUrl,ZFormType.FORMS,redirType);else{for(var errMsg="",errArr=responseJson[ZFLiveConstants.RESPONSE.ERROR],i=0;i<errArr.length;i++)for(var key in errArr[i]){var errCode=errArr[i][key];errMsg=i18n.paymentnotprocessed+" "+errCode+" "+i18n.paymentretry}ZFLive.showPaymentFailRecordRetryErr(errMsg)}}else{for(errMsg="",errArr=responseJson[ZFLiveConstants.RESPONSE.ERROR],i=0;i<errArr.length;i++)for(var key in errArr[i]){errCode=errArr[i][key];errMsg=i18n.paymentnotprocessed+" "+errCode+" "+i18n.paymentretry}ZFLive.showPaymentFailRecordRetryErr(errMsg)}}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.showPaymentFailRecordRetryErr=function(errMsg){resetCaptcha(),resetReCaptcha(),cancelSubmitOrUpdateFormAction();var parentElem=$("#PaymentAmount-li");parentElem.addClass("error"),showPaymentErrPopUp(errMsg);var pageNum=$(parentElem).parent().attr("page_no");showAndHidePage(pageNum),triggerFormResize(),setNeedDataForError(pageNum,$("#formBodyDiv").find("ul[elname=formBodyULName]").length)},ZFLive.validateForm=function(addRangeErrClass){if(this.errorArray=new Array,this.errCnt=0,document.activeElement.blur(),typeof ZFLive.lastErrorComp!==ResponseKey.UNDEFINED&&!$("li[elname=livefield-elem][compname="+ZFLive.lastErrorComp+"]").hasClass("error")){var lastErrorIdd=ZFLive.errorId(ZFLive.lastErrorComp);$(lastErrorIdd).removeClass("warningMessage").hide()}return ZFLive.lastErrorComp=undefined,$("#test").find("ul[elname=formBodyULName]").children('[elname="livefield-elem"]').each(function(index,elem){ZFLive.validateField(elem,addRangeErrClass)}),ZFLive.isUploadSaveValidate=!1,this.errorArray},ZFLive.validateField=function(elem,addRangeErrClass){if(ZFUtil.isFieldVisible(elem)){var needdata=$(elem).attr("needdata");if("false"!=$(elem).parent("ul").attr("needpagedata")&&needdata!==BooleanConstants.FALSE){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),ismandatory=BooleanConstants.FALSE;!ZFLive.isSaveReq&&ZFUtil.isFieldVisible(elem)&&(ismandatory=$(elem).attr("mandatory"));var errorIdd=ZFLive.errorId(compname);if(compname&&""!=compname){if(comptype!==ZFFieldTypeConstants.NUMBER&&comptype!==ZFFieldTypeConstants.CURRENCY&&comptype!==ZFFieldTypeConstants.DECIMAL||removeLeadingZeros(elem),comptype===ZFFieldTypeConstants.ZOHO_CRM)ZFLive.mode!=Mode.EDIT&&ismandatory===BooleanConstants.TRUE&&(ZFCrmLive.zfCrmLive.checkMandatoryZohoCrmFld(elem)||($(elem).find('p[elname="error"]').text(ZFLiveErrorConstants.choicemandatoryerror),animateErrorMsg($(elem).find('p[elname="error"]')),$(elem).addClass("error"),this.changeErrArray(compname)));else if(compname==ZFLiveConstants.VERIFICATIONCODE.KEY){if(!checkMandatory(elem,comptype)&&isCaptchaErrorNeeded())$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorcaptcha),animateErrorMsg(errorIdd),$("#"+compname+"-li").addClass("error"),this.changeErrArray(compname)}else if(compname!=SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME||ZFLive.mode==Mode.EDIT||ZFLive.isSaveReq)if(compname!=ZFLiveConstants.RECAPTCHA.CHECKBOX||getMSIEversion()<8){"subFormField"===$(elem).attr("elemtype")?this.validateSubFormField(elem,addRangeErrClass):ZFLive.validateFieldCommon(elem,ismandatory)}else!checkMandatoryReCaptcha()&&isCaptchaErrorNeeded()&&($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorrecaptcha),animateErrorMsg(errorIdd),this.changeErrArray(compname));else{var merchDiv=$("#test").find("div[elname=merchantDiv]"),selectedMerchantType=$(merchDiv).attr("merchantType");if(null!=selectedMerchantType&&""!=selectedMerchantType)if(checkMandatory(elem))if(validatePayment(elem))if(validateDecimalLength(elem,2)){var selecMerchantElem=$(merchDiv).find("a[merchanttype="+selectedMerchantType+"]");if(2==$(merchDiv).attr("paymenttype")){var pymntAmntInp=$(elem).find("input").get(0),paymentAmnt=parseFloat($.trim($(pymntAmntInp).val())),minAmnt=$(selecMerchantElem).attr("minamnt"),maxAmnt=$(selecMerchantElem).attr("maxamnt");if(""!=minAmnt)paymentAmnt<parseFloat(minAmnt)&&($(errorIdd).text(ZFUtil.replaceParams(i18n.pymnterrminamnt,minAmnt)),animateErrorMsg(errorIdd),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname));if(""!=maxAmnt)paymentAmnt>parseFloat(maxAmnt)&&($(errorIdd).text(ZFUtil.replaceParams(i18n.pymnterrmaxamnt,maxAmnt)),animateErrorMsg(errorIdd),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname))}}else $(errorIdd).text(ZFUtil.replaceParams(i18n.paymentdecimallen,2)),animateErrorMsg(errorIdd),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname);else $(errorIdd).text(i18n.entervalidamount),animateErrorMsg(errorIdd),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname);else $(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),animateErrorMsg(errorIdd),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname)}ZFLive.performRangeValidation(elem,addRangeErrClass)}}}},ZFLive.performRangeValidation=function(elem,addRangeErrClass){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),errorIdd=ZFLive.errorId(compname);if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE||comptype===ZFFieldTypeConstants.MATRIX_CHOICE){if(!isIELessThan9()&&typeof ZFLive.constraintJson!==ResponseKey.UNDEFINED&&!ZFLive.isSaveReq&&-1===$.inArray(compname,this.errorArray)){var constrJson=ZFLive.constraintJson;if(inputAddedToField(elem,comptype,!1)){var isValidRange=!0;if(typeof(dataSpecJson=constrJson[linkname=$(elem).attr("linkname")])!==ResponseKey.UNDEFINED)if(comptype==ZFFieldTypeConstants.NUMBER)isValidRange=rangeValidForNumDeciCurrFld(dataSpecJson,inputVal=$.trim($(elem).find("input[type=text]").val()),errorIdd,comptype);else if(comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY){var decimalFormat=$(elem).attr("decimalformat"),inputVal=$.trim($(elem).find("input[type=text]").val());isValidRange=rangeValidForNumDeciCurrFld(dataSpecJson,inputVal=$.trim(ZFUtil.getReformattedDecimal(inputVal,decimalFormat)),errorIdd,comptype)}else comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.MULTI_LINE||comptype==ZFFieldTypeConstants.EMAIL?isValidRange=rangeValidationForTextFields(elem,errorIdd,dataSpecJson,comptype,compname):comptype==ZFFieldTypeConstants.DATE?isValidRange=rangeValidationForDate(elem,dataSpecJson,errorIdd,comptype):comptype==ZFFieldTypeConstants.DATETIME?isValidRange=rangeValidationForDateTime(elem,dataSpecJson,errorIdd,comptype):comptype==ZFFieldTypeConstants.PHONE?isValidRange=phoneLengthCheck(elem,errorIdd,dataSpecJson):comptype==ZFFieldTypeConstants.MATRIX_CHOICE&&(isValidRange=rangeValidationForMatrixChoiceFields(elem,errorIdd,dataSpecJson,undefined,addRangeErrClass));isValidRange?$(errorIdd).removeClass("warningMessage").removeClass("rangeError"):ZFLive.addRangeError(elem,errorIdd,addRangeErrClass,compname,comptype)}}}else if(comptype===ZFFieldTypeConstants.FILE_UPLOAD||comptype===ZFFieldTypeConstants.IMAGE_UPLOAD){constrJson=ZFLive.constraintJson;var linkname=$(elem).attr("linkname");if(typeof constrJson!==ResponseKey.UNDEFINED){var dataSpecJson=constrJson[linkname];if(!ZFLive.isSaveReq&&-1===$.inArray(compname,this.errorArray)&&!isIELessThan10()&&!isWindowSafari()&&typeof dataSpecJson!==ResponseKey.UNDEFINED&&typeof dataSpecJson[DataSpecConst.MIN_UPLOAD_LIMIT]!==ResponseKey.UNDEFINED){var minUploadLimit=dataSpecJson[DataSpecConst.MIN_UPLOAD_LIMIT],totalfiles=$("#"+compname+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length;totalfiles>0&&totalfiles<minUploadLimit?($(errorIdd).text(i18n.filescountminlimiterror.replace("{0}",minUploadLimit)),ZFLive.addRangeError(elem,errorIdd,addRangeErrClass,compname)):$(errorIdd).removeClass("warningMessage").removeClass("rangeError")}}}},ZFLive.validateFieldCommon=function(elem,ismandatory){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),errorIdd=ZFLive.errorId(compname);if(compname&&""!=compname)if(comptype==ZFFieldTypeConstants.SIGNATURE)"true"==ismandatory&&(checkMandatorySignature(elem)||($(errorIdd).text(ZFLiveErrorConstants.signaturemandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD){var uploadLimit=$(elem).attr("uploadlimit"),totalfiles=$("#"+compname+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length;if(isIELessThan10()||isWindowSafari()){var fileElementDiv=$("#test").find("li[compname="+compname+"]").find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++){if(index!=fileElementDiv.length-1)""==(previousfile=(previousfile=$(fileElementDiv[index]).find("div[elname=filePathSpan]").html()).trim?previousfile.trim():previousfile.replace(/^\s+/,""))&&$(fileElementDiv[index]).remove()}var addFUDivnew=$("#test").find("li[compname="+compname+"]").find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]');for(index=0;index<addFUDivnew.length;index++)$(addFUDivnew[index]).attr("elname",compname+"_"+index),$(fileElementDiv[index]).find("input[type=file]").attr("name",compname+"_"+index);if(addFUDivnew.length>uploadLimit)errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadLimit):ZFLiveErrorConstants.fileuploadlimiterror,$(errorIdd).text(errorMsg),animateErrorMsg(errorIdd),this.changeErrArray(compname)}else{var errorMsg;if(totalfiles>uploadLimit)errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadLimit):ZFLiveErrorConstants.fileuploadlimiterror,$(errorIdd).text(errorMsg),animateErrorMsg(errorIdd),this.changeErrArray(compname);else $(elem).find("li.fileUploadError").length>0&&this.changeErrArray(compname)}if("true"==ismandatory)if(isIELessThan10()||isWindowSafari()){var previousfile;previousfile=(previousfile=$(addFUDivnew).find("div[elname=filePathSpan]").html()).trim?previousfile.trim():previousfile.replace(/^\s+/,""),1==addFUDivnew.length&&""==previousfile&&($(errorIdd).text(ZFLiveErrorConstants.fileuploadmandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))}else{var storedfiles=0;ZFLive.storedFiles[compname]!=undefined&&(storedfiles=Object.keys(ZFLive.storedFiles[compname]).length),totalfiles<=0&&storedfiles<=0&&($(errorIdd).text(ZFLiveErrorConstants.fileuploadmandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))}}else if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS||comptype===ZFFieldTypeConstants.GEOLOCATION)"true"==ismandatory&&(checkMandatoryForCompositeElem(elem,comptype,!0)||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),animateErrorMsg(errorIdd),this.changeErrArray(compname)));else if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.SLIDER||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE){if("true"==ismandatory&&(checkMandatory(elem,comptype)||(comptype==ZFFieldTypeConstants.DATE?$(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror):comptype===ZFFieldTypeConstants.DATETIME?$(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror):comptype===ZFFieldTypeConstants.SLIDER?$(errorIdd).text(i18n.chooseval):comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL?$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber):comptype===ZFFieldTypeConstants.PHONE?(hideFieldReConfErr(compname),$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber)):comptype===ZFFieldTypeConstants.EMAIL?(hideFieldReConfErr(compname),$(errorIdd).text(ZFLiveErrorConstants.mandatoryerror)):$(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),comptype==ZFFieldTypeConstants.PHONE)if(validatePhoneField(elem,errorIdd,ismandatory))typeof(needReconf=$(elem).attr("need_reconf"))!=ResponseKey.UNDEFINED&&"true"==needReconf&&(ZFLive.checkPhFldIdentical(elem,compname,!0,!1)||(ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else animateErrorMsg(errorIdd),hideFieldReConfErr(compname),ZFLive.addMandatoryError(elem),this.changeErrArray(compname);else if(comptype==ZFFieldTypeConstants.EMAIL){var emailErrArray=new Array;if(validateEmail(elem,compname,emailErrArray)){var needReconf;typeof(needReconf=$(elem).attr("need_reconf"))!=ResponseKey.UNDEFINED&&"true"==needReconf&&(ZFLive.checkIfIdentical(elem,compname,!0)||(ZFLive.addMandatoryError(elem),this.changeErrArray(compname)))}else{var reconfCompname=compname+"-reconf",reconfErrorId=ZFLive.errorId(reconfCompname);"none"!=$(reconfErrorId).css("display")&&$(reconfErrorId).hide(),$($(errorIdd).text(emailErrArray[0])),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)}}else comptype==ZFFieldTypeConstants.WEBSITE?ZFUtil.validateLiveUrl($(elem).find("input").val())||($(errorIdd).text(ZFLiveErrorConstants.urlerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)):comptype==ZFFieldTypeConstants.NUMBER&&(validateNumber(elem)||($(errorIdd).text(ZFLiveErrorConstants.numbererror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));comptype!=ZFFieldTypeConstants.CURRENCY&&comptype!=ZFFieldTypeConstants.DECIMAL||decimLenFormValidation(elem,errorIdd,comptype)||(animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))}else if(comptype==ZFFieldTypeConstants.TIME)"true"==ismandatory?checkMandatoryTime(elem)||($(errorIdd).text(ZFLiveErrorConstants.timemandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)):validateTime(elem)||("1"==$(elem).attr("timeformat")?$(errorIdd).text(ZFLiveErrorConstants.incompletetimeerror):$(errorIdd).text(ZFLiveErrorConstants.incompleteinputtimetwentyfour),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname));else if(comptype==ZFFieldTypeConstants.MULTI_LINE)"true"==ismandatory&&(checkMandatoryTextArea(elem)||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.DROPDOWN)"true"==ismandatory&&(checkMandatoryDropDown(elem,compname)||($(errorIdd).text(ZFLiveErrorConstants.choicemandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.RATING)"true"==ismandatory&&(checkMandatoryRating(elem)||($(errorIdd).text(ZFLiveErrorConstants.ratingmandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.RADIO)"true"==ismandatory&&(checkMandatoryRadio(elem)||($(errorIdd).text(ZFLiveErrorConstants.choicemandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.MATRIX_CHOICE)"true"==ismandatory&&(checkMandatoryMatrixChoice(elem)||($(elem).attr("choiceType")==MatrixChoicesType.TEXTBOX.CODE?($(elem).attr("isErrorOnSubmission",!0),$(elem).find("p[elname=error]").addClass("rangeError"),$(errorIdd).text(ZFLiveErrorConstants.matrixchoicetextboxmandatory)):$(errorIdd).text(ZFLiveErrorConstants.matrixchoicemandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.CHECKBOX||comptype==ZFFieldTypeConstants.DECISION_BOX)"true"==ismandatory&&(checkMandatoryCheckBox(elem)||(comptype==ZFFieldTypeConstants.CHECKBOX?$(errorIdd).text(ZFLiveErrorConstants.optionmandatoryerror):$(errorIdd).text(ZFLiveErrorConstants.decisionmandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),comptype!=ZFFieldTypeConstants.CHECKBOX||ZFLive.isSaveReq||ZFLive.validateChoiceLimit(elem);else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE)"true"==ismandatory&&(checkMandatoryMultiSelect(elem)||($(errorIdd).text(ZFLiveErrorConstants.optionmandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),ZFLive.isSaveReq||ZFLive.validateChoiceLimit(elem);else if(comptype==ZFFieldTypeConstants.IMAGE_CHOICE)"true"==ismandatory&&(checkMandatoryImageChoice(elem)||($(errorIdd).text(ZFLiveErrorConstants.optionmandatoryerror),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),ZFLive.isSaveReq||ZFLive.validateChoiceLimit(elem);else if(compname==ZFLiveConstants.VERIFICATIONCODE.KEY){if(!checkMandatory(elem,comptype))$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorcaptcha),animateErrorMsg(errorIdd),$("#"+compname+"-li").addClass("error"),this.changeErrArray(compname)}else comptype==ZFFieldTypeConstants.TERMS_CONDITIONS?"true"==ismandatory&&(checkMandatoryCheckBox(elem)||($(errorIdd).text(ZFLiveErrorConstants.checktcfield),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))):compname!=ZFLiveConstants.RECAPTCHA.CHECKBOX||getMSIEversion()<8||checkMandatoryReCaptcha()||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorrecaptcha),animateErrorMsg(errorIdd),this.changeErrArray(compname))},ZFLive.addMandatoryError=function(elem){"recordowner"==$(elem).attr("compname")||ZFUtil.isFieldVisible(elem)||(ZFLive.isFormAdmin?showErrorPopUp(i18n.invalidentriesfound,i18n.checkfieldconfiguration):showErrorPopUp(i18n.invalidentriesfound,i18n.contactadmin)),$(elem).addClass("error")},ZFLive.errorId=function(compname){return"#error-"+compname},ZFLive.changeErrArray=function(compname){this.errorArray[this.errCnt]=compname,this.errCnt++},ZFLive.getFileName=function(fileName){return fileName.replace(/^.*[\\\/]/,"")},ZFLive.convertBytes=function(bytes){if(0!=bytes){var kb=Math.round(bytes/1024);return kb>1024?(kb/1024).toFixed(2)+"MB":kb+"KB"}},ZFLive.addFileUploadFields=function(linkName,element){var elname=$(element).closest("div[name=fileElementDiv]").attr("elname"),addFileUploadDiv=$(element).closest("div[elname="+elname+"]"),fileDiv=addFileUploadDiv.find("div[name=filePreviewDiv]"),singleFileDiv=addFileUploadDiv.find("div[elname=fileInputDiv]"),filePathSpan=addFileUploadDiv.find("div[elname=filePathSpan]"),path=$(element).val();fileName=ZFLive.getFileName(path),$("#test").find("#error-"+linkName).hide(),filePathSpan.text(trimFileName(fileName)),singleFileDiv.hide(),fileDiv.show(),addFileUploadDiv.addClass("uploadList_IE")},ZFLive.submitFormDataForLive=function(formPermaUrl){var action,isFileExist=!1,data=new FormData;if(data.append("mode","live"),""!=formPermaUrl)action="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPermaUrl+"/uploadFile";else{action="/"+this.portalName+"/form/"+this.formLinkName+"/uploadFile";var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&data.append("zfcpn",csrf)}for(var key in ZFLive.storedFiles){$("#"+key+"-id").attr("value",""),$("#test").find("#error-"+key).val("");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFileLinkName in fileUploadJSON)fileUploadJSON.hasOwnProperty(uniqueFileLinkName)&&(isFileExist=!0,data.append(uniqueFileLinkName,fileUploadJSON[uniqueFileLinkName]))}if(isFileExist){var xhr=new XMLHttpRequest;xhr.open("POST",action,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onload=function(e){var xmlString=xhr.responseText,respJson=JSON.parse(xmlString);if(200==this.status){for(var key in respJson){var val=respJson[key];ZFLive.setFieldValue(key,val)}ZFLive.SubmitData()}else{if(resetCaptcha(),resetReCaptcha(),typeof respJson[ZFLiveConstants.RESPONSE.ERROR]!=ResponseKey.UNDEFINED&&typeof respJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS]!=ResponseKey.UNDEFINED){var formStatusErr=respJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS];$("#pleaseWait_Div").hide(),showErrorPopUp(formStatusErr,i18n.contactadmin)}else for(var key in respJson){val=respJson[key];ZFLive.setErrorMsg(key,val)}ZFLive.enableSubmitBtn()}},xhr.send(data)}else ZFLive.SubmitData()},ZFLive.submitFormDataForSave=function(formPermaUrl){var action,isFileExist=!1,data=new FormData;if(data.append("mode","live"),""!=formPermaUrl)action="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPermaUrl+"/uploadFile";else{action="/"+this.portalName+"/form/"+this.formLinkName+"/uploadFile";var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&data.append("zfcpn",csrf)}for(var key in ZFLive.storedFiles){$("#"+key+"-id").attr("value",""),$("#test").find("#error-"+key).val("");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFileLinkName in fileUploadJSON)fileUploadJSON.hasOwnProperty(uniqueFileLinkName)&&(isFileExist=!0,data.append(uniqueFileLinkName,fileUploadJSON[uniqueFileLinkName]))}if(isFileExist){var xhr=new XMLHttpRequest;xhr.open("POST",action,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onload=function(e){var xmlString=xhr.responseText,respJson=JSON.parse(xmlString);if(200==this.status){for(var key in respJson){var val=respJson[key];ZFLive.setFieldValue(key,val)}ZFLive.SaveData()}else{if(resetCaptcha(),resetReCaptcha(),closeCaptchaPopUp(),typeof respJson[ZFLiveConstants.RESPONSE.ERROR]!=ResponseKey.UNDEFINED&&typeof respJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS]!=ResponseKey.UNDEFINED){var formStatusErr=respJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS];$("#savingDiv").hide(),showErrorPopUp(formStatusErr,i18n.contactadmin)}else for(var key in respJson){val=respJson[key];ZFLive.setErrorMsg(key,val)}ZFLive.enableSaveBtn()}},xhr.send(data)}else ZFLive.SaveData()},ZFLive.submitFormDataForEdit=function(formPermaUrl,recordLinkId){var action,isFileExist=!1,data=new FormData;if(data.append("mode","edit"),""!=recordLinkId)if(""!=formPermaUrl)action="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPermaUrl+"/uploadFile";else{action="/"+this.portalName+"/form/"+this.formLinkName+"/record/"+recordLinkId+"/uploadFile";var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&data.append("zfcpn",csrf)}for(var key in ZFLive.storedFiles){$("#"+key+"-id").attr("value",""),$("#test").find("#error-"+key).val("");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFileLinkName in fileUploadJSON)fileUploadJSON.hasOwnProperty(uniqueFileLinkName)&&(isFileExist=!0,data.append(uniqueFileLinkName,fileUploadJSON[uniqueFileLinkName]))}if(isFileExist){var xhr=new XMLHttpRequest;xhr.open("POST",action,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onload=function(e){var xmlString=xhr.responseText,respJson=JSON.parse(xmlString);if(200==this.status){for(var key in respJson){var val=respJson[key];ZFLive.setFieldValue(key,val)}ZFLive.updateData()}else{if(resetCaptcha(),resetReCaptcha(),typeof respJson[ZFLiveConstants.RESPONSE.ERROR]!=ResponseKey.UNDEFINED&&typeof respJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS]!=ResponseKey.UNDEFINED)showErrorPopUp(respJson[ZFLiveConstants.RESPONSE.ERROR][ZFLiveConstants.RESPONSE.FORM_STATUS],i18n.contactadmin);else for(var key in respJson){val=respJson[key];ZFLive.setErrorMsg(key,val)}ZFLive.enableUpdateBtn()}},xhr.send(data)}else ZFLive.updateData()},ZFLive.addMultipleFileUploadFields=function(files,linkName,uploadlimit){ZFLive.isOldUploadType?ZFLive.addMultipleFileUploadFields_Old(files,linkName,uploadlimit):ZFLive.addMultipleFileUploadFields_New(files,linkName,uploadlimit)},ZFLive.addMultipleFileUploadFields_Old=function(files,linkName,uploadlimit){$("#error-"+linkName).hide(),$("#error-"+linkName).text("");var inputFileElem=$("#"+linkName+"-id")[0].files;$("li[compname="+linkName+"]").attr("allowedType").split(",");if(inputFileElem){var totalfiles=0,fileDiv=$("#"+linkName+"-div-files"),inputFileElemLen=inputFileElem.length,selectedFileCount=$(fileDiv).find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length;if(selectedFileCount>=0&&(totalfiles=inputFileElemLen+selectedFileCount),totalfiles<=uploadlimit){var count=0,selectedfiles=$(fileDiv).find("ul[elname=fileElementUL]").find("li[elname=newlyAddedFUElement]");selectedfiles.length>0&&(count=selectedfiles.length);var reader=new FileReader;!function readFile(index){if(index>=files.length)triggerFormResize();else{var fileUploadLi=fileDiv.find("ul[elname=fileElementUL]").find("li[elname=templateFileElement]").first().clone(),fileObj=files[index],fileName=fileObj.name,fileExtension=fileName.substr(fileName.lastIndexOf(".")+1),fileNamewithoutExt=fileName.slice(0,-fileExtension.length),fileType=fileObj.type;if(fileObj.size>2e7){var errorMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.uploadsize,20),fuErrTg=$("#test").find("#error-"+linkName);return fuErrTg.text(errorMsg),animateErrorMsg(fuErrTg),!1}var fileUploadUniqueName=linkName+"_fu"+ ++count;if(ZFLive.storedFiles.hasOwnProperty(linkName))ZFLive.storedFiles[linkName][fileUploadUniqueName]=fileObj;else{var fileUploadJSON=[];fileUploadJSON[fileUploadUniqueName]=fileObj,ZFLive.storedFiles[linkName]=fileUploadJSON}reader.onload=function(e){fileUploadLi.find("img[elname=fileImage]").attr("src",e.target.result),fileUploadLi.attr("elname","newlyAddedFUElement"),fileUploadLi.attr("name","singleFileElement"),fileUploadLi.attr("Linkname",fileUploadUniqueName),fileUploadLi.find("em[elname=fileName]").text(fileNamewithoutExt),fileUploadLi.find("b[elname=fileExtension]").text(fileExtension),fileUploadLi.find("p[elname=fileSize]").text(ZFLive.convertBytes(fileObj.size)),fileUploadLi.find("a[name=removeFileElement]").attr("elname",fileUploadUniqueName),fileType.match("image.*")?fileUploadLi.find("div[elname=fileNonImage]").hide():(fileUploadLi.find("a[elname=zoomIcon]").hide(),fileUploadLi.find("img[elname=fileImage]").hide()),ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit&&fileUploadLi.attr("isNewlyAdded",!0),fileUploadLi.show(),fileDiv.find("ul[elname=fileElementUL]").append(fileUploadLi),readFile(index+1)},reader.readAsDataURL(fileObj),fileDiv.show()}}(0)}else{var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadlimit):ZFLiveErrorConstants.fileuploadlimiterror;var fuErrTg=$("#error-"+linkName);fuErrTg.text(errorMsg),animateErrorMsg(fuErrTg)}}},ZFLive.addMultipleFileUploadFields_New=function(files,linkName,uploadlimit){var elemLi=$("#"+linkName+"-li"),fieldType=$(elemLi).attr("comptype");$("#error-"+linkName).hide(),$("#error-"+linkName).text("");var inputFileElem=$("#"+linkName+"-id")[0].files;if(inputFileElem){var totalfiles=0,fileDiv=$("#"+linkName+"-div-files"),inputFileElemLen=inputFileElem.length,selectedFileCount=$(fileDiv).find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length;if(selectedFileCount>=0&&(totalfiles=inputFileElemLen+selectedFileCount),totalfiles<=uploadlimit){var i,count=0,selectedfiles=$(fileDiv).find("ul[elname=fileElementUL]").find("li[elname=newlyAddedFUElement]");for(selectedfiles.length>0&&(count=selectedfiles.length),i=0;i<files.length;i++){var newFileUploadLi=fileDiv.find("ul[elname=fileElementUL]").find("li[elname=templateFileElement]").first().clone();if(readFile_New(i,newFileUploadLi,files,linkName,fieldType,++count)){var fileObj=files[i];ZFLive.uploadFile(linkName,fileObj,newFileUploadLi)}ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit&&newFileUploadLi.attr("isNewlyAdded",!0),fileDiv.find("ul[elname=fileElementUL]").append(newFileUploadLi)}i>0&&(fileDiv.show(),triggerFormResize())}else{var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadlimit):ZFLiveErrorConstants.fileuploadlimiterror;var fuErrTg=$("#error-"+linkName);fuErrTg.text(errorMsg),animateErrorMsg(fuErrTg)}}},ZFLive.submitFiles=function(fromPage){var formPerma=document.getElementById("formPerma").value,fileElem=$("#ZF-UploadFileForm"),fileElArr=$("#test").find(":input[type=file]");if($.each(fileElArr,function(index,el){$(el).after($(el).clone()[0]),$(fileElem).append(el)}),0!==formPerma.length)fileElem.find(":input[name=zfcpn]").remove();else{var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0?fileElem.find(":input[name=zfcpn]").val(csrf):fileElem.find(":input[name=zfcpn]").remove()}return $(fileElem).submit(),!0},ZFLive.ValidateAndUpdateDataForLiveEdit=function(){$("#disableDiv").show(),removeErrorClass();var errorObj=ZFLive.validateForm(!0);0==errorObj.length?(ZFLive.disableUpdateBtn(),!document.getElementById("recaptcha_invisible")||getMSIEversion()<8?ZFLive.ProceedToUpdate():grecaptcha.execute()):(cancelSubmitOrUpdateFormAction(),showError(errorObj),resetCaptcha())},ZFLive.ProceedToUpdate=function(){var recordLinkId=$("form[name=test]").find("button[id=updateBtn]").attr("recordLinkID");if($("#test").find("input:file").length>0)if(isIELessThan10()||isWindowSafari())ZFLive.submitFiles();else if(ZFLive.isOldUploadType){var formPerma=document.getElementById("formPerma").value;ZFLive.submitFormDataForEdit(formPerma,recordLinkId)}else this.updateData();else this.updateData()},ZFLive.closePopUp=function(elname){$("body").removeClass("hideWindowScroll"),$("#"+elname).hide()},ZFLive.closeReviewPopUp=function(closeDivId){$("body").removeClass("hideWindowScroll"),$("#"+closeDivId).fadeOut(500,function(){triggerFormResize()}),ZFLive.enableReviewBtn()},ZFLive.ValidateAndSaveData=function(){ZFLive.isSaveReq=!0,removeErrorClass(),$("#plainLoading").hide();var errorObj=ZFLive.validateForm(!1);0==errorObj.length?(ZFLive.disableSaveBtn(),!document.getElementById("recaptcha_invisible")||getMSIEversion()<8?ZFLive.ProceedToSave(!1):grecaptcha.execute()):isPopupCaptchaNeeded(errorObj)?(ZFLive.submitButtonClicked=!1,showPopupCaptcha()):(cancelSubmitOrUpdateFormAction(),showError(errorObj),resetCaptcha())},ZFLive.ProceedToSave=function(isFromPopup){isFromPopup||$("#savingDiv").show(),setPopUpElemPosition($("#savingDivCont"));$("form[name=test]").find("button[elname=save]").attr("recordLinkID");if($("#test").find("ul[elname=formBodyULName]").find("input:file").length>0){var formPerma=document.getElementById("formPerma").value;isIELessThan10()||isWindowSafari()?ZFLive.submitFiles():ZFLive.isOldUploadType?ZFLive.submitFormDataForSave(formPerma):this.SaveData()}else this.SaveData()},ZFLive.SaveData=function(){var formPerma=document.getElementById("formPerma").value,testForm=$("#test");ZFLive.valueJson={},testForm.find("ul[elname=formBodyULName]").children("li").each(function(index,elem){var id=$(elem).attr("id"),needdata=$(elem).attr("needdata"),needPageData=$(elem).parent("ul").attr("needpagedata");id&&"true"==needdata&&"true"==needPageData&&constructFormFieldDataJsonForSave(ZFLive.valueJson,elem)}),ZFLive.valueJson.RECORD_STATUS=ZFConstants.SAVE_RECORD_STATUS;var antiSpamCheckUrl=$("#antispam-url-id").val(),reqUri="",saveUrl="",method="POST";if(parseInt($("#formType").val())===ZFormType.FORMS){if(""==ZFLive.encodedString){var referrerName=$.trim($("#referrerName").val());""!=referrerName&&"null"!=referrerName&&null!=referrerName||(referrerName=document.referrer),referrerName.indexOf(antiSpamCheckUrl)>-1&&(referrerName=""),ZFLive.valueJson.REFERRER_NAME=referrerName;var zc_gad=$.trim($("#zc_gad").val());""!=zc_gad&&zc_gad!=undefined&&(ZFLive.valueJson.GOOGLE_CLICK_ID=zc_gad);var utmParamInpElems=$("#zf_utmTrack").find("input[elname=utmParamInp]");if(utmParamInpElems.length>0){var utmParamValJson={};$(utmParamInpElems).each(function(idx,inpElem){var utmVal=$(inpElem).val();if(typeof utmVal!==ResponseKey.UNDEFINED&&""!=utmVal){var utmPLinkName=$(inpElem).attr("name");utmParamValJson[utmPLinkName]=utmVal}}),ZFLive.valueJson.UTM_PARAM=utmParamValJson}var langCode=$.trim($("#langcode").val());""!=langCode&&langCode!=undefined&&(ZFLive.valueJson[SystemGeneratedField.ADDED_LANGUAGE.LINK_NAME]=langCode)}0===formPerma.length?(ZFLive.mode==Mode.LIVE?reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/records":(reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/record/"+ZFLive.encodedString+"/save",method="PUT"),saveUrl=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/"+this.portalName+"/form/"+this.formLinkName+"/record/"):(ZFLive.mode==Mode.LIVE?reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/records":(reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/publicrecord/"+ZFLive.encodedString+"/save",method="PUT"),saveUrl=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/"+this.portalName+"/form/"+this.formLinkName+"/publicrecord/")}var ajaxOpts={URI:reqUri,METHOD:method,DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/zoho.forms-v1+json",DATA:JSON.stringify(ZFLive.valueJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),xmlString=jqXhr.responseText,ZFLive.submitButtonClicked=!1,200==jqXhr.status){closeCaptchaPopUp(),ZFLive.storedFiles={};var respJson=JSON.parse(xmlString),encryptedText=respJson.encoded_string;ZFLive.mode!=Mode.SAVED_RECORD&&(ZFLive.mode=Mode.SAVED_RECORD,ZFLive.encodedString=encryptedText),showSavePopUp(saveUrl=saveUrl+encryptedText+"/save",respJson),$(document).on("keyup",function(event){27===event.keyCode&&ZFLive.closePopUp("savePopUpDiv")}),setFileClear(),resetCaptcha(),resetReCaptcha()}else{if(ZFLive.mode==Mode.LIVE)for(var key in ZFLive.storedFiles){$("#test").find("input[elname="+key+"]").attr("filepath","");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFilePath in fileUploadJSON)$("#test").find("a[elname="+uniqueFilePath+"]").attr("filepath","")}else ZFLive.updateAndRemoveErrorFiles();if(400==jqXhr.status||401==jqXhr.status||403==jqXhr.status||404==jqXhr.status||409==jqXhr.status)try{$("#popupCaptchaSave").find("em[elem=loadingImgElem]").hide(),$("#screenFreezeDiv").hide(),ZFLive.showRecordUpdateErrorResp(jqXhr),triggerFormResizeOnTimeOut(),resetCaptcha(),resetReCaptcha(),ZFLive.resetCurrentDateRef()}catch(error){var msgElm=$("#settingsErr-div");setPopUpElemPosition(msgElm),$(msgElm).css("position","fixed"),$(msgElm).show(),$("#popHeader").text(i18n.saveerror),$("#msgBody").text(xmlString),showInvalidEntriesMsg(xmlString),closeCaptchaPopUp(),resetCaptcha(),resetReCaptcha()}else 500==jqXhr.status||503==jqXhr.status?(closeCaptchaPopUp(),1==$("#formType").val()&&503==jqXhr.status?showInvalidEntriesMsg(i18n.unabletoconnecttosheetserver):500===jqXhr.status&&"Email not confirmed"===jqXhr.responseText?animateErrorMsg($("#errorDiv")):showInvalidEntriesMsg(i18n.internalserver)):(closeCaptchaPopUp(),showInvalidEntriesMsg(i18n.invalidentriesfound));(isIELessThan10()||isWindowSafari())&&clearFilesOnError()}$("#savingDiv").hide(),ZFLive.enableSaveBtn()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.ValidateAndSubmitData=function(){removeErrorClass(),ZFLive.isSaveReq=!1;var errorObj=ZFLive.validateForm(!0);0==errorObj.length?(ZFLive.disableSubmitBtn(),!document.getElementById("recaptcha_invisible")||getMSIEversion()<8?ZFLive.ProceedToSubmit():grecaptcha.execute()):(cancelSubmitOrUpdateFormAction(),showError(errorObj),resetCaptcha())},ZFLive.ProceedToSubmit=function(){if($("#pleaseWait_Div").show(),setPopUpElemPosition($("#pleaseWait_DivCont")),$("#test").find("ul[elname=formBodyULName]").find("input:file").length>0){var formPerma=document.getElementById("formPerma").value;isIELessThan10()||isWindowSafari()?ZFLive.submitFiles():ZFLive.isOldUploadType?ZFLive.submitFormDataForLive(formPerma):this.SubmitData()}else this.SubmitData()},Array.isArrayCheck=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},ZFLive.setErrorMsg=function(linkName,value){var liElem=$("#"+linkName+"-li");if(linkName==ZFLiveConstants.RESPONSE.ERRORS){for(var errMsg=i18n.contactadmin,i=0;i<value.length;i++)for(var key in value[i])errMsg=value[i][key];showErrorPopUp(i18n.errorinformsubmission,errMsg)}else if("true"==liElem.attr("needdata")&&ZFUtil.isFieldVisible(liElem)){liElem.addClass("error"),showAndHidePage(liElem.closest('ul[elname="formBodyULName"]').attr("page_no")),focusFirstErrorElem(liElem);var errorId=$("#error-"+linkName);if($(errorId).text(""),Array.isArrayCheck(value)&&value.length>1){var ul=document.createElement("ol");ul.className="uploadFieldError";for(var index=0;index<value.length;index++){var li=document.createElement("li");li.innerHTML=value[index],ul.appendChild(li)}$(errorId).append(ul)}else $(errorId).text(value);animateErrorMsg(errorId),triggerFormResizeOnTimeOut()}$("#pleaseWait_Div").hide(),$("#savingDiv").hide()},ZFLive.deleteMultiplyAddedFiles=function(linkName,element,filepathtobedeleted){$("#error-"+linkName).hide();var elname=$(element).closest("div[name=fileElementDiv]").attr("elname"),addFileUploadDiv=$(element).closest("div[elname="+elname+"]"),fileDiv=addFileUploadDiv.find("div[name=filePreviewDiv]"),singleFileDiv=addFileUploadDiv.find("div[elname=fileInputDiv]"),inputFileElem=addFileUploadDiv.find("input[name="+elname+"]");addFileUploadDiv.find("div[elname=filePathSpan]").text(""),$(element).closest("div[name=fileElementDiv]").attr("filepath","");var fileElementDiv=$("#test").find("li[compname="+linkName+"]").find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)$(fileElementDiv[index]).attr("elname",linkName+"_"+index),$(fileElementDiv[index]).find("input[type=file]").attr("name",linkName+"_"+index);$(singleFileDiv).attr("clearfile","true"),$(singleFileDiv).show(),$(fileDiv).hide(),addFileUploadDiv.removeClass("uploadList_IE"),(isIELessThan10()||isWindowSafari())&&inputFileElem.replaceWith(inputFileElem.clone())},ZFLive.addFUElementIE=function(prevEle,linkName,uploadlimit){var addFUDivbefore=$("#test").find("li[compname="+linkName+"]").find("div[name=fileElementDiv]"),inputFileElemLen=$(addFUDivbefore).length;if(Number(inputFileElemLen)+1<=Number(uploadlimit)){var emptyFU_field=!1;for(index=0;index<addFUDivbefore.length;index++){var previousfile=$(addFUDivbefore[index]).find("div[elname=filePathSpan]").html();if(""==(previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""))){emptyFU_field=!0;break}}if(emptyFU_field){var fuEmptyErrTg=$("#test").find("#error-"+linkName);fuEmptyErrTg.text(ZFLiveErrorConstants.fileuploadmandatoryerror),animateErrorMsg(fuEmptyErrTg)}else{var fileElementDiv=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]'),newFUElement=$(fileElementDiv).first().clone();$(newFUElement).find("div[elname=fileInputDiv]").show(),$(newFUElement).find("div[name=filePreviewDiv]").hide(),$(newFUElement).find("div[elname=filePathSpan]").text(""),$(newFUElement).removeClass("uploadList_IE"),$(newFUElement).find("div[elname=fileInputDiv]").attr("clearfile",!0),$(newFUElement).attr("filepath",""),$(prevEle).closest('div[name="fileElementDiv"]').after(newFUElement);var fileElementDivAfter=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDivAfter.length;index++)$(fileElementDivAfter[index]).attr("elname",linkName+"_"+index),$(fileElementDivAfter[index]).find("input[type=file]").attr("name",linkName+"_"+index);triggerFormResize()}}else{var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadlimit):ZFLiveErrorConstants.fileuploadlimiterror;var errTg=$("#test").find("#error-"+linkName);errTg.text(errorMsg),animateErrorMsg(errTg)}},ZFLive.deleteFilesNewlyAdded=function(linkName){$("#error-"+linkName).hide();var singleFileDiv=$("#"+linkName+"-singlediv");singleFileDiv.attr("clearfile","true"),singleFileDiv.show();var inputFileEle=$("#"+linkName+"-id");$("#"+linkName+"-div-files").hide(),$("#"+linkName+"-div-files-ie").hide(),inputFileEle.attr("value","");var hiddenInputElem=singleFileDiv.find("input[elname="+linkName+"]");if(hiddenInputElem.attr("value",""),hiddenInputElem.attr("filepath",""),ZFLive.storedFiles.hasOwnProperty(linkName)){var fileUploadJSON=ZFLive.storedFiles[linkName];fileUploadJSON.hasOwnProperty(linkName)&&delete fileUploadJSON[linkName]}(isIELessThan10()||isWindowSafari())&&inputFileEle.replaceWith(inputFileEle.clone())},ZFLive.removeFUElementIE=function(removeEle,linkName,filepathtobedeleted){$("#test").find("#error-"+linkName).hide(),$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]').length>1?($(removeEle).closest('div[name="fileElementDiv"]').remove(),triggerFormResize()):ZFLive.deleteMultiplyAddedFiles(linkName,removeEle,filepathtobedeleted);var fileElementDiv=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)$(fileElementDiv[index]).attr("elname",linkName+"_"+index),$(fileElementDiv[index]).find("input[type=file]").attr("name",linkName+"_"+index)},ZFLive.RemoveFileEdit=function(element,linkName){ZFLive.isOldUploadType?ZFLive.RemoveFileEdit_Old(element,linkName):ZFLive.RemoveFileEdit_New(element,linkName)},ZFLive.RemoveFileEdit_New=function(element,linkName){var errorIdd=ZFLive.errorId(linkName);$(errorIdd).hide(),$(element).parent().attr("isnewlyadded")==undefined&&ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit?$(element).parent().attr("isdelsfpopup","true").hide():$(element).parent().remove(),$("#"+linkName+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length<=0&&$("#"+linkName+"-div-files").hide(),triggerFormResize()},ZFLive.RemoveFileEdit_Old=function(element,linkName){var errorIdd=ZFLive.errorId(linkName);if($(errorIdd).hide(),$(element).parent().attr("isnewlyadded")==undefined&&ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit)$(element).parent().attr("isdelsfpopup","true").hide();else{var filepaths=$("input[elname="+linkName+"]").attr("filepath"),filepathtobedeleted=$(element).attr("filePath");if(""!=filepaths){var filepathsarray=filepaths.split(","),index=filepathsarray.indexOf(filepathtobedeleted);-1!=index&&filepathsarray.splice(index,1),$("input[elname="+linkName+"]").attr("filepath",filepathsarray)}$(element).parent().remove()}$("#"+linkName+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length<=0&&$("#"+linkName+"-div-files").hide(),triggerFormResize()},ZFLive.removeStoredFile=function(fieldName,ele){if(ZFLive.storedFiles.hasOwnProperty(fieldName)){var fileUploadJSON=ZFLive.storedFiles[fieldName],uniqueFldLinkName=$(ele).attr("elname");typeof uniqueFldLinkName!=ResponseKey.UNDEFINED&&fileUploadJSON.hasOwnProperty(uniqueFldLinkName)&&delete fileUploadJSON[uniqueFldLinkName];var index=0;for(var key in ZFLive.storedFiles[fieldName]){index++;var fileindex=key.split("_fu")[1];if(index!=fileindex){var temp=ZFLive.storedFiles[fieldName][key],fieldNameNew=fieldName+"_fu"+(Number(fileindex)-Number(1));ZFLive.storedFiles[fieldName][fieldNameNew]=temp,delete ZFLive.storedFiles[fieldName][key]}}}var selectedfiles=$("#"+fieldName+"-div-files").find("li[elname=newlyAddedFUElement]");for(index=0;index<selectedfiles.length;index++)$(selectedfiles[index]).attr("linkname",fieldName+"_fu"+(index+1)),$(selectedfiles[index]).find("a[name=removeFileElement]").attr("elname",fieldName+"_fu"+(index+1))},ZFLive.removeAndDeleteFile=function(fieldName,ele){this.removeFile(fieldName,ele),this.deleteFile(fieldName,ele)},ZFLive.removeFile=function(fieldName,ele){ZFLive.isOldUploadType?ZFLive.removeFile_Old(fieldName,ele):ZFLive.removeFile_New(fieldName,ele)},ZFLive.removeFile_Old=function(fieldName,ele){var errorIdd=ZFLive.errorId(fieldName);if($(errorIdd).hide(),$(errorIdd).text(""),$(ele).parent().attr("isnewlyadded")==undefined&&ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit)$(ele).parent().attr("isdelsfpopup","true").hide();else{var inputFileElem=$("#"+fieldName+"-id");$(inputFileElem).attr("value",""),ZFLive.RemoveFileEdit(ele,fieldName),ZFLive.removeStoredFile(fieldName,ele)}var parentDiv=$("#"+fieldName+"-div-files");$(parentDiv).find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length<=0&&$("#"+fieldName+"-div-files").hide(),this.validateUploadMinLimitConst(parentDiv)},ZFLive.removeFile_New=function(fieldName,ele){if($(ele).parent().attr("isnewlyadded")==undefined&&ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit)$(ele).parent().attr("isdelsfpopup","true").hide();else{var inputFileElem=$("#"+fieldName+"-id");$(inputFileElem).val("");var inp=$(inputFileElem).next();$(inp).val(null)}},ZFLive.setFieldValue=function(fldLinkName,value){var lastIndexInFU=fldLinkName.lastIndexOf("_"),linkName=fldLinkName.substr(0,lastIndexInFU);$("#test").find("div[elname=fileUploadDiv]").find("div[elname="+fldLinkName+"]").attr("filepath",value);var uniqueFilePath=$("#test").find("a[elname="+fldLinkName+"]");""==$(uniqueFilePath).attr("filepath")&&$(uniqueFilePath).attr("filepath",value);var hiddenFilePath=$("#test").find("input[elname="+linkName+"]"),filepaths=$(hiddenFilePath).attr("filepath");""!=filepaths?$(hiddenFilePath).attr("filepath",filepaths+","+value):$(hiddenFilePath).attr("filepath",value)},ZFLive.clearUploadFormEdit=function(){var fileform=$.find("form[name=UploadFileForm]");$(fileform).find(":input").remove("[type=file]")},ZFLive.evalExpression=function(elem){var thisFieldLi=$(elem).closest("li"),compname=$(thisFieldLi).attr("compname"),actualCompName=$(thisFieldLi).attr("linkname");if(compname==undefined&&(compname=elem),null!=ZFLive.formulaJson)for(var formulaJsonArr=JSON.parse(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd];if(formulaJson.formula_type==ZFFormulaTypeConstants.CONDITIONAL){if(isCurrFldInCondFormulaExps(actualCompName,formulaJson)){var formulaLinkName=formulaJson.link_name;if(formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]){if(0==(parentSubFormUL=$(thisFieldLi).closest("ul[elname='subFormFieldsUl']")).length)evaluateConditionalFormulaInSubFormField(formulaJson,formulaLinkName);else{var rowId=$(parentSubFormUL).attr("rowid");formulaExpressionParser(expression=getConditionalExpression(formulaJson,!0,rowId),formulaLinkName,!0,rowId)}calcFormFormulaWhichHasSFFormula(formulaLinkName)}else{var expression;formulaExpressionParser(expression=getConditionalExpression(formulaJson,!1,-1),formulaLinkName,!1,-1)}}}else if(isExpressionHasCurrentFld(expression=formulaJson.expression,actualCompName)){var parentSubFormUL;formulaLinkName=formulaJson.link_name;if(formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD])0==(parentSubFormUL=$(thisFieldLi).closest("ul[elname='subFormFieldsUl']")).length?evaluateFormulaInSubFormField(expression,formulaLinkName):formulaExpressionParser(expression,formulaLinkName,!0,rowId=$(parentSubFormUL).attr("rowid")),calcFormFormulaWhichHasSFFormula(formulaLinkName);else formulaExpressionParser(expression,formulaLinkName,!1,-1)}}},ZFLive.evaluateConditionsForFormula=function(rule,isSubFormElem,rowId){var logical_oper=rule[ZFFormulaConstants.LOGICAL_OPER],conditions=rule[ZFFormulaConstants.CONDITIONS],dateFormat=$("#zf_date_format").val(),dateLocale=$("#zf_date_format").attr("dateLocale");for(var x in conditions){var zfFormulaCond=new ZFFormulaCondition;zfFormulaCond.fieldLinkName=conditions[x][ZFFormulaConstants.FIELD_LINK_NAME],zfFormulaCond.is_subform_child=conditions[x][ZFFormulaConstants.IS_SUBFORM_CHILD],zfFormulaCond.operator=conditions[x][ZFFormulaConstants.COMP_OPER],conditions[x].value_array!=undefined?zfFormulaCond.condValue=conditions[x].value_array:zfFormulaCond.condValue=conditions[x][ZFFormulaConstants.VALUE],zfFormulaCond.rowLinkName=conditions[x][ZFFormulaConstants.ROW_LINK_NAME],zfFormulaCond.group_name=conditions[x][ZFFormulaConstants.OPT_GROUP_NAME],isSubFormElem&&zfFormulaCond.is_subform_child&&(zfFormulaCond.fieldLinkName=zfFormulaCond.fieldLinkName+"_"+rowId);var result=!1,fldLinkElem=$("li#"+zfFormulaCond.fieldLinkName+"-li"),compType=parseInt(fldLinkElem.attr("comptype"));if(isValidField(fldLinkElem,zfFormulaCond.fieldLinkName,zfFormulaCond.is_subform_child)&&(result=compType===ZFFieldTypeConstants.DATE?evalDateCondition(zfFormulaCond,dateFormat,dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.DATETIME?evalDateTimeCondn(zfFormulaCond,dateFormat,dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.TIME?evalTimeCondition(zfFormulaCond,fldLinkElem):evalCondition(zfFormulaCond,compType)),"matchall"==logical_oper&&!result)return!1;if("matchany"==logical_oper&&result)return!0}return"matchany"!=logical_oper},ZFLive.evalExpressionOnSfEntryDel=function(actualCompName){if(null!=ZFLive.formulaJson)for(var formulaJsonArr=JSON.parse(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var expression,formulaJson=formulaJsonArr[formulaInd];if(formulaJson.formula_type==ZFFormulaTypeConstants.CONDITIONAL){if(isCurrFldInCondFormulaExps(actualCompName,formulaJson))if(!formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD])formulaExpressionParser(expression=getConditionalExpression(formulaJson,!1,-1),formulaJson.link_name,!1,-1)}else if(isExpressionHasCurrentFld(expression=formulaJson.expression,actualCompName)){var formulaLinkName=formulaJson.link_name;formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]||formulaExpressionParser(expression,formulaLinkName,!1,-1)}}},ZFLive.evalExpressionOnFormLoad=function(){if(null!=ZFLive.formulaJson)for(var formulaJsonArr=JSON.parse(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd],formulaLinkName=formulaJson.link_name;if(formulaJson.formula_type==ZFFormulaTypeConstants.CONDITIONAL){if(formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD])evaluateConditionalFormulaInSubFormField(formulaJson,formulaLinkName),calcFormFormulaWhichHasSFFormula(formulaLinkName);else formulaExpressionParser(expression=getConditionalExpression(formulaJson,!1,-1),formulaLinkName,!1,-1)}else{var expression=formulaJson.expression;formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?(evaluateFormulaInSubFormField(expression,formulaLinkName),calcFormFormulaWhichHasSFFormula(formulaLinkName)):formulaExpressionParser(expression,formulaLinkName,!1,-1)}}},ZFLive.bindEventForFormula=function(){var bindedFields=[],matrixRowArr=[];if(typeof ZFLive.formulaJson!=ResponseKey.UNDEFINED){var formulaJson=JSON.parse(ZFLive.formulaJson);for(var i in formulaJson){var formula=formulaJson[i];if(formula.formula_type==ZFFormulaTypeConstants.CONDITIONAL){var fldsInvolvedArr=formula.fields_in_formula_rule_expressions;$.each(fldsInvolvedArr,function(key,linkName){if(-1==$.inArray(linkName,bindedFields)){var compType=getFormFieldType(linkName);if(compType!=ZFFieldTypeConstants.MATRIX_CHOICE){bindedFields.push(linkName);var liElem=$("#test").find("li[linkname="+linkName+"]");$(liElem).length>1?iterateSFUlAndBindForumula($(liElem),linkName,compType):bindEventsOnFieldsForFormula(compType,linkName)}else if(compType==ZFFieldTypeConstants.MATRIX_CHOICE){var rules=formula.formula_rules;for(var j in rules){var conditions=rules[j].conditions;for(var k in conditions){var condition=conditions[k];if(condition.field_link_name==linkName)if(-1==$.inArray(condition.row,matrixRowArr))(liElem=$("#test").find("li[linkname="+linkName+"]")).on("click","input[name="+condition.row+"]",function(){ZFLive.evalExpression(this)}),matrixRowArr.push(condition.row)}}}}})}}}if(null!=ZFLive.formulaFieldsList)for(var fieldsArr=JSON.parse(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){var linkName=fieldsArr[fldInd];if(-1==$.inArray(linkName,bindedFields)){bindedFields.push(linkName);var compType=getFormFieldType(linkName);if(compType!=ZFFieldTypeConstants.MATRIX_CHOICE){var liElem=$("#test").find("li[linkname="+linkName+"]");$(liElem).length>1?iterateSFUlAndBindForumula($(liElem),linkName,compType):bindEventsOnFieldsForFormula(compType,linkName)}}}},ZFLive.bindFormulaEventForSfFldElem=function(fldLinkName,newComponentName){var bindedFields=[];if(typeof ZFLive.formulaJson!=ResponseKey.UNDEFINED){var formulaJson=JSON.parse(ZFLive.formulaJson);for(var i in formulaJson){var formula=formulaJson[i];if(formula.formula_type==ZFFormulaTypeConstants.CONDITIONAL){var fldsInvolvedArr=formula.fields_in_formula_rule_expressions;if(-1!=$.inArray(fldLinkName,fldsInvolvedArr)&&-1==$.inArray(fldLinkName,bindedFields))bindedFields.push(fldLinkName),bindEventsOnFieldsForFormula(getFormFieldType(fldLinkName),newComponentName)}}}if(null!=ZFLive.formulaFieldsList){var fieldsArr=JSON.parse(ZFLive.formulaFieldsList);if(-1!=$.inArray(fldLinkName,fieldsArr)&&-1==$.inArray(fldLinkName,bindedFields))bindedFields.push(fldLinkName),bindEventsOnFieldsForFormula(getFormFieldType(fldLinkName),newComponentName)}},ZFLive.zoomImage=function(elem){var src=$(elem).parent().find("img").attr("src"),imgEle=$("#popupdiv").find("img"),originalSrc=$(elem).attr("originalsrc");$(imgEle).attr("src",""),void 0!==originalSrc?(src=originalSrc+"&imageViewType=preview",$(imgEle).attr("src",src)):$(imgEle).attr("src",src);var popUpContDiv=$(imgEle).parent();setZoomPopUpElemPosition($("#imageChoiceDiv-cont"));var maxHt=$("#imageChoiceDiv-cont").height(),maxWt=$("#imageChoiceDiv-cont").width();$(popUpContDiv).height(maxHt-Math.max(0,$(window).height()/8)-72),$(popUpContDiv).width(maxWt-65),$(imgEle).css("max-width",maxWt-65),$(imgEle).css("max-height",maxHt-Math.max(0,$(window).height()/8)-85),$("#popupdiv").show(),$("body").addClass("hideWindowScroll"),$(document).keyup(function(event){27==event.keyCode&&ZFLive.hideZoomedImage()})},ZFLive.zoomReviewImage=function(elem){var src=$(elem).parent().find("img").attr("src"),imgPopupDiv=$("#reviewImgpopupdiv"),imgEle=$(imgPopupDiv).find("img"),originalSrc=$(elem).attr("originalsrc");void 0!==originalSrc&&(src=originalSrc+"&imageViewType=preview"),$(imgEle).attr("src",src);var popUpContDiv=$(imgEle).parent(),imgContDiv=$("#imageContDiv");setZoomPopUpElemPosition(imgContDiv);var maxHt=$(imgContDiv).height(),maxWt=$(imgContDiv).width();$(popUpContDiv).height(maxHt-Math.max(0,$(window).height()/8)-72),$(popUpContDiv).width(maxWt-65),$(imgEle).css("max-width",maxWt-65),$(imgEle).css("max-height",maxHt-Math.max(0,$(window).height()/8)-85),$(imgPopupDiv).show(),$("body").addClass("hideWindowScroll"),$(document).keyup(function(event){27===event.keyCode&&ZFLive.hideZoomedReviewImage()})},ZFLive.zoomTempImage=function(elem){var src=$(elem).parent().find("img").attr("src"),imgEle=$("#popupdiv").find("img");$(elem).attr("originalsrc");$(imgEle).attr("src",src);var popUpContDiv=$(imgEle).parent();setZoomPopUpElemPosition($("#imageChoiceDiv-cont"));var maxHt=$("#imageChoiceDiv-cont").height(),maxWt=$("#imageChoiceDiv-cont").width();$(popUpContDiv).height(maxHt-Math.max(0,$(window).height()/8)-72),$(popUpContDiv).width(maxWt-65),$(imgEle).css("max-width",maxWt-65),$(imgEle).css("max-height",maxHt-Math.max(0,$(window).height()/8)-85),$("#popupdiv").show(),$("body").addClass("hideWindowScroll"),$(document).keyup(function(event){27==event.keyCode&&ZFLive.hideZoomedImage()})},ZFLive.hideZoomedImage=function(){$("#popupdiv").fadeOut(),$("body").removeClass("hideWindowScroll\t")},ZFLive.hideZoomedReviewImage=function(){$("#reviewImgpopupdiv").fadeOut(),$("body").removeClass("hideWindowScroll")},ZFLive.selectImage=function(elem){var choiceContDiv=$(elem).closest('div[elname="choiceContDiv"]');if(!$(choiceContDiv).hasClass("disabled")){var parentDiv=$(elem).parent().parent(),inp=$(parentDiv).find("input"),type=$(inp).attr("type");if(0!=$(inp).length){var isChecked=$(inp).attr("prevVal");if("radio"==type){var parentli=$(elem).closest("li"),inputs=$(parentli).find("input");$(inputs).each(function(){$(this).attr("prevVal",!1),$(this).parent().parent().removeClass("selected")})}"true"==isChecked?($(inp).prop("checked",!1),$(inp).attr("prevVal",!1),$(choiceContDiv).removeClass("selected")):($(inp).prop("checked",!0),$(inp).attr("prevVal",!0),$(choiceContDiv).addClass("selected"))}else{var imageSelectDiv=$(parentDiv).find("div[name=selectDiv]"),emTag=$(parentDiv).find("em");"selected"==$(imageSelectDiv).attr("selected")?($(imageSelectDiv).removeAttr("selected"),$(choiceContDiv).removeClass("selected"),$(emTag).hide()):($(emTag).show(),$(imageSelectDiv).attr("selected","selected"),$(choiceContDiv).addClass("selected"))}if(null!=ZFLive.paymentMerchantList){var merchantsArr=JSON.parse(ZFLive.paymentMerchantList),compname=$(choiceContDiv).parent().parent().attr("compname");for(var key in merchantsArr){var linkName=merchantsArr[key].field_link_name;compname===linkName&&ZFLive.setValueInPayment(linkName)}}}},ZFLive.validatePage=function(pageNum,clearError,addRangeErrClass){return this.errorArray=new Array,this.errCnt=0,$("#test").find("ul[elname=formBodyULName][page_no="+pageNum+"]").children('[elname="livefield-elem"]').each(function(index,elem){clearError?($(elem).hasClass("error")||$(elem).find("span").hasClass("error1"))&&(removeErrorFromLiElem(elem),ZFLive.validateField(elem,addRangeErrClass)):(removeErrorFromLiElem(elem),ZFLive.validateField(elem,addRangeErrClass))}),this.errorArray.length&&triggerFormResizeOnTimeOut(),this.errorArray},ZFLive.modifyMerchantType=function(elem){var merchantElem=$(elem).parents("div[elname=merchantDiv]"),newMerchantType=$(elem).attr("merchantType"),oldMerchantType=$(merchantElem).attr("merchantType"),isMandatory=$(merchantElem).attr("mandatory");oldMerchantType!==ResponseKey.UNDEFINED&&""!=oldMerchantType&&newMerchantType!=oldMerchantType?(oldMerchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?($("#test").find("div[elname=stripeMerchantDiv]").hide(),$("#payment-error").hide()):oldMerchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET&&($("#test").find("div[elname=authNetMerchantDiv]").hide(),$("#formBodyDiv").find(".pmnt").find("span[elname=authNetPaymentError]").hide()),$(merchantElem).find("a[merchantType="+oldMerchantType+"]").removeClass("selected"),ZFLive.setPaymentAmountDetail(elem,merchantElem,newMerchantType)):"false"==isMandatory&&($(elem).hasClass("selected")?($(elem).removeClass("selected"),$("#test").find("div[elname=paymentDetailsDiv]").hide(),newMerchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?($("#test").find("div[elname=stripeMerchantDiv]").hide(),$("#payment-error").hide()):newMerchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET&&($("#test").find("div[elname=authNetMerchantDiv]").hide(),$("#formBodyDiv").find(".pmnt").find("span[elname=authNetPaymentError]").hide()),$(merchantElem).attr("merchantType","")):ZFLive.setPaymentAmountDetail(elem,merchantElem,newMerchantType))},ZFLive.setPaymentAmountDetail=function(elem,merchantElem,newMerchantType){var pymntLi=$("#PaymentAmount-li");$(merchantElem).attr("merchantType",newMerchantType),$(elem).addClass("selected"),$(pymntLi).find("div[elname=paymentDetailsDiv]").show(),newMerchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?($(pymntLi).find("div[elname=stripeMerchantDiv]").show(),$(pymntLi).find("div[elname=stripeMerchantDiv]").hasClass("error1")&&$("#payment-error").show()):newMerchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET&&($(pymntLi).find("div[elname=authNetMerchantDiv]").show(),$(pymntLi).find("div[elname=authNetMerchantDiv]").hasClass("error1")&&$("#formBodyDiv").find(".pmnt").find("span[elname=authNetPaymentError]").show()),triggerFormResize();var currencyPosition=$(elem).attr("currencyPos"),currencyCode=$(elem).attr("currencyCode"),currencyValue="";$.each(currencyHashcode,function(key,value){if(key==currencyCode){var currSymSpanBefore=$(pymntLi).find("div[elname=paymentDetailsDiv]").find("span[name=currencysymbol1]"),currSymSpanAfter=$(pymntLi).find("div[elname=paymentDetailsDiv]").find("span[name=currencysymbol2]");"1"==currencyPosition?(currSymSpanBefore.html(value),currSymSpanBefore.show(),currSymSpanAfter.hide()):(currSymSpanAfter.html(value),currSymSpanAfter.show(),currSymSpanBefore.hide()),currencyValue=value}});var paymentType=$(merchantElem).attr("paymentType"),amountType=$.trim($(elem).attr("amountType"));if($(pymntLi).find("div[elname=paymentDetailsDiv]").removeClass("error1"),$("#error-PaymentAmount").hide(),paymentType==ZFFormPayments.PAYMENT_TYPE.REGISTRATION)if(2==amountType)ZFLive.changeValueInPayment(newMerchantType,paymentType);else{var amount=$(elem).attr("amount");null!=amount&&""!=amount&&$(pymntLi).find("div[elname=paymentDetailsDiv]").find("input").val(amount)}else if(paymentType==ZFFormPayments.PAYMENT_TYPE.DONATION){var dispAmnt=$.trim($(elem).attr("dispamnt")),minAmnt=$.trim($(elem).attr("minamnt")),maxAmnt=$.trim($(elem).attr("maxamnt"));""!=dispAmnt?$(pymntLi).find("div[elname=paymentDetailsDiv]").find("input").val(dispAmnt):$(pymntLi).find("div[elname=paymentDetailsDiv]").find("input").val(""),""!=minAmnt&&""!=maxAmnt?$(pymntLi).find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").text("( "+ZFUtil.replaceParamsArr(i18n.donationhintmsgminmax,[minAmnt,maxAmnt])+" )").show():""!=minAmnt&&""==maxAmnt?($(pymntLi).find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").text("( "+i18n.donationhintmsgmin).show(),$(pymntLi).find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").append(" "+currencyValue+minAmnt+" )")):""==minAmnt&&""!=maxAmnt?($(pymntLi).find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").text("( "+i18n.donationhintmsgmax).show(),$(pymntLi).find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").append(" "+currencyValue+maxAmnt+" )")):$(pymntLi).find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").hide(),2==amountType&&(""!=dispAmnt?ZFLive.changeValueInPayment(newMerchantType,paymentType,dispAmnt):ZFLive.changeValueInPayment(newMerchantType,paymentType))}},ZFLive.setValueInPayment=function(fieldLinkName){var paymentDiv=$("#test").find("div[elname=merchantDiv]"),selectedMerchantType=$(paymentDiv).attr("merchantType"),pymntType=$(paymentDiv).attr("paymenttype");if(null!=selectedMerchantType&&""!=selectedMerchantType&&null!=ZFLive.paymentMerchantList){var merchantsArr=JSON.parse(ZFLive.paymentMerchantList);for(var key in merchantsArr){var merchantJson=merchantsArr[key],merchantType=merchantJson.merchant_type,linkName=merchantJson.field_link_name;if(selectedMerchantType==merchantType&&linkName==fieldLinkName){var validVal=getValidPaymentValue(getValue(fieldLinkName),pymntType);$("#test").find("div[elname=paymentDetailsDiv]").find("input").val(validVal)}}}},ZFLive.changeValueInPayment=function(selectedMerchantType,pymntType,initDispAmnt){var merchantsArr=JSON.parse(ZFLive.paymentMerchantList);for(var key in merchantsArr){var merchantJson=merchantsArr[key];if(selectedMerchantType==merchantJson.merchant_type){var validVal=getValidPaymentValue(getValue(merchantJson.field_link_name),pymntType);initDispAmnt&&""===validVal&&(validVal=initDispAmnt),$("#test").find("div[elname=paymentDetailsDiv]").find("input").val(validVal)}}},ZFLive.bindEventForPaymentAutoFill=function(){var merchantsArr=JSON.parse(ZFLive.paymentMerchantList);for(var key in merchantsArr){var linkName=merchantsArr[key].field_link_name,compType=getFormFieldType(linkName);if(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL)$("#test").find("li[compname="+linkName+"]").on("blur","input",autoFillPayment(linkName));else if(compType==ZFFieldTypeConstants.RATING)$("#test").find("li[compname="+linkName+"]").on("click","a,span",autoFillPayment(linkName));else if(compType==ZFFieldTypeConstants.SLIDER){var sliderElems=$("#test").find("li[compname="+linkName+"]").find("a");for(index=0;index<sliderElems.length;index++)$(sliderElems[index]).parent().on("slidestop",autoFillPayment(linkName))}else compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX?$("#test").find("li[compname="+linkName+"]").on("change","input",autoFillPayment(linkName)):compType!=ZFFieldTypeConstants.DROPDOWN&&compType!=ZFFieldTypeConstants.MULTIPLE_CHOICE||$("#test").find("li[compname="+linkName+"]").on("change","select",autoFillPayment(linkName))}},ZFLive.selectMatrixChoiceRadioType=function(elem){var isChecked=$(elem).attr("matrixSelectVal"),matrixTr=$(elem).closest("tr");$(matrixTr).find("input").attr("matrixSelectVal",!1),$(matrixTr).find("input").prop("checked",!1),"true"==isChecked?($(elem).prop("checked",!1),$(elem).attr("matrixSelectVal",!1)):($(elem).prop("checked",!0),$(elem).attr("matrixSelectVal",!0))},ZFLive.checkMaxChoiceLimit=function(elememt){var elem=$(elememt).closest("li[elname=livefield-elem]"),maxLimit=$(elem).attr("maxchoices"),compname=$(elem).attr("compname"),errorIdd=ZFLive.errorId(compname);removeError(elem,errorIdd);var noChoices=ZFLive.getSelectedChoiceCount(elem);if(!ZFUtil.chkMaxLimit(noChoices,maxLimit)){var msg=ZFUtil.replaceParams(ZFLiveErrorConstants.maxchoicelimit,maxLimit);$(errorIdd).text(msg),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem)}},ZFLive.getSelectedChoiceCount=function(elem){var noChoices=0,comptype=$(elem).attr("comptype");if(comptype==ZFFieldTypeConstants.CHECKBOX)noChoices=$(elem).find("input:checked").length;else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE)noChoices=$(elem).find("option:selected").length;else if(comptype==ZFFieldTypeConstants.IMAGE_CHOICE){var choiceType=$(elem).find("div[elname=imageChoiceEle]").attr("choicetype");"imagePicker"==choiceType?noChoices=$(elem).find("div[name=selectDiv]").filter("[selected=selected]").length:"checkbox"==choiceType&&(noChoices=$(elem).find("input:checked").length)}return noChoices},ZFLive.validateChoiceLimit=function(elem){var msg,noChoices=ZFLive.getSelectedChoiceCount(elem),compname=$(elem).attr("compname"),errorIdd=ZFLive.errorId(compname),result=!0;if(typeof $(elem).attr("minchoices")!==ResponseKey.UNDEFINED){var minLimit=$(elem).attr("minchoices");result=ZFUtil.chkMinLimit(noChoices,minLimit),msg=ZFUtil.replaceParams(ZFLiveErrorConstants.minchoicelimit,minLimit)}if(typeof $(elem).attr("maxchoices")!==ResponseKey.UNDEFINED&&result){var maxLimit=$(elem).attr("maxchoices");result=ZFUtil.chkMaxLimit(noChoices,maxLimit),msg=ZFUtil.replaceParams(ZFLiveErrorConstants.maxchoicelimit,maxLimit)}result||($(errorIdd).text(msg),animateErrorMsg(errorIdd),ZFLive.addMandatoryError(elem),this.errorArray[this.errCnt]=compname,this.errCnt++)},ZFLive.countWordOrCharacters=function(input){var elem=$(input).closest("li[elname=livefield-elem]");if("true"==$(elem).attr("show_word_count")){var inputLength=0,maxLen=($(elem).attr("min_range"),$(elem).attr("max_range")),rangeType=$(elem).attr("range_type");if(rangeType==RangeProperty.CHARACTERS){var msg=(inputLength=$.trim($(elem).find("textarea").val()).length)+"/"+maxLen+" "+i18n.multilinechars;inputLength<=maxLen?$(elem).find("p[elname=countmsg]").removeClass("errorCountTxt").slideDown(250).text(msg):$(elem).find("p[elname=countmsg]").addClass("errorCountTxt").slideDown(250).text(msg)}else if(rangeType==RangeProperty.WORDS){var wordArr=$.trim($(elem).find("textarea").val()).match(/\S+/g);msg=(inputLength=null!==wordArr?wordArr.length:0)+"/"+maxLen+" "+i18n.multilinewords;inputLength<=maxLen?$(elem).find("p[elname=countmsg]").removeClass("errorCountTxt").slideDown(250).text(msg):$(elem).find("p[elname=countmsg]").addClass("errorCountTxt").slideDown(250).text(msg)}}},ZFLive.hideWordCount=function(input){var elem=$(input).closest("li[elname=livefield-elem]");parseInt($(elem).attr("comptype"))===ZFFieldTypeConstants.MULTI_LINE&&$(elem).find("p[elname=countmsg]").slideUp(150)},ZFLive.validateFieldConstraint=function(input){var elem=$(input).closest("li[elname=livefield-elem]"),compname=$(elem).attr("compname"),errorIdd=ZFLive.errorId(compname);if((comptype=parseInt($(elem).attr("comptype")))!==ZFFieldTypeConstants.NUMBER&&comptype!==ZFFieldTypeConstants.CURRENCY&&comptype!==ZFFieldTypeConstants.DECIMAL||removeLeadingZeros(elem),isIELessThan9()||typeof ZFLive.constraintJson===ResponseKey.UNDEFINED)isSfChild(elem)&&validateSFUniqueness(elem);else{var comptype=parseInt($(elem).attr("comptype")),validationLiResult=validateConstrLiElem(elem,compname,errorIdd,input);if(typeof validationLiResult!==ResponseKey.UNDEFINED&&!0===validationLiResult?isSfChild(elem)?validateSFUniqueness(elem):(removeErrorFromLiElem(elem),$(errorIdd).removeClass("rangeError").removeClass("warningMessage")):typeof validationLiResult!==ResponseKey.UNDEFINED&&!1===validationLiResult&&(showWarningErrorMsg(elem,errorIdd,compname),isSfChild(elem)&&clearSFUniqueError(elem)),comptype===ZFFieldTypeConstants.EMAIL){var needReconf=$(elem).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var reconf_input=$(elem).find("span[elname=livefield-reconf-elem]").find("input");typeof reconf_input!=ResponseKey.UNDEFINED&&$.trim($(reconf_input).val()).length>0?ZFLive.checkIfIdentical(elem,compname,!0):ZFLive.checkIfIdentical(elem,compname,!1)}}}this.prefillFieldLabel(input),setSfTotalVal(elem)},ZFLive.prefillFieldLabelFromSlider=function(compName){var sliderFldElem=$("#test").find("li[compname="+compName+"]"),sliderComp=$(sliderFldElem).find("div[name=slider]"),val="___";val=""!==$(sliderComp).attr("value")&&$(sliderComp).attr("value")!=undefined?$(sliderComp).attr("value").trim():"___";var prefillStr="setlabel_"+$(sliderFldElem).attr("compname");$("#formBodyDiv").find("span[elname="+prefillStr+"]").hide(),$("#formBodyDiv").find("span[elname="+prefillStr+"]").text(val),$("#formBodyDiv").find("span[elname="+prefillStr+"]").fadeIn("fast")},ZFLive.prefillFieldLabel=function(elem){var val="___",fldElem=$(elem).closest("li[elname=livefield-elem]"),compType=$(fldElem).attr("comptype");if(compType==ZFFieldTypeConstants.NAME||compType==ZFFieldTypeConstants.ADDRESS)"-Select-"!==$(elem).val()&&(val=$(elem).val().trim());else if(compType==ZFFieldTypeConstants.RATING)val=$(fldElem).find("a").attr("value");else if(compType==ZFFieldTypeConstants.DROPDOWN){if("-Select-"!==$(elem).val())if($(elem).find("optgroup").length>0){var optionElem=$(elem).find("option:selected"),optGrpElem=$(optionElem).closest("optgroup");val=$.trim($(optGrpElem).attr("label"))+" - "+$(elem).val().trim()}else val=$(elem).val().trim()}else if(compType==ZFFieldTypeConstants.RADIO)$(fldElem).find("input:checked").each(function(index,currRadElem){val=$(currRadElem).attr("allowothers")?$(fldElem).find("input[name=allow-others-text]").val().trim():$(currRadElem).val().trim()});else if(compType==ZFFieldTypeConstants.TIME){var hours=$(fldElem).find('select[timecomp="hours"]').val(),minutes=$(fldElem).find('select[timecomp="minutes"]').val(),meridian=$(fldElem).find('select[timecomp="Meridiem"]').val();val=""===hours||""===minutes||meridian!=undefined&&""===meridian?"":meridian===undefined?hours+":"+minutes:hours+":"+minutes+" "+meridian}else if(compType==ZFFieldTypeConstants.PHONE)if("INTERNATIONAL"==$(fldElem).find("div[elname=phoneFormatElem]").attr("phoneformat")){if(val=$.trim($(fldElem).find("input").val()),"true"==$(fldElem).find("input").attr("iscodeEnabled")){var countryCode=$(fldElem).find("input").intlTelInput("getSelectedCountryData").dialCode;countryCode!=undefined&&(val="+"+countryCode+val)}}else{var phoneVal="";$(fldElem).find("input").each(function(index,elem){var elemValue=$.trim($(elem).val());""!==elemValue&&(phoneVal+=elemValue)}),val=phoneVal}else val=$(elem).val().trim();var compname=$(fldElem).attr("compname");compType!=ZFFieldTypeConstants.NAME&&compType!=ZFFieldTypeConstants.ADDRESS||(compname=$(elem).attr("complink")),setValueInFldLabel(compname,val)},ZFLive.preevalPrefillFldLabel=function(){$("#formBodyDiv").find("li[elname=livefield-elem]").each(function(index,fldElem){var comptype=$(fldElem).attr("comptype"),compname=$(fldElem).attr("compname");if(isAllowedFldTypeForPrefillLabel(comptype)&&"subFormFieldsUl"!==$(fldElem).closest("ul").attr("elname"))if(comptype==ZFFieldTypeConstants.NAME||comptype==ZFFieldTypeConstants.ADDRESS)$(fldElem).find("input,select").each(function(index,elem){isFieldPrefilledByUrl(compname=$(elem).attr("complink"))||""!=$(elem).val().trim()&&"-Select-"!=$(elem).val().trim()&&setValueInFldLabel(compname,$(elem).val().trim())});else if(comptype==ZFFieldTypeConstants.DROPDOWN){if(!isFieldPrefilledByUrl(compname)){var selectElem=$(fldElem).find("select[name='"+compname+"']");if("-Select-"!=(inputVal=$.trim($(selectElem).val()))){if($(selectElem).find("optgroup").length>0){var optionElem=$(selectElem).find("option:selected"),optGrpElem=$(optionElem).closest("optgroup");inputVal=$.trim($(optGrpElem).attr("label"))+" - "+inputVal}setValueInFldLabel(compname,inputVal)}}}else if(comptype==ZFFieldTypeConstants.RADIO){var inputVal;if(!isFieldPrefilledByUrl(compname))"zfs-others-zfs"==(inputVal=$.trim($(fldElem).find("input:radio:checked").val()))&&(inputVal=$.trim($(fldElem).find("input[name=allow-others-text]").val())),setValueInFldLabel(compname,inputVal)}else if(comptype==ZFFieldTypeConstants.TIME){var timeVal="",hours=$(fldElem).find('select[timecomp="hours"]').val(),minutes=$(fldElem).find('select[timecomp="minutes"]').val(),meridian=$(fldElem).find('select[timecomp="Meridiem"]').val();timeVal=""===hours||""===minutes||meridian!=undefined&&""===meridian?"":meridian===undefined?hours+":"+minutes:hours+":"+minutes+" "+meridian,setValueInFldLabel(compname,timeVal)}else if(comptype==ZFFieldTypeConstants.PHONE){var phoneVal="";if("INTERNATIONAL"==$(fldElem).find("div[elname=phoneFormatElem]").attr("phoneformat")){if(phoneVal=$.trim($(fldElem).find("input").val()),"true"==$(fldElem).find("input").attr("iscodeEnabled")){var countryCode=$(fldElem).find("input").intlTelInput("getSelectedCountryData").dialCode;countryCode!=undefined&&(phoneVal="+"+countryCode+phoneVal)}}else $(fldElem).find("input").each(function(index,elem){var elemValue=$.trim($(elem).val());""!==elemValue&&(phoneVal+=elemValue)});setValueInFldLabel(compname,phoneVal)}else comptype==ZFFieldTypeConstants.RATING?setValueInFldLabel(compname,$(fldElem).find("a").attr("value")):comptype==ZFFieldTypeConstants.SLIDER?setValueInFldLabel(compname,$(fldElem).find("div[name=slider]").attr("value").trim()):comptype==ZFFieldTypeConstants.SINGLE_LINE&&isFieldPrefilledByUrl(compname)||setValueInFldLabel(compname,$(fldElem).find("input").val().trim())})},ZFLive.validateFieldEquality=function(elem,setError){var isValid,parentLiElem=$(elem).closest("li[elname=livefield-elem]"),comptype=parseInt($(parentLiElem).attr("comptype")),parentCompname=$(parentLiElem).attr("compname");comptype===ZFFieldTypeConstants.PHONE?($(parentLiElem).find("div[elname=phoneFormatElem]").attr("phoneFormat")===ZFPhoneFormatConstants.USAFORMAT&&ZFLive.focusNext(elem,event),isValid=ZFLive.checkPhFldIdentical(parentLiElem,parentCompname,setError,!0)):isValid=ZFLive.checkIfIdentical(parentLiElem,parentCompname,setError);isSfChild(parentLiElem)&&validateSFUniqueOnReConf(parentLiElem,isValid)},ZFLive.checkIfIdentical=function(parentLiElem,parentCompname,setError){var reconfCompname=parentCompname+"-reconf",inp1=$(parentLiElem).find("input[name="+parentCompname+"]").val(),inp2=$(parentLiElem).find("input[name="+reconfCompname+"]").val(),parentErrorId=ZFLive.errorId(parentCompname),reconfErrorId=ZFLive.errorId(reconfCompname);return!!checkAndRemoveReconfError(inp1,inp2,parentLiElem)||(typeof setError!=ResponseKey.UNDEFINED&&1==setError&&setErrorForConfirm(parentErrorId,reconfErrorId,ZFLiveErrorConstants.emailsdonotmatch),!1)},ZFLive.checkPhFldIdentical=function(parentLiElem,parentCompname,setError,isKeyUpValidation){var reconfCompname=parentCompname+"-reconf",phoneFormat=$(parentLiElem).find("div[elname=phoneFormatElem]").attr("phoneFormat"),parentErrorId=ZFLive.errorId(parentCompname),reconfErrorId=ZFLive.errorId(reconfCompname),inp1="",inp2="";if(phoneFormat===ZFPhoneFormatConstants.USAFORMAT)$(parentLiElem).find("div[elname=phoneFld]").find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());inp1+=val}),$(parentLiElem).find("div[elname=confPhoneFld]").find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());inp2+=val});else if(inp1=$(parentLiElem).find("input[elname=countrycode]").val(),inp2=$(parentLiElem).find("input[elname=countrycodeConf]").val(),"true"==$(parentLiElem).find("input[elname=countrycode]").attr("iscodeEnabled")){var linkName=$(parentLiElem).attr("compname");""!=inp1&&(inp1=getPhoneValWithCountryCode(parentLiElem,linkName)+inp1),""!=inp2&&(inp2=getPhoneValWithCountryCode(parentLiElem,linkName+"-reconf")+inp2)}return!!checkAndRemoveReconfError(inp1,inp2,parentLiElem)||(typeof setError!=ResponseKey.UNDEFINED&&1==setError&&(isKeyUpValidation&&phoneFormat===ZFPhoneFormatConstants.USAFORMAT?setTimeout(function(){$(document.activeElement).closest("li[elname=livefield-elem]").attr("compname");needToValidatePhone(parentCompname,"phoneFld")&&setErrorForConfirm(parentErrorId,reconfErrorId,ZFLiveErrorConstants.phonenosdonotmatch)},0):setErrorForConfirm(parentErrorId,reconfErrorId,ZFLiveErrorConstants.phonenosdonotmatch)),!1)},ZFLive.addRangeError=function(elem,errorIdd,addRangeErrClass,compname,comptype){addRangeErrClass?(this.changeErrArray(compname),ZFLive.addMandatoryError(elem),comptype==ZFFieldTypeConstants.MATRIX_CHOICE&&$(elem).attr("choiceType")==MatrixChoicesType.TEXTBOX.CODE&&$(elem).removeClass("error"),$(errorIdd).removeClass("warningMessage").addClass("rangeError"),animateErrorMsg(errorIdd)):compname!==ZFLive.lastErrorComp||$(elem).hasClass("error")?$(errorIdd).hasClass("rangeError")&&(ZFLive.addMandatoryError(elem),comptype==ZFFieldTypeConstants.MATRIX_CHOICE&&$(elem).attr("choiceType")==MatrixChoicesType.TEXTBOX.CODE&&$(elem).removeClass("error"),animateErrorMsg(errorIdd)):($(errorIdd).addClass("warningMessage"),animateErrorMsg(errorIdd))},ZFLive.checkUniqueChoiceFld=function(inpElem){var fldLi=$(inpElem).closest('[elname="livefield-elem"]');isSfChild(fldLi)&&validateSFUniqueness($(fldLi))},ZFLive.checkUniqueTimeFld=function(inpElem){var fldLi=$(inpElem).closest('[elname="livefield-elem"]');isSfChild(fldLi)&&validateSFUniqueness($(fldLi))},ZFLive.submitButtonClicked=!1,ZFLive.isSFPopUpEnterTriggered=!1,ZFLive.uploadFile=function(fieldLinkName,file,fileUploadLi){var reqURL,linkName=fieldLinkName,uploadID=ZFLive.portalName+"_"+ZFLive.formLinkName+"_"+(new Date).getTime();if(-1!==fieldLinkName.indexOf("_")){var index=fieldLinkName.indexOf("_");fieldLinkName=fieldLinkName.substr(0,index)}reqURL=0==document.getElementById("formPerma").value.length?uploadServerEndpoint+"/"+uploadServerServicekey+"/v2/stream/upload":uploadServerEndpoint+"/"+uploadServerServicekey+"/v2/stream/publicupload";var progressbar_line=$(fileUploadLi).find("div[elname=progressbar_line]");$.ajax({url:reqURL,type:"POST",async:!0,data:file,contentType:!1,processData:!1,xhrFields:{withCredentials:!0},xhr:function(){var xhr=jQuery.ajaxSettings.xhr();return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total*100;progress(percentComplete=Math.ceil(percentComplete),progressbar_line)}},!1),xhr.onerror=function(){var errorId="#fu_error-"+linkName;if($(errorId).text(ZFLiveErrorConstants.uploadservererror),animateErrorMsg(errorId),1==ZFLive.submitButtonClicked||1==ZFLive.isSFPopUpEnterTriggered){var liElem=$("#"+linkName+"-li");if(liElem.addClass("error"),ZFUtil.isDataNeeded(liElem))showAndHidePage(liElem.closest('ul[elname="formBodyULName"]').attr("page_no")),focusFirstErrorElem(liElem)}$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),triggerFormResizeOnTimeOut(),uploadCounter(-1,uploadID)},xhr},beforeSend:function(request){request.setRequestHeader("x-service",uploadServerServicekey),request.setRequestHeader("x-streammode","1"),request.setRequestHeader("upload-id",uploadID),request.setRequestHeader("x-portalname",ZFLive.portalName),request.setRequestHeader("x-formlinkname",ZFLive.formLinkName),request.setRequestHeader("x-fieldlinkname",fieldLinkName),request.setRequestHeader("x-filename",encodeURIComponent(file.name)),request.setRequestHeader("x-assured-response",!0),typeof ZFLive.isClientPortalPrivateForm!=ResponseKey.UNDEFINED&&ZFLive.isClientPortalPrivateForm&&request.setRequestHeader("x-cli-zaid",ZFLive.clientPortalID),uploadCounter(1,uploadID)},success:function(xhr,status,resp){if(typeof resp.responseText!=ResponseKey.UNDEFINED&&resp.responseText.length>0){var responseJson=JSON.parse(resp.responseText);if(typeof responseJson.error!=ResponseKey.UNDEFINED){var errMsg=responseJson.error,errorId="#fu_error-"+linkName;if($(errorId).text(errMsg),animateErrorMsg(errorId),1==ZFLive.submitButtonClicked||1==ZFLive.isSFPopUpEnterTriggered)if((liElem=$("#"+linkName+"-li")).addClass("error"),ZFUtil.isDataNeeded(liElem))showAndHidePage(liElem.closest('ul[elname="formBodyULName"]').attr("page_no")),focusFirstErrorElem(liElem);$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),triggerFormResizeOnTimeOut(),uploadCounter(-1,uploadID)}}else{var fileUploadPath=resp.getResponseHeader("x-msg");if(null==fileUploadPath){var liElem;errorId="#fu_error-"+linkName,errMsg=ZFLiveErrorConstants.uploadservererror;if($(errorId).text(errMsg),animateErrorMsg(errorId),$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),1==ZFLive.submitButtonClicked||1==ZFLive.isSFPopUpEnterTriggered)if((liElem=$("#"+linkName+"-li")).addClass("error"),ZFUtil.isDataNeeded(liElem))showAndHidePage(liElem.closest('ul[elname="formBodyULName"]').attr("page_no")),focusFirstErrorElem(liElem)}else fileUploadPath=decodeURIComponent(fileUploadPath),$(fileUploadLi).attr("uploadPath",fileUploadPath),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show();triggerFormResizeOnTimeOut(),uploadCounter(-1,uploadID)}},error:function(xhr,status,resp){var errMsg=xhr.getResponseHeader("x-error");if(null==errMsg&&(errMsg=ZFLiveErrorConstants.uploadservererror),1==ZFLive.submitButtonClicked||1==ZFLive.isSFPopUpEnterTriggered){var liElem=$("#"+linkName+"-li");if(liElem.addClass("error"),ZFUtil.isDataNeeded(liElem))showAndHidePage(liElem.closest('ul[elname="formBodyULName"]').attr("page_no")),focusFirstErrorElem(liElem)}var errorId="#fu_error-"+linkName;$(errorId).text(errMsg),animateErrorMsg(errorId),$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),triggerFormResizeOnTimeOut(),uploadCounter(-1,uploadID)}})},ZFLive.reAddMultipleFileUploadFields=function(files,linkName){$("#test").find("#error-"+linkName).hide(),$("#test").find("#error-"+linkName).text("");var fileDiv=$("#"+linkName+"-div-files"),i=0;for(var key in files){var newFileUploadLi=fileDiv.find("ul[elname=fileElementUL]").find("li[elname=templateFileElement]").first().clone();if(readFileAgain(files[key],newFileUploadLi,linkName,key)){var fileObj1=files[key];ZFLive.uploadFile(linkName,fileObj1,newFileUploadLi)}fileDiv.find("ul[elname=fileElementUL]").append(newFileUploadLi),i++}i>0&&(fileDiv.show(),triggerFormResize())};var uploadObjects=[];function uploadCounter(counter,uploadID){if(1==counter)-1==uploadObjects.indexOf(uploadID)&&uploadObjects.push(uploadID);else{var index=uploadObjects.indexOf(uploadID);index>-1&&(uploadObjects.splice(index,1),1==ZFLive.submitButtonClicked&&0==uploadObjects.length&&$(ZFLive.actionBtn).trigger("click"),1==ZFLive.isSFPopUpEnterTriggered&&0==uploadObjects.length&&(ZFLive.isSFPopUpEnterTriggered=!1,addThisSFEntryFromPopUp()))}}function progress(value,progressbar_line){$(progressbar_line).css("width",value+"%")}function cancelSubmitOrUpdateFormAction(){hideSavingElem(),$("#disableDiv").hide(),$("#pleaseWait_Div").hide(),$("#savingDiv").hide(),ZFLive.submitButtonClicked=!1}function isActionRestricted(jqXhr){try{if(403===jqXhr.status){var errorJson=JSON.parse(jqXhr.responseText);if(errorJson.error&&"ACTION_RESTRICTED"==errorJson.error)return $("#restrictionPopup").find("[elname=message]").html(errorJson.message),!0}}catch(e){}return!1}function hideRestrictionPopup(){$("#restrictionPopup").fadeOut("slow","linear")}function showRestrictionPopup(){setPopUpElemPosition($("#restrictionPopup-cont")),$("#restrictionPopup").fadeToggle("slow","linear")}function constructReviewJson(){var reviewPageJson={},reviewPage=[];return $("#test").find("ul[elname=formBodyULName][needpagedata=true]").each(function(index,elem){reviewPage.push(constructFieldJsonforReview(elem))}),reviewPageJson.pages=reviewPage,reviewPageJson}function constructFieldJsonforReview(ulelem){var pageJson={},fieldvalue=[],pageNum=$(ulelem).attr("page_no");return pageJson.page_title=getPageTitle(pageNum),$(ulelem).children("li[page_no="+pageNum+"][isvisible!=false][needdata=true]").each(function(index,elem){var fieldjson={},compname=$.trim($(elem).attr("compname"));fieldjson.display_name=$.trim($(elem).children("label").children("span").text()),fieldjson.compname=compname;var comptype=parseInt($(elem).attr("comptype"));fieldjson.comptype=comptype,fieldjson.ismandatory=$(elem).attr("mandatory");var elemtype=$(elem).attr("elemtype");"subFormField"===elemtype?(checkForEmptyRows(elem),ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonReview(fieldjson,elem),fieldjson.elemtype=elemtype):comptype===ZFFieldTypeConstants.ZOHO_CRM?ZFLive.mode===Mode.LIVE?ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(fieldjson,elem,!1):ZFLive.mode===Mode.SAVED_RECORD&&ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(fieldjson,elem,!0):compname===SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME?constructPaymentField(fieldjson,elem):(constructFormFieldDataJsonCommon(fieldjson,elem,!0),comptype===ZFFieldTypeConstants.FORMULA&&constructNormalField(fieldjson,elem)),fieldvalue.push(fieldjson)}),pageJson.fields=fieldvalue,pageJson}function getPageTitle(pageNum){var pageTitle="";return ZFLive.ShowPageTitle===PageTitleOptions.NAVIGATION_BAR&&$("#navigBar").is(":visible")?pageTitle=$($($("#navigBar").find("tr")[1]).find("td")[pageNum-1]).text():ZFLive.ShowPageTitle===PageTitleOptions.PAGE&&(pageTitle=$("ul[elname=formBodyULName][page_no="+pageNum+"]").find("li").first().find("h2").text()),pageTitle}function constructFileImageValForReview(fieldjson,elem){var fileDetailArr=[];$(elem).find("ul[elname=fileElementUL]").find("li[elname!=templateFileElement]").each(function(imgIndex,imgElem){var detailJson={},nametag=$(imgElem).find("em");detailJson.fileSrc=$(imgElem).find("img").attr("src"),detailJson.fileName=nametag.text()+""+nametag.next("b").text(),ZFLive.mode===Mode.SAVED_RECORD&&(detailJson.originalsrc=$(imgElem).find("a[elname=zoomIcon]").attr("originalsrc")),fileDetailArr.push(detailJson)}),fieldjson[$(elem).attr("compname")]=fileDetailArr}function checkForEmptyRows(elem){$(elem).find('ul[elname="subFormFieldsUl"]').each(function(rowIndex,subFormRow){var isRowEmpty=!0;$(subFormRow).children('li[elname="livefield-elem"]').each(function(subFormChildIndex,subFormChildFieldElem){isRowEmpty&&($(subFormChildFieldElem).attr("isvisible")!==BooleanConstants.TRUE||ZFLive.doesSFChildHasEmptyVal(subFormChildFieldElem)||(isRowEmpty=!1))}),isRowEmpty?$(subFormRow).attr("isempty",!0):$(subFormRow).attr("isempty",!1)})}function getAncTagForWebSite(webUrl){var webUrlHref=webUrl;"www."===webUrlHref.substring(0,4).toLowerCase()&&(webUrlHref=LocationProtocols.HTTP+"://"+webUrlHref);var ancElem=document.createElement("a");return ancElem.href=webUrlHref,ancElem.target="_blank",ancElem.rel="noopener noreferrer",$(ancElem).text(webUrl),$(ancElem).attr("onclick","ZFLive.stopOnclickEvent(event)"),ancElem}function getCompositeFldValFromJson(valueJson,delimiter){var value="";for(var key in valueJson)""!==value&&""!==valueJson[key]?value=value+delimiter+valueJson[key]:""!==valueJson[key]&&(value=valueJson[key]);return value}function getImgTag(imgSrc){var imgElem=document.createElement("img");return imgElem.src=imgSrc,imgElem.width=100,imgElem.height=50,imgElem}function setMatrixinReview(fieldsJson,value,td_elem){if(!jQuery.isEmptyObject(value)){var divEle,divEleOuter;$(td_elem).append($("#matrixEntriesTempNew").clone().show().removeAttr("id").attr("elname","matrixNewView"));var rowsVal=fieldsJson.rows,choiceType=fieldsJson.choice_type;for(var key in rowsVal){var rowValue=value[rowsVal[key].row_link_name];if(rowValue!==undefined){divEleOuter=$("#matrixInnerDiv").clone(),$(divEleOuter).show().removeAttr("id"),$(divEleOuter).find("h5").text(rowsVal[key].qstn_name);var ansDiv=$("#matrixAnswerDiv");if(choiceType==MatrixChoicesType.DROPDOWN.CODE||choiceType==MatrixChoicesType.TEXTBOX.CODE){var columValueArray=rowValue;for(var colKey in columValueArray)createMatrixVal(divEle=$(ansDiv).clone(),divEleOuter,columValueArray[colKey].value),$(divEle).find("p").text(columValueArray[colKey].columnname)}else createMatrixVal(divEle=$(ansDiv).clone(),divEleOuter,rowValue),$(divEle).find("p").remove();$(td_elem).find("div[elname=matrixNewView]").append($(divEleOuter))}}}}function createMatrixVal(divEle,divEleOuter,value){$(divEle).show().removeAttr("id"),$(divEle).find("span").text(value),$(divEleOuter).append($(divEle))}function getAncTagForFU(fileJson,tdElem){var fileExtension,fileNamewithoutExt,ancElem=document.createElement("a"),fileName=fileJson.fileName,indexOfExtn=fileName.lastIndexOf(".");-1!=indexOfExtn?(fileExtension=fileName.substr(indexOfExtn+1).toLowerCase(),fileNamewithoutExt=fileName.slice(0,-fileExtension.length)):(fileNamewithoutExt=fileName,fileExtension="");var outerDiv=document.createElement("div"),innerDiv=document.createElement("div");if($(tdElem).append(outerDiv),$(outerDiv).attr("elname","imgDivElm").addClass("imgfileUpload"),-1!==$.inArray(fileExtension,ZFLive.allImageType)){var imgEle=document.createElement("img");$(imgEle).attr({onclick:"ZFLive.stopOnclickEvent(event)",width:"100px",height:"100px"}),$(innerDiv).append('<span class="Over_Icon" onclick="ZFLive.zoomReviewImage(this);"><div class="zoomIcon"></div></span>'),ZFLive.mode===Mode.SAVED_RECORD&&fileJson.hasOwnProperty("originalsrc")&&$(innerDiv).find("span").attr("originalsrc",fileJson.originalsrc),$(innerDiv).append(imgEle),$(imgEle).attr("src",fileJson.fileSrc),$(innerDiv).addClass("imageFile")}else $(innerDiv).addClass("fileTypeIcon"),$(innerDiv).append('<div class="reviewFileIcon"></div>');return $(outerDiv).append(innerDiv),$(ancElem).append('<div class="imgfileName">'+fileNamewithoutExt+"</div><em>"+fileExtension+"</em>"),$(outerDiv).append('<div class="clearBoth"></div>'),$(outerDiv).append(ancElem),tdElem}function constructReviewFieldRow(reviewFldJson,fieldRow){var comptype=parseInt(reviewFldJson.comptype),fieldDispName=reviewFldJson.display_name,linkname=reviewFldJson.compname,fieldValue=reviewFldJson[linkname],displayNameElem=$(fieldRow).find("td[elname=fieldDispName]");"true"===reviewFldJson.ismandatory?displayNameElem.append(escapeSpecialCharacters(fieldDispName)+'<em class="important">'+i18n.asterisksymbol+"</em>"):displayNameElem.text(fieldDispName),$(fieldRow).attr("linkName",reviewFldJson.compname),$(fieldRow).attr("elname","reviewRow");var tdElem=fieldRow.find("td[elname=fieldVal]");if(comptype===ZFFieldTypeConstants.WEBSITE&&""!==$.trim(fieldValue)){var anc_link_elem=getAncTagForWebSite(fieldValue);$(anc_link_elem).appendTo(tdElem)}else if(comptype===ZFFieldTypeConstants.MULTI_LINE)fieldValue=(fieldValue=escapeSpecialCharacters(fieldValue)).replace(/\n/g,"<br />"),$(tdElem).html(fieldValue);else if(comptype===ZFFieldTypeConstants.NAME){fieldValue=getCompositeFldValFromJson(fieldValue," "),tdElem.text(fieldValue)}else if(comptype===ZFFieldTypeConstants.ADDRESS){fieldValue=getCompositeFldValFromJson(fieldValue,", "),tdElem.text(fieldValue)}else if(comptype===ZFFieldTypeConstants.SIGNATURE&&""!==$.trim(fieldValue)){var img_elem=getImgTag(fieldValue);$(img_elem).appendTo(tdElem)}else if(comptype===ZFFieldTypeConstants.MATRIX_CHOICE)setMatrixinReview(reviewFldJson,fieldValue,tdElem);else if(comptype===ZFFieldTypeConstants.FILE_UPLOAD||comptype===ZFFieldTypeConstants.IMAGE_UPLOAD){for(var file_key in fieldValue)var td_elem=getAncTagForFU(fieldValue[file_key],tdElem);$(td_elem).addClass("imgPreview WrapBig")}else if(comptype===ZFFieldTypeConstants.DROPDOWN){var groupname=linkname+"_group_name";if(reviewFldJson.hasOwnProperty(groupname)){var optGrpName=reviewFldJson[groupname];null!==optGrpName&&""!==optGrpName&&(fieldValue=$.trim(optGrpName)+" - "+$.trim(fieldValue))}$(tdElem).text($.trim(fieldValue))}else if(comptype===ZFFieldTypeConstants.ZOHO_CRM)fieldValue.hasOwnProperty(ZohoCrmFieldLiveConstants.CRM_PROPS.NAME)&&typeof fieldValue[ZohoCrmFieldLiveConstants.CRM_PROPS.NAME]!==ResponseKey.UNDEFINED&&$(tdElem).text(fieldValue[ZohoCrmFieldLiveConstants.CRM_PROPS.NAME]);else if(comptype===ZFFieldTypeConstants.PHONE){var countryCode=reviewFldJson[linkname+"_country_code"];countryCode!==undefined&&(fieldValue=countryCode+fieldValue),tdElem.text(fieldValue)}else tdElem.text(fieldValue);fieldRow.show()}function rangeValidationForMatrixChoiceFields(elem,errorIdd,dataSpecJson,inputElem,addRangeErrClass){if(inputElem!=undefined)return validateMatrixInputVal(dataSpecJson,inputElem,errorIdd)?($(inputElem).removeClass("errorMatrixInput"),$(inputElem).removeAttr("isLastError"),isMatrixChoiceRangeErrAvailableAfterClientValidation(errorIdd)?checkAllMatrixInputElem(elem,dataSpecJson,errorIdd)&&($(errorIdd).removeClass("rangeError"),removeErrorFromLiElem(elem)):$(elem).find("input[isLastError=true]").length>0?$(errorIdd).is(":visible")||showWarningErrorMsg(elem,errorIdd,$(elem).attr("compname")):removeErrorFromLiElem(elem)):($(elem).find("input").removeAttr("isLastError"),isMatrixChoiceRangeErrAvailableAfterClientValidation(errorIdd)||($(elem).find("input").removeClass("errorMatrixInput"),$(inputElem).attr("isLastError",!0),$(errorIdd).is(":visible")||showWarningErrorMsg(elem,errorIdd,$(elem).attr("compname"))),$(inputElem).addClass("errorMatrixInput")),undefined;var isRangeErrorAvailable=!1;return $(errorIdd).removeClass("warningMessage"),$(elem).find("input").removeClass("errorMatrixInput"),$(elem).find("input").removeAttr("isLastError"),(addRangeErrClass==undefined||addRangeErrClass||isMatrixChoiceRangeErrAvailableAfterClientValidation(errorIdd))&&$(elem).find("input").each(function(index,matrixInputElem){validateMatrixInputVal(dataSpecJson,matrixInputElem,errorIdd)||($(matrixInputElem).addClass("errorMatrixInput"),isRangeErrorAvailable=!0)}),!isRangeErrorAvailable}function validateMatrixInputVal(dataSpecJson,inputElem,errorIdd){var minLen=dataSpecJson[DataSpecConst.MIN_LEN],maxLen=dataSpecJson[DataSpecConst.MAX_LEN],inputLength=$.trim($(inputElem).val()).length;if(inputLength>0){if(inputLength<minLen||inputLength>maxLen){var errMsg=ZFLiveErrorConstants.matrixtextinputlimit.replace("{0}",minLen.toString()).replace("{1}",maxLen.toString());return $(errorIdd).text(errMsg),!1}if(inputLength>maxLen){errMsg=ZFLiveErrorConstants.matrixtextinputlimit.replace("{0}",minLen.toString()).replace("{1}",maxLen.toString());return $(errorIdd).text(errMsg),!1}}return!0}function checkAllMatrixInputElem(elem,dataSpecJson,errorIdd){var isRangeErrorAvailable=!1;return $(elem).find("input").each(function(index,matrixInputElem){if(!validateMatrixInputVal(dataSpecJson,matrixInputElem,errorIdd))return isRangeErrorAvailable=!0,!1}),!isRangeErrorAvailable}function isMatrixChoiceRangeErrAvailableAfterClientValidation(errorId){return!!$(errorId).hasClass("rangeError")}function needMatrixRangeValidation(elem,compname){return"true"!=$(elem).attr("mandatory")||!($(document.activeElement).closest("li[elname=livefield-elem]").attr("compname")!==compname&&!checkMandatoryMatrixChoice(elem))&&($(elem).attr("isErrorOnSubmission")==undefined||($(elem).removeAttr("isErrorOnSubmission"),!1))}function addMatrixTextBoxErrorJson(errorRowJson,parentElem){for(var rowKey in errorRowJson){var columnJsonArr=errorRowJson[rowKey];$(parentElem).find("input[name="+rowKey+"]").each(function(index,columnElem){addMatrixErrorMessgaeToTextBox(columnJsonArr,columnElem)})}}function addMatrixErrorMessgaeToTextBox(columnJsonArr,columnElem){for(var columnName=$(columnElem).attr("columnvalue"),columnIndex=0;columnIndex<columnJsonArr.length;columnIndex++){columnJsonArr[columnIndex].columnname==columnName&&$(columnElem).addClass("errorMatrixInput")}}function isSfChild(elem){var parentElname=$(elem).closest("ul").attr("elname");return void 0!==parentElname&&"subFormFieldsUl"==parentElname}function isPopupCaptchaNeeded(errorObj){if(1==errorObj.length){if("1"==ZFLive.captchaType&&"verificationcode"==errorObj[0])return!$("#verificationcode-li").is(":visible");if("2"==ZFLive.captchaType&&"recaptchacbox"==errorObj[0])return!$("#recaptchacbox-li").is(":visible")}return!1}function showPopupCaptcha(){bindKeyUpEventForCaptchaPopup(),$("#reviewLoad_Div").show(),resetCaptchaError(),resetPopupCaptchaError(),"1"==ZFLive.captchaType?showPopupcaptchaZoho():"2"==ZFLive.captchaType&&showPopupcaptchaGoogle()}function showPopupcaptchaZoho(){$("#captcha-popup-div").find("div[elname=zf_captcha_div]").show(),resetCaptchaForPopup()}function showPopupcaptchaGoogle(){var captchaPopupDiv=$("#captcha-popup-div"),gCaptchaDiv=$(captchaPopupDiv).find("div[elname=g_recaptcha_div]");$(gCaptchaDiv).show(),"true"==$(gCaptchaDiv).attr("isLoaded")?resetPopupRecaptcha():(renderPopupRecaptcha(),$(gCaptchaDiv).attr("isLoaded","true")),$("#reviewLoad_Div").hide(),setShowCaptchaPopup("345px")}function closeCaptchaPopUp(){unBindKeyUpEvent(),$("#popupCaptchaSave").find("em[elem=loadingImgElem]").hide(),$("#screenFreezeDiv").hide(),$("#captcha-popup-div").hide()}function resetCaptchaForPopup(){$("#screenFreezeDiv").show();var reqURI="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/captcha",oldDigest=$("#captcha-popup-div").find("#pop_captcha_input_id").attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST);typeof oldDigest!=ResponseKey.UNDEFINED&&""!=oldDigest&&(reqURI=reqURI+"?olddigest="+oldDigest);var ajaxOpts={URI:reqURI,METHOD:ZFHttp.GET,ACCEPT:ZFMimeType.APPLICATION_JSON,CALLBACK:function(jsonData,ajaxOpts,jqXhr){var popCaptchaLiElem=$("#pop_captcha_li"),popCaptchaTextElem=$(popCaptchaLiElem).find("#pop_captcha_input_id");if(200===jqXhr.status){var newDigest=JSON.parse(jqXhr.responseText)[ZFLiveConstants.VERIFICATIONCODE.DIGEST];$(popCaptchaLiElem).find("#zf-captcha-pop").attr("src",ZFLive.accountsUrl+"/static/showcaptcha?digest="+newDigest),$(popCaptchaTextElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST,newDigest)}else $(popCaptchaLiElem).find("#zf-captcha-pop").attr("src",""),$(popCaptchaTextElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST,"");$("#reviewLoad_Div").hide(),$(popCaptchaTextElem).val(""),setShowCaptchaPopup("360px"),$("#screenFreezeDiv").hide()}};ZFUtil.sendAjax(ajaxOpts,this)}function resetCaptchaError(){"2"==ZFLive.captchaType?$("#error-recaptchacbox").hide():($("#verificationcode-li").removeClass("error"),$("#error-verificationcode").hide())}function proceedToSaveFromPopup(){if("2"==ZFLive.captchaType?grecaptcha&&0!==grecaptcha.getResponse(ZFLive.popupReCaptcha).length:$.trim($("#pop_captcha_input_id").val()).length>0)unBindKeyUpEvent(),$("#screenFreezeDiv").show(),$("#popupCaptchaSave").find("em[elem=loadingImgElem]").show(),ZFLive.ProceedToSave(!0);else if("2"==ZFLive.captchaType){var ppRecapErrorTg=$("#pop_recaptchacbox-li").find("#error-recaptchacbox-pop");ppRecapErrorTg.text(i18n.entervaluerecaptcha),animateErrorMsg(ppRecapErrorTg)}else{var popCaptchaLiElem=$("#pop_captcha_li");$(popCaptchaLiElem).find("#error-verificationcode-pop").text(i18n.entervaluecaptcha),animateErrorMsg($(popCaptchaLiElem).find("#error-verificationcode-pop")),$(popCaptchaLiElem).find("input[id=pop_captcha_input_id]").focus()}}function resetPopupCaptchaError(){"2"==ZFLive.captchaType?($("#error-recaptchacbox-pop").hide(),$("#pop_recaptchacbox-li").removeClass("error")):($("#error-verificationcode-pop").hide(),$("#pop_captcha_li").removeClass("error"))}function renderPopupRecaptcha(){ZFLive.popupReCaptcha=grecaptcha.render("recaptcha_checkbox_pop",{sitekey:ZFLive.gsiteKey,theme:ZFLive.gtheme})}function resetPopupRecaptcha(){typeof ZFLive!=ResponseKey.UNDEFINED&&typeof ZFLive.popupReCaptcha!=ResponseKey.UNDEFINED&&grecaptcha.reset(ZFLive.popupReCaptcha)}function setPopupPositionNearFooter(popupElem,isForCaptcha){var popupTop,popupLeft=Math.max(0,($(window).width()-$(popupElem).outerWidth())/2),popUpHeight=$(popupElem).outerHeight(),footerOffsetTop=$("ul[elname=footer]:visible").offset().top;footerOffsetTop>popUpHeight?popupTop=footerOffsetTop-popUpHeight:(popupTop=Math.max(10,footerOffsetTop/3),isForCaptcha&&(popupTop+=30)),$(popupElem).css({top:popupTop,left:popupLeft})}function setShowCaptchaPopup(width){var captchaPopCont=$("#captcha-popup-cont");$("#captcha-popup-div").show(),$(captchaPopCont).fadeIn(500),$(captchaPopCont).width(width),setPopupPositionNearFooter($(captchaPopCont),!0)}function isCaptchaErrorNeeded(){if(uploadObjects.length>0&&ZFLive.isUploadSaveValidate){if("1"==ZFLive.captchaType&&!$("#verificationcode-li").is(":visible"))return!1;if("2"==ZFLive.captchaType&&!$("#recaptchacbox-li").is(":visible"))return!1}return!0}function bindKeyUpEventForCaptchaPopup(){$(document).on("keyup",function(event){27===event.keyCode&&closeCaptchaPopUp()})}function numRegexMatchHandler(match,offset,inpString){return new RegExp("^[+|-]?0+$").test(inpString)?"0":0==match.indexOf("-")?"-":""}function decRegexMatchHandler(match,offset,inpString){var decimalSeparator=match.slice(-1);return 0==match.indexOf("-")?"-0"+decimalSeparator:"0"+decimalSeparator}function removeLeadingZeros(elem){if(typeof elem!=ResponseKey.UNDEFINED){var compType=parseInt($(elem).attr("comptype")),inpVal=$.trim($(elem).find("input").val());if(inpVal.length>0){var numberRegexStr="^[+|-]?0+",decimalRegexStr="^[+|-]?0+[.]",onlyZerosRegexStr="^[+|-]?0+[.]0+$";if(compType==ZFFieldTypeConstants.DECIMAL||compType==ZFFieldTypeConstants.CURRENCY){var decimalFormat=$(elem).attr("decimalformat");2==decimalFormat?(decimalRegexStr="^[+|-]?[0|,]+[.]",onlyZerosRegexStr="^[+|-]?[0|,]+[.]0+$",numberRegexStr="^[+|-]?[0|,]+"):3==decimalFormat?(decimalRegexStr="^[+|-]?[0|.]+[,]",onlyZerosRegexStr="^[+|-]?[0|.]+[,]0+$",numberRegexStr="^[+|-]?[0|.]+"):4==decimalFormat&&(decimalRegexStr="^[+|-]?[0| ]+[,]",onlyZerosRegexStr="^[+|-]?[0| ]+[,]0+$",numberRegexStr="^[+|-]?[0| ]+")}var decRegex=new RegExp(decimalRegexStr),numRegex=new RegExp(numberRegexStr);if(decRegex.test(inpVal))inpVal=$.trim(inpVal.replace(decRegex,decRegexMatchHandler)),new RegExp(onlyZerosRegexStr).test(inpVal)&&(inpVal="0"),$(elem).find("input").val(inpVal);else numRegex.test(inpVal)&&((0==(inpVal=$.trim(inpVal.replace(numRegex,numRegexMatchHandler))).length||1==inpVal.length&&"-"==inpVal)&&(inpVal="0"),$(elem).find("input").val(inpVal))}}}function editSignature(editElem,signElem){$("#"+editElem).hide(),$("#"+signElem).attr("style","display:block;");var compname=$("#"+signElem).closest("li[elname=livefield-elem]").attr("compname");setCanvasElemWidth(compname)}function clearSignature(signElemID){var signatureElem=document.getElementById(signElemID);signatureElem.getContext("2d").clearRect(0,0,signatureElem.width,signatureElem.height)}function getXYCoords(event,signatureElem,isTouchEvent){var xCoordinate,yCoordinate,xPosition,yPosition,signElemLeftPos=$(signatureElem).offset().left,signElemTopPos=$(signatureElem).offset().top;return isTouchEvent?(xPosition=event.changedTouches[0].clientX,yPosition=event.changedTouches[0].clientY):(xPosition=event.clientX,yPosition=event.clientY),isTouchEvent||!event.pageX&&!event.pageY?isTouchEvent&&(event.changedTouches[0].pageX||event.changedTouches[0].pageY)?(xCoordinate=event.changedTouches[0].pageX,yCoordinate=event.changedTouches[0].pageY):(xCoordinate=xPosition+document.body.scrollLeft+document.documentElement.scrollLeft,yCoordinate=yPosition+document.body.scrollTop+document.documentElement.scrollTop):(xCoordinate=event.pageX,yCoordinate=event.pageY),{X:xCoordinate-signElemLeftPos,Y:yCoordinate-signElemTopPos}}function startScribbling(event,canvasElem,context,isTouchEvent,fontColor){var position=getXYCoords(event,canvasElem,isTouchEvent);context.lineTo(position.X,position.Y),context.stroke(),context.strokeStyle=fontColor}function endScribbling(event,canvasElem,context,fontColor){startScribbling(event,canvasElem,context,!1,fontColor),context.closePath(),$(canvasElem).off("mousemove").off("mouseup").off("mouseout")}function animateErrorMsg(p){$(p).slideDown(200)}function animateErrorMsg_250(p){$(p).slideDown(250)}function triggerFormResizeOnTimeOut(){setTimeout(triggerFormResize,250)}function treatAsUTC(date){var result=new Date(date);return result.setMinutes(result.getMinutes()-result.getTimezoneOffset()),result.getTime()}function ZFCrmLive(){this.zohoCrmFieldPropsJson={},this.zohoCrmFieldEntriesDetailsJson={},this.formBodyDiv=$("#formBodyDiv"),this.processSearch=!0,this.crmEncryptedRecordId="",this.crmEncryptedZsoid="",this.crmEncryptionType=undefined}ZFLive.deleteFile=function(fieldName,ele){var elem=$(ele).closest("li"),filePath=$(elem).attr("uploadpath"),fileElementUL=$(ele).closest("ul[elname=fileElementUL]"),parentDiv=$(fileElementUL).parent("div");if($(ele).parent().attr("isnewlyadded")==undefined&&ZFSubFormLive.zfSubFormLive!=undefined&&ZFSubFormLive.zfSubFormLive.isPopUpEdit)$(ele).parent().attr("isdelsfpopup","true").hide();else{if(typeof filePath!=ResponseKey.UNDEFINED&&filePath.length>0){var reqUrl,formPerma=document.getElementById("formPerma").value;reqUrl=typeof ZFLive.assignedRecord!=ResponseKey.UNDEFINED&&1==ZFLive.assignedRecord?"/"+this.portalName+"/form/"+this.formLinkName+"/myrecords/deletefile?path="+filePath:typeof ZFLive.approvalEditRecord!=ResponseKey.UNDEFINED&&1==ZFLive.approvalEditRecord?"/"+this.portalName+"/form/"+this.formLinkName+"/approvals/deletefile?path="+filePath:formPerma.length>0?"/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/deletefile?path="+filePath:"/"+this.portalName+"/form/"+this.formLinkName+"/deletefile?path="+filePath,$.ajax({url:reqUrl,type:"DELETE",async:!0,beforeSend:function(jqXHR,settings){var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&jqXHR.setRequestHeader("X-ZCSRF-TOKEN","zfcpn="+csrf)}})}$(ele).closest("li").remove(),ZFLive.removeStoredFile(fieldName,ele)}$(parentDiv).find("li[name=singleFileElement][isdelsfpopup!=true]").length<=0&&$(parentDiv).hide();var errorElems=$(fileElementUL).find("li.fileUploadError");if(0==$(errorElems).length){var errorIdd="#fu_error-"+fieldName;$(errorIdd).hide(),$(errorIdd).text(""),this.validateUploadMinLimitConst(parentDiv)}},ZFLive.validateUploadMinLimitConst=function(fUCont){if(!isIELessThan10()&&!isWindowSafari()&&typeof ZFLive.constraintJson!==ResponseKey.UNDEFINED){var elem=$(fUCont).closest("li[elname=livefield-elem]"),compname=$(elem).attr("compname"),linkname=$(elem).attr("linkname"),errorIdd=(parseInt($(elem).attr("comptype")),ZFLive.errorId(compname)),ismandatory=$(elem).attr("mandatory");if(typeof ZFLive.constraintJson[linkname]!==ResponseKey.UNDEFINED&&typeof ZFLive.constraintJson[linkname][DataSpecConst.MIN_UPLOAD_LIMIT]!==ResponseKey.UNDEFINED){var minUploadLimit=ZFLive.constraintJson[linkname][DataSpecConst.MIN_UPLOAD_LIMIT],totalfiles=$("#"+compname+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement][isdelsfpopup!=true]").length;(totalfiles>0||"true"==ismandatory)&&totalfiles<minUploadLimit?($(errorIdd).text(i18n.filescountminlimiterror.replace("{0}",minUploadLimit)),showWarningErrorMsg(elem,errorIdd,compname)):(removeErrorFromLiElem(elem),$(errorIdd).removeClass("warningMessage").removeClass("rangeError"))}}},ZFLive.validateSaveEmailID=function(){var popup=$("#savePopUpDiv"),emailValue=$(popup).find("input[elname=emailID]").val();return $(popup).find("[elname=emailSavedLink]").removeClass("errSavemail"),$(popup).find("[elname=errorMsg]").fadeOut(),!(0==emailValue.length||!ZFUtil.validateEmailRegex(emailValue))||($(popup).find("[elname=emailSavedLink]").addClass("errSavemail"),$(popup).find("[elname=errorMsg]").text(i18n.entervalidmail).fadeIn(),!1)},ZFLive.sendSavedUrlInEmail=function(elem){if(this.validateSaveEmailID()){var popup=$("#savePopUpDiv"),formPerma=document.getElementById("formPerma").value,email=$(popup).find("input[elname=emailID]").val();if(0!=formPerma.length&&email!=undefined){$(elem).find("[elname=loadingImgElem]").show(),$("#screenFreezeDiv").show(),reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/publicrecord/"+ZFLive.encodedString+"/sendmail?email="+encodeURIComponent(email);var ajaxOpts={URI:reqUri,METHOD:"POST",ACCEPT:"application/json",CALLBACK:function(jsonData,ajaxOpts,jqXhr){if(200==jqXhr.status){$(popup).find("div[elname=emailSavedLink]").slideUp(400);var successDiv=$(popup).find("div[elname=succesDiv]");$(successDiv).find("em[elname=successDivMsg]").text(i18n.saveandresume_email_success),$(successDiv).slideDown(400)}else $(popup).find("[elname=errorMsg]").text(i18n.saveandresume_email_error).fadeIn();$(elem).find("[elname=loadingImgElem]").hide(),$("#screenFreezeDiv").hide()}};ZFUtil.sendAjax(ajaxOpts,this)}}},ZFLive.reviewData=function(){if(ZFLive.reviewValueJSON=constructReviewJson(),ZFLive.reviewType===ReviewTypeOptions.POPUP){var tempReviewDiv=$("#reviewTable");$("div[elname=reviewTable]").remove();var pages=ZFLive.reviewValueJSON.pages;if(0!==pages.length)for(var key in pages){var reviewTable=tempReviewDiv.clone();$(reviewTable).show();var pageTitle=pages[key].page_title;""!==pageTitle&&reviewTable.find("span[elname=pageTitle]").text(pageTitle).show(),reviewTable.removeAttr("id"),reviewTable.attr("elname","reviewTable"),$(reviewTable).find("tr[elname=reviewRow]").remove();var fields=pages[key].fields;0===fields.length&&reviewTable.find("span[elname=pageTitle]").append($("<div class=reviewNoFields><p>"+i18n.nofields+"</p></div>"));var reviewRowTemp=reviewTable.find("tr[elname=reviewRowTemp]"),subFormRvwTemplate=$("#subFormReviewDiv");for(var fld_key in fields)if("subFormField"===fields[fld_key].elemtype){var reviewField=fields[fld_key],fieldDispName=reviewField.display_name,subFormChildrenEntryArray=reviewField.value.rows,sfRow=reviewRowTemp.clone();sfRow.insertBefore(reviewRowTemp),sfRow.attr("linkName",reviewField.compname),sfRow.find("td[elname=fieldDispName]").remove(),$(sfRow).attr("elname","reviewRow");var tdElem=sfRow.find("td[elname=fieldVal]");if($(tdElem).append($('<div class="subform_text">'+escapeSpecialCharacters(fieldDispName)+"</div>")).attr("colspan",2),Array.isArray(subFormChildrenEntryArray)&&!$.isEmptyObject(subFormChildrenEntryArray)){var count=0;$.each(subFormChildrenEntryArray,function(index,childrenEntryJson){count++;var subFormTableDiv=$(subFormRvwTemplate).clone().removeAttr("id").show(),subFormTable=$(subFormTableDiv).find("table");$(subFormTableDiv).find("label").text("#"+count);var sfFields=childrenEntryJson.fields;for(var subFormChildkey in sfFields){var sfFieldRow=reviewRowTemp.clone();$(subFormTable).append($(sfFieldRow)),constructReviewFieldRow(sfFields[subFormChildkey],sfFieldRow)}$(tdElem).append($(subFormTableDiv))})}else $(tdElem).append($("<div class=reviewNoEntry><p elname=noentries>"+i18n.noentry+"</p></div>"));sfRow.show()}else{var fieldRow=reviewRowTemp.clone();fieldRow.insertBefore(reviewRowTemp),constructReviewFieldRow(fields[fld_key],fieldRow)}reviewTable.insertBefore(tempReviewDiv)}var reviewLoadDiv=$("#reviewLoad_Div");$(reviewLoadDiv).is(":visible")&&$(reviewLoadDiv).hide();var reviewPopupCont=$("#reviewPopUpDivCont"),rvwPopupTopCalc=Math.max(0,($(window).height()-reviewPopupCont.outerHeight())/16);setElemPositionForReview(reviewPopupCont),document.activeElement.blur(),$("#reviewPopUpDiv").fadeIn(500,function(){var iFrmHeight=document.body.getBoundingClientRect().height||document.body.offsetHeight,reviewPopupContHeight=reviewPopupCont.height()+rvwPopupTopCalc+30;reviewPopupContHeight>iFrmHeight&&triggerFormResizeToFixed(reviewPopupContHeight)}),$("body").addClass("hideWindowScroll"),$(document).keyup(function(event){27===event.keyCode&&$("#reviewImgpopupdiv").is(":hidden")&&ZFLive.closeReviewPopUp("reviewPopUpDiv")})}return null},ZFLive.stopOnclickEvent=function(event){event.stopPropagation?event.stopPropagation():window.event&&(window.event.cancelBubble=!0)},ZFLive.resetCurrentDateRef=function(){try{if(typeof ZFLive!=ResponseKey.UNDEFINED&&typeof ZFLive.dateConstraintJson!=ResponseKey.UNDEFINED&&!jQuery.isEmptyObject(ZFLive.dateConstraintJson)){reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/forminfo";var formtype=parseInt($("#formType").val());(typeof ZFormType!=ResponseKey.UNDEFINED&&formtype===ZFormType.DOCSFORMS||formtype===ZFormType.WRITERFORMS)&&(reqUri=reqUri+"?rid="+$("#formrid").val());var ajaxOpts={URI:reqUri,METHOD:ZFHttp.GET,CSRF:ZFLive.csrf,ACCEPT:ZFMimeType.APPLICATION_JSON,CALLBACK:function(jsonData,ajaxOpts,jqXhr){if(200==jqXhr.status){var currentDate=JSON.parse(jqXhr.responseText).current_date;typeof currentDate!=ResponseKey.UNDEFINED&&(ZFLive.currentDate=currentDate)}}};ZFUtil.sendAjax(ajaxOpts,this)}}catch(e){}};var ZohoCrmFieldLiveConstants={RESP_KEYS:{DATA_TYPE_DETAILS:"data_type_details",MAPPING_DETAILS:"mapping_details",PARENT_LOOKUP_DETAILS:"parent_lookup_details",ENTRIES_SUMMARY:"entries_summary",ENTRIES_DETAILS:"entries_details"},CRM_PROPS:{NAME:"name"},REQ_KEYS:{ID:"id"}};function evalRulesAfterCrmPrefill(fldLiElem,formCompLabelName){if(ZFLive.mode!=undefined&&"true"==$(fldLiElem).attr("needdata")){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules($(fldLiElem),[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj)}}function evalFormulaOnCrmPrefill(evalFormula){if(null!=ZFLive.formulaFieldsList&&evalFormula.length>0){JSON.parse(ZFLive.formulaFieldsList);for(var index=0;index<evalFormula.length;index++){var compName=evalFormula[index],fldLiElem=ZFCrmLive.zfCrmLive.getLiveFldLiElem(compName);ZFLive.evalExpression($(fldLiElem))}}}function ZFSubFormLive(){this.subFormValueArray=new Array,this.subFormValueJson={},this.isPopUpEdit=!1}function calcMinEntryValForThisSF(elem){if(void 0!==$(elem).attr("min-entry-fld")){var valOfFld=getValue($(elem).attr("min-entry-fld"),!1);return void 0!==valOfFld&&null!=valOfFld&&""!=valOfFld||(valOfFld=0),valOfFld>100&&(valOfFld=100),roundTheValueInFormula(valOfFld,DateCalculationType.ROUNDDOWN)}return parseInt($(elem).attr("min-entry"))}function calcMaxEntryValForThisSF(elem){if(void 0!==$(elem).attr("max-entry-fld")){var valOfFld=getValue($(elem).attr("max-entry-fld"),!1);return void 0!==valOfFld&&null!=valOfFld&&""!=valOfFld||(valOfFld=0),valOfFld>100&&(valOfFld=100),roundTheValueInFormula(valOfFld,DateCalculationType.ROUNDUP)}return parseInt($(elem).attr("max-entry"))}function getSubFormChildActualCompName(compName){return compName.substr(0,compName.lastIndexOf("_"))}function showNoSubFormsRowBtnDiv(subFormsLiElem){$(subFormsLiElem).find('[elname="noElemAddEntryBtnDiv"]').show(),$(subFormsLiElem).find("div.tempSubfrmWrapper").css("overflow-x","hidden"),$(subFormsLiElem).find('[elname="subFormLabelDiv"] > ul').addClass("subfrmAdd_botspace")}function hideNoSubFormsRowBtnDiv(subFormsLiElem){$(subFormsLiElem).find('[elname="noElemAddEntryBtnDiv"]').hide(),$(subFormsLiElem).find("div.tempSubfrmWrapper").css("overflow-x","auto"),$(subFormsLiElem).find('[elname="subFormLabelDiv"] > ul').removeClass("subfrmAdd_botspace")}function addFirstSubFormEntryRow(elem){var subFormParentLi=$(elem).closest('li[elemtype="subFormField"]'),maxEntryVal=calcMaxEntryValForThisSF($(subFormParentLi)),minEntryVal=calcMinEntryValForThisSF($(subFormParentLi));if(maxEntryVal<minEntryVal&&(maxEntryVal=minEntryVal),maxEntryVal>100&&(maxEntryVal=100),minEntryVal>100&&(minEntryVal=100),0!=maxEntryVal){var rowId=parseInt($(subFormParentLi).attr("rowIdx"))+1,myClonedChildUl=$(subFormParentLi).find('ul[elname="subFormFieldsCloneUl"]').clone().attr("elname","subFormFieldsUl").attr("rowId",rowId),subFormFieldsCloneUl=$(subFormParentLi).find('[elname="subFormFieldsCloneUl"]');"true"==$(subFormParentLi).attr("show_seq_no")&&$(myClonedChildUl).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text(1),$(subFormParentLi).attr("rowIdx",rowId),$(myClonedChildUl).insertAfter($(subFormFieldsCloneUl)),hideNoSubFormsRowBtnDiv($(subFormParentLi)),$(myClonedChildUl).show(),modifyClonedSubFormEntryProp(myClonedChildUl,rowId,subFormParentLi,!0),focusFirstField($(myClonedChildUl));var sfSummaryDiv=$(subFormParentLi).find('[elname="sfSummaryDiv"]');$(sfSummaryDiv).length>0&&"true"==$(subFormParentLi).attr("show_summary")&&(resetSFSummary($(subFormParentLi)),$(sfSummaryDiv).show()),triggerFormResize()}else showInfoPopUp(ZFUtil.replaceParams(i18n.subformentriesmaxlimit,maxEntryVal),$(elem))}function showSubFormPop(myClonedChildUl,subFormParentLi,rowId,isNew,prevRowId,sfCardElem){$(myClonedChildUl).hasClass("formFieldWrapper")||$(myClonedChildUl).addClass("formFieldWrapper");var sfPopUp=$("#subFormPopUp"),sfPopUpElem=$(sfPopUp).find("#sFPopUpElem");$(sfPopUpElem).html("").append($(myClonedChildUl)),$(myClonedChildUl).show(),$(sfPopUp).fadeIn(),$("body").addClass("hideWindowScroll");var sfPopupCont=$("#subFormPopUpCont");$(sfPopupCont).width($('[elname="frmTemplate"]').width()-30),$(sfPopupCont).find('[elname="subFormFieldsUl"]').removeClass("subFormHorizontal"),setSFPopUpPosition($(sfPopupCont),$(sfCardElem));var sfPopUpHeader=$(sfPopUp).find('[elname="sfPopUpHeader"]');$.trim($(subFormParentLi).children("label").text()).length>0?($(sfPopUpHeader).show(),$(sfPopUpHeader).find("h2").find("em").text($(subFormParentLi).children("label").text()),$(sfPopUpHeader).find("p").text($(subFormParentLi).children('p[elname="hint"]').text())):$(sfPopUpHeader).hide(),$(sfPopUp).attr("linkname",$(subFormParentLi).attr("linkname")),$(sfPopUp).attr("prevrowid",prevRowId),$(sfPopUp).attr("isnew",isNew),$(sfPopUp).attr("thisrowid",rowId),$(sfPopUp).find("#sFPopUpCloseLink").off("click"),isNew?($(sfPopUp).find("#sFPopUpCloseLink").click(hideSfPopUp),$(sfPopUp).attr("isedit",!1)):($(sfPopUp).find("#sFPopUpCloseLink").click(restoreSFPrevVal),$(sfPopUp).attr("isedit",!0)),$(sfPopUpElem).find("input, select").off("keypress"),$(sfPopUpElem).find("input, select").keypress(function(e){13==e.which&&(e.preventDefault(),addThisSFEntryFromPopUp())})}function setSFPopUpPosition(elem,sfCardElem){var top;elem.css("position","absolute"),top=window.top.location!==window.self.location&&$(window).height()>800?Math.max(0,sfCardElem.offset().top-parseFloat($(elem).css("marginTop"))):Math.max(0,($(window).height()-elem.outerHeight())/3),elem.css("top",top+"px"),$(elem).attr("top",top+parseFloat($(elem).css("marginTop")));var left=Math.max(0,($(window).width()-elem.outerWidth())/2);elem.css("left",left+"px"),$(elem).attr("left",left+parseFloat($(elem).css("marginLeft")))}function addNewSubFormEntry(elem){var subFormParentLi=$(elem).closest('li[elemtype="subFormField"]'),totalSubFormEntries=$(subFormParentLi).find('ul[elname="subFormFieldsUl"]').length,viewType=$(subFormParentLi).attr("viewtype"),maxEntryVal=calcMaxEntryValForThisSF($(subFormParentLi)),minEntryVal=calcMinEntryValForThisSF($(subFormParentLi));if(maxEntryVal<minEntryVal&&(maxEntryVal=minEntryVal),maxEntryVal>100&&(maxEntryVal=100),minEntryVal>100&&(minEntryVal=100),totalSubFormEntries>=maxEntryVal)showInfoPopUp(ZFUtil.replaceParams(i18n.subformentriesmaxlimit,maxEntryVal),$(elem));else{var rowIdFromUl=$(subFormParentLi).attr("rowIdx"),rowId=parseInt(rowIdFromUl)+1,myClonedChildUl=$(subFormParentLi).find('ul[elname="subFormFieldsCloneUl"]').clone().attr("elname","subFormFieldsUl").attr("rowId",rowId),showSeqNo=$(subFormParentLi).attr("show_seq_no");if(1==viewType){var thisSubFormFldUl=$(elem).closest('ul[elname="subFormFieldsUl"]');if($(subFormParentLi).attr("rowIdx",rowId),$(myClonedChildUl).insertAfter($(thisSubFormFldUl)),"true"==showSeqNo){var entrySeqNo=parseInt($(thisSubFormFldUl).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text());$(thisSubFormFldUl).nextAll('ul[elname="subFormFieldsUl"]').each(function(index,sfFldUl){entrySeqNo+=1,$(sfFldUl).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text(entrySeqNo)})}$(myClonedChildUl).show()}else if(2==viewType){var lastCard=$(subFormParentLi).find('div[elname="sfcardelem"]').last(),prevRowId=0;lastCard.length>0&&(prevRowId=parseInt($(lastCard).attr("cardrowid"))),showSubFormPop($(myClonedChildUl),$(subFormParentLi),rowId,!0,prevRowId,$(elem))}modifyClonedSubFormEntryProp(myClonedChildUl,rowId,subFormParentLi,!0),1==viewType&&resetSFSummary($(subFormParentLi)),focusFirstField($(myClonedChildUl)),triggerFormResize()}}function hideSfPopUp(){$("#subFormPopUp").fadeOut("fast",function(){var sfPopUp=$("#subFormPopUp"),sfLinkName=$(sfPopUp).attr("linkname"),ulElem=$(sfPopUp).find("#sFPopUpElem").children('[elname="subFormFieldsUl"]');removeUploadedFiles($(ulElem));var rowId=$(ulElem).attr("rowid");$(ulElem).remove(),removeSubFormEntryCommon($('li[linkname="'+sfLinkName+'"]'),rowId)}),$("body").removeClass("hideWindowScroll")}function addThisSFEntryFromPopUp(){if(!ZFLive.isSFPopUpEnterTriggered){ZFLive.isSFPopUpEnterTriggered=!0;var subFormLinkName=$("#subFormPopUp").attr("linkname"),prevRowId=parseInt($("#subFormPopUp").attr("prevrowid")),isNew="true"==$("#subFormPopUp").attr("isnew"),thisRowId=parseInt($("#subFormPopUp").attr("thisrowid")),ulElem=$("#sFPopUpElem").children('[elname="subFormFieldsUl"]');if(ZFLive.errorArray=new Array,ZFLive.errCnt=0,$(ulElem).find('[elname="sfEntryError"]').hide(),$(ulElem).children('[elname="livefield-elem"]').each(function(index,elem){removeErrorFromLiElem(elem),ZFLive.validateField(elem,!0)}),0==ZFLive.errorArray.length)0==uploadObjects.length&&(isNew||(ZFSubFormLive.zfSubFormLive=undefined,$("#subFormPopUp").find('li[elname="livefield-elem"][comptype="19"],li[elname="livefield-elem"][comptype="32"]').each(function(fldIdx,fileLi){$(fileLi).find('ul[elname="fileElementUL"]').find("[name=singleFileElement]").each(function(fileIdx,fileElem){$(fileElem).removeAttr("isnewlyadded"),"true"==$(fileElem).attr("isdelsfpopup")&&$(fileElem).find('a[name="removeFileElement"]').click()});var parentFileDiv=$(fileLi).find('[elname="fileElementUL"]').parent("div");$(parentFileDiv).find("li[name=singleFileElement]").length<=0?$(parentFileDiv).hide():$(parentFileDiv).show()})),performSFPopUpClose(ulElem,subFormLinkName,prevRowId,isNew,thisRowId));else{var compname=ZFLive.errorArray[0],parentElem=$("#"+compname+"-li");focusFirstErrorElem($(parentElem)),ZFLive.isSFPopUpEnterTriggered=!1}}}function editSFEntry(elem){var sfCardElem=$(elem).closest('[elname="sfcardelem"]'),rowId=$(sfCardElem).attr("cardrowid"),subFormParentLi=$(sfCardElem).closest('li[elemtype="subFormField"]'),thisSubFormFldUl=$(subFormParentLi).find('ul[elname="subFormFieldsUl"][rowId="'+rowId+'"]');if(2==$(subFormParentLi).attr("viewtype")){var previousElem=$(thisSubFormFldUl).prev(),prevRowId=$(previousElem).attr("rowid");showSubFormPop($(thisSubFormFldUl),$(subFormParentLi),rowId,!1,prevRowId,$(sfCardElem)),ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructBackUpDataForPopUp($(thisSubFormFldUl)),ZFSubFormLive.zfSubFormLive.isPopUpEdit=!0,focusFirstField($(thisSubFormFldUl))}}function restoreSFPrevVal(){var subFormLinkName=$("#subFormPopUp").attr("linkname"),prevRowId=parseInt($("#subFormPopUp").attr("prevrowid")),ulElem=$("#subFormPopUp").find('ul[elname="subFormFieldsUl"]');if(ZFSubFormLive.zfSubFormLive.setBackedUpValueToFields(ulElem),$(ulElem).children('[elname="livefield-elem"]').each(function(index,elem){removeErrorFromLiElem(elem)}),"undefined"!=typeof ZFLive.sfUniqueJson&&!$.isEmptyObject(ZFLive.sfUniqueJson)&&"undefined"!=typeof ZFLive.sfUniqueJson[subFormLinkName]){var sfLi=$('li[compname="'+subFormLinkName+'"]'),thisSfUniqueJson=ZFLive.sfUniqueJson[subFormLinkName],uniqueFields=thisSfUniqueJson.fields;if(uniqueFields.length>0)if(2==thisSfUniqueJson.unique_type)validateSfCombUnique(uniqueFields,$(ulElem).find('li[linkname="'+uniqueFields[0]+'"]'),sfLi,!0);else if(1==thisSfUniqueJson.unique_type)for(var i=0;i<uniqueFields.length;i++){validateSfIndUnique($(ulElem).find('li[linkname="'+uniqueFields[i]+'"]'),sfLi,!0)}}performSFPopUpClose(ulElem,subFormLinkName,prevRowId,!1)}function performSFPopUpClose(ulElem,subFormLinkName,prevRowId,isNew,lastRowIndex){var sfPopUp=$("#subFormPopUp");$(sfPopUp).removeAttr("isedit");var sfCardElem,subFormLi=$('li[linkname="'+subFormLinkName+'"]');if(isNew){if(hideNoSubFormsRowBtnDiv($(subFormLi)),$(subFormLi).attr("rowIdx",lastRowIndex),sfCardElem=constructNewSFCard($(subFormLi),$(ulElem),$(ulElem).attr("rowId")),"true"==$(subFormLi).attr("show_seq_no")){var previousSfCard=$(subFormLi).find('[elname="sfcardelem"][cardrowid="'+prevRowId+'"]'),entrySeqNo=0;$(previousSfCard).length>0&&(entrySeqNo=parseInt($(previousSfCard).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text())),$(sfCardElem).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text(entrySeqNo+1)}}else{var rowId=$(ulElem).attr("rowId");sfCardElem=$(subFormLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]'),$(sfCardElem).find('div[elname="sfCardContDiv"]').each(function(idx,cardContDiv){var thisChildLinkName=$(cardContDiv).attr("linkname");$(cardContDiv).find('[elname="recordVal"]').text(getValueFromLiForSFCard($(ulElem).find('li[elname="livefield-elem"][linkname="'+thisChildLinkName+'"]')))})}$(sfPopUp).css("overflow-y","hidden");var topVal=$(sfCardElem).offset().top-$(window).scrollTop(),left=$(sfCardElem).offset().left-$(window).scrollLeft(),height=$(sfCardElem).height(),width=$(sfCardElem).width();left-=parseFloat($("#subFormPopUpCont").attr("left")),topVal-=parseFloat($("#subFormPopUpCont").attr("top"));var sfCardInnerElem=$(sfCardElem).find('[elname="sfCardInnerElem"]');$(sfCardInnerElem).attr("tabindex","1").focus().removeAttr("tabindex"),$(sfCardElem).hide(),$("#subFormPopUpCont").find("#sFPopUpCloseLink").hide(),$("#subFormPopUpCont").find(".templateWrapper").animate({height:height+"px",width:width+"px",top:topVal,left:left,opacity:.2},500,"linear",function(){$(sfPopUp).hide(),$("body").removeClass("hideWindowScroll"),$(ulElem).addClass("subFormHorizontal"),$(ulElem).insertAfter($(subFormLi).find('[rowid="'+prevRowId+'"]')),$(sfPopUp).css("overflow-y","scroll"),$("#subFormPopUpCont").find(".templateWrapper").height("auto").css("opacity","").width("auto").css("left","").css("top",""),$("#subFormPopUpCont").find("#sFPopUpCloseLink").show(),ZFLive.isSFPopUpEnterTriggered=!1}),setTimeout(function(){if(typeof ZFLive.sfUniqueJson!==ResponseKey.UNDEFINED&&typeof ZFLive.sfUniqueJson[subFormLinkName]!==ResponseKey.UNDEFINED)if(2==ZFLive.sfUniqueJson[subFormLinkName].unique_type){var subFormLi=$('li[linkname="'+subFormLinkName+'"]');if(void 0!==(thisSfUniqueError=ZFLive.sfUniqueValidator[subFormLinkName])&&"undefined"!=typeof thisSfUniqueError.combined_unique){var errorRows=thisSfUniqueError.combined_unique;if(errorRows.length>0){var rowId=$(sfCardElem).attr("cardrowid");$.inArray(rowId,errorRows)>-1&&showCombinedUniqueError($(ulElem),subFormLinkName,$(subFormLi))}}}else{var uniqueFlds=ZFLive.sfUniqueJson[subFormLinkName].fields,thisSfUniqueError=ZFLive.sfUniqueValidator[subFormLinkName];if(void 0!==uniqueFlds&&uniqueFlds.length>0&&void 0!==thisSfUniqueError){subFormLi=$('li[linkname="'+subFormLinkName+'"]');for(var i=0;i<uniqueFlds.length;i++){var fldLinkName=uniqueFlds[i];if("undefined"!=typeof thisSfUniqueError[fldLinkName]&&thisSfUniqueError[fldLinkName].length>0){rowId=$(sfCardElem).attr("cardrowid");if($.inArray(rowId,thisSfUniqueError[fldLinkName])>-1){var errorLi=$(ulElem).find('li[linkname="'+fldLinkName+'"]');showIndUniqueError($(errorLi),subFormLinkName,$(subFormLi))}}}}}},1e3),$(sfCardElem).fadeIn(1500)}function constructSubFormCardContent(){$('li[elemtype="subFormField"][viewtype="2"]').each(function(idx1,sfLi){var showSeqNo=$(sfLi).attr("show_seq_no");$(sfLi).find('ul[elname="subFormFieldsUl"]').each(function(idx2,entryUL){var sfCardElem=constructNewSFCard($(sfLi),$(entryUL),$(entryUL).attr("rowId"));"true"==showSeqNo&&$(sfCardElem).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text(idx2+1)})})}function constructNewSFCard(sfLi,entryUL,rowId){var clonedCardElem=$(sfLi).find('[elname="sfcard_cloneElem"]').clone().attr("elname","sfcardelem").attr("cardrowid",$(entryUL).attr("rowId"));return $(clonedCardElem).find('div[elname="sfCardContDiv"]').each(function(idx,cardContDiv){var thisChildLinkName=$(cardContDiv).attr("linkname");$(cardContDiv).find('[elname="recordVal"]').text(getValueFromLiForSFCard($(entryUL).find('li[elname="livefield-elem"][linkname="'+thisChildLinkName+'"]')))}),$(clonedCardElem).insertBefore($(sfLi).find('[elname="addNewCardElem"]')).show(),triggerFormResize(),$(clonedCardElem)}function getValueFromLiForSFCard(childElem){var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype"));if(id){if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.WEBSITE||comptype==ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL)return $.trim($(childElem).find("input").val());if(comptype==ZFFieldTypeConstants.CURRENCY){var currencyVal=$.trim($(childElem).find("input").val());if(currencyVal.length>0){var currencySymbol=$(childElem).find('[elname="currencySymbolSpan"]').text(),currencyPosition=$(childElem).attr("currency_position");if("1"==currencyPosition)return currencySymbol+" "+currencyVal;if("2"==currencyPosition)return currencyVal+" "+currencySymbol}return""}if(comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.DECIMAL){var fieldVal=$.trim($(childElem).find("input").val());if(fieldVal.length>0){var fieldUnit=$(childElem).find('span[elname="field_unit_span"]').text();if(typeof fieldUnit==ResponseKey.UNDEFINED||""==fieldUnit.trim())return fieldVal;if("1"==(unitPosition=$(childElem).attr("unit_position")))return fieldUnit+" "+fieldVal;if("2"==unitPosition)return fieldVal+" "+fieldUnit}return""}if(comptype==ZFFieldTypeConstants.FORMULA){var formulaVal=$.trim($(childElem).find("input").val());if(formulaVal.length>0){var unitPosition,formulaUnit=$(childElem).find('span[elname="formula_unit_span"]').text();if(typeof formulaUnit==ResponseKey.UNDEFINED)return formulaVal;if("1"==(unitPosition=$(childElem).attr("unit_position")))return formulaUnit+" "+formulaVal;if("2"==unitPosition)return formulaVal+" "+formulaUnit}return""}if(comptype==ZFFieldTypeConstants.MULTI_LINE)return $.trim($(childElem).find("TextArea").val().split("\n")[0]);if(comptype==ZFFieldTypeConstants.TIME)return getTimeValueFromElem($(childElem));if(comptype==ZFFieldTypeConstants.NAME||comptype==ZFFieldTypeConstants.ADDRESS){var addValString="";return $(childElem).find("input,select").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());$(elemnew).attr("id")?"-Select-"==val?addValString+="":addValString.length>0?addValString+=", "+val:addValString+=val:val.length>0&&(addValString.length>0?addValString+=", "+val:addValString+=val)}),$.trim(addValString)}if(comptype==ZFFieldTypeConstants.PHONE){var phoneval="",linkName=$(childElem).attr("compname");if("INTERNATIONAL"==$(childElem).find('div[elname="phoneFormatElem"]').attr("phoneformat")){if($(childElem).find('[elname="phoneFld"]').find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());phoneval+=val}),"true"==$(childElem).find("input").attr("iscodeEnabled")){var countryCode="";""!=phoneval&&null!=(countryCode=$(childElem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode)&&(phoneval="+"+countryCode+phoneval)}}else{(countryCode=$.trim($(childElem).find('input[elname="countrycode"]').val())).length>0&&(phoneval="("+countryCode+") ");var phoneFirst=$.trim($(childElem).find('input[elname="first"]').val());phoneFirst.length>0&&(phoneval+=phoneFirst);var phoneSecond=$.trim($(childElem).find('input[elname="second"]').val());phoneSecond.length>0&&(phoneval+="-"+phoneSecond)}return phoneval}if(comptype==ZFFieldTypeConstants.DROPDOWN){var choiceVal="",fldLinkName=$(childElem).attr("compname");return $(childElem).find("select[name='"+fldLinkName+"']").each(function(indexelem,elemnew){if("-Select-"!=$(elemnew).val()&&null!=$(elemnew).val())if($(elemnew).find("optgroup").length>0){var groupName=getGroupNameofSelectedChoice(elemnew,fldLinkName);choiceVal=groupName+" - "+$(elemnew).find("option:selected").text()}else choiceVal=$(elemnew).find("option:selected").text()}),choiceVal}if(comptype==ZFFieldTypeConstants.RADIO){choiceVal="";return $(childElem).find("input[type=radio]").each(function(indexelem,elemnew){var val=$(elemnew).text();$(elemnew).is(":checked")&&(choiceVal=$(elemnew).attr("allowothers")?$(childElem).find("input[name=allow-others-text]").val():val)}),choiceVal}if(comptype==ZFFieldTypeConstants.CHECKBOX){var checkboxJsonArr=[];return $(childElem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).text();$(elemnew).is(":checked")&&checkboxJsonArr.push(val)}),checkboxJsonArr.join(", ")}if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE){var multiJsonArr=[];return $(childElem).find("select").each(function(indexelem,elemnew){for(var id=$(elemnew).attr("id"),txtSelectedObj=document.getElementById(id),i=0;i<txtSelectedObj.options.length;i++)if(txtSelectedObj.options[i].selected){var selectedVal=txtSelectedObj.options[i].text;multiJsonArr.push(selectedVal)}}),multiJsonArr.join(", ")}if(comptype==ZFFieldTypeConstants.DECISION_BOX){var val=$(childElem).find("input").is(":checked");return val=val?"true":"false"}if(comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD){var filepatharr=[];comptype=$(childElem).attr("comptype");return $(childElem).find("ul[elname=fileElementUL]").find("li[elname!=templateFileElement]").each(function(index,elem){var value=$(elem).find('[elname="fileName"]').text()+$(elem).find('[elname="fileExtension"]').text();""!=value&&filepatharr.push(value)}),filepatharr.join(", ")}if(comptype==ZFFieldTypeConstants.RATING){var ratingVal="";return $(childElem).find("a").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");if(null!=val)return ratingVal=val,!1}),ratingVal}if(comptype==ZFFieldTypeConstants.SLIDER)return $(childElem).find("div[name=slider]").each(function(index,elemnew){val=$(elemnew).attr("value")}),val}}function setValueForSummary(sfLi,fldLi){var fldLinkName=$(fldLi).attr("linkname"),totalVal=0;$(sfLi).find('ul[elname="subFormFieldsUl"]').each(function(index,sfUl){var fldLi=$(sfUl).find('li[linkname="'+fldLinkName+'"]'),thisVal=getSummaryValue($(fldLi));null!=thisVal&&""!=thisVal&&thisVal!=undefined&&(totalVal=Number(totalVal)+Number(thisVal))});var comptype=parseInt($(fldLi).attr("comptype"));if(0!=totalVal)if(comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.CURRENCY){var decimalFormat=$(fldLi).attr("decimalformat"),decimallength=$(fldLi).attr("decimallength");totalVal=ZFUtil.getFormattedDecimal(totalVal.toFixed(decimallength),decimalFormat)}else if(comptype===ZFFieldTypeConstants.FORMULA){decimalFormat=$(fldLi).attr("decimalformat");totalVal=ZFUtil.getFormattedDecimal(totalVal.toFixed(2),decimalFormat)}$(sfLi).find('div[elname="sfSummaryDiv"]').find('li[linkname="sum_'+fldLinkName+'"]').find('span[elname="summary_val"]').text(totalVal)}function getSummaryValue(fldLiElem){var val="",comptype=parseInt($(fldLiElem).attr("comptype"));if(comptype===ZFFieldTypeConstants.FORMULA)val=getFormulaValueFromLiElem(fldLiElem);else if(comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL){if(validateCurrency(fldLiElem)){var decimalFormat=$(fldLiElem).attr("decimalformat");val=ZFUtil.getReformattedDecimal($.trim($(fldLiElem).find("input").val()),decimalFormat)}}else comptype===ZFFieldTypeConstants.NUMBER?validateNumber(fldLiElem)&&(val=$.trim($(fldLiElem).find("input").val())):comptype===ZFFieldTypeConstants.SLIDER&&(val=$(fldLiElem).find("div[name=slider]").attr("value"));return val}function removeSFCardEntry(elem){var sfCardElem=$(elem).closest('[elname="sfcardelem"]'),rowId=$(sfCardElem).attr("cardrowid"),subFormParentLi=$(sfCardElem).closest('li[elemtype="subFormField"]'),thisSubFormFldUl=$(subFormParentLi).find('ul[elname="subFormFieldsUl"][rowId="'+rowId+'"]');if(removeUploadedFiles($(thisSubFormFldUl)),"true"==$(subFormParentLi).attr("show_seq_no")){var entrySeqNo=parseInt($(sfCardElem).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text());$(sfCardElem).nextAll('[elname="sfcardelem"]').each(function(index,eachSfCardElem){$(eachSfCardElem).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text(entrySeqNo),entrySeqNo+=1})}$(thisSubFormFldUl).remove(),$(sfCardElem).remove(),removeSubFormEntryCommon(subFormParentLi,rowId),triggerFormResize()}function removeSubFormEntry(elem){var thisSubFormFldUl=$(elem).closest('ul[elname="subFormFieldsUl"]'),subFormParentLi=$(thisSubFormFldUl).closest("li"),rowId=$(thisSubFormFldUl).attr("rowid");if("true"==$(subFormParentLi).attr("show_seq_no")){var entrySeqNo=parseInt($(thisSubFormFldUl).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text());$(thisSubFormFldUl).nextAll('ul[elname="subFormFieldsUl"]').each(function(index,sfFldUl){$(sfFldUl).find('div[elname="showSfSeqNo"]').find('span[elname="val"]').text(entrySeqNo),entrySeqNo+=1})}if($(thisSubFormFldUl).remove(),0==subFormParentLi.find('ul[elname="subFormFieldsUl"]').length){showNoSubFormsRowBtnDiv($(subFormParentLi));var sfSummaryDiv=$(subFormParentLi).find('[elname="sfSummaryDiv"]');$(sfSummaryDiv).length>0&&$(sfSummaryDiv).hide()}resetSFSummary($(subFormParentLi)),removeSubFormEntryCommon(subFormParentLi,rowId),triggerFormResize()}function resetSFSummary(sfLi){"true"==$(sfLi).attr("show_summary")&&$(sfLi).find('ul[elname="subFormFieldsCloneUl"]').find('li[elname="livefield-elem"][summary_type="1"]').each(function(idx1,sfChildLi){var comptype=parseInt($(sfChildLi).attr("comptype"));comptype!==ZFFieldTypeConstants.NUMBER&&comptype!==ZFFieldTypeConstants.DECIMAL&&comptype!==ZFFieldTypeConstants.CURRENCY&&comptype!==ZFFieldTypeConstants.FORMULA&&comptype!==ZFFieldTypeConstants.SLIDER||setValueForSummary($(sfLi),$(sfChildLi))})}function removeSubFormEntryCommon(subFormParentLi,rowId){removeUniqueErrorOnDel(subFormParentLi,rowId),$(subFormParentLi).find('ul[elname="subFormFieldsCloneUl"]').find('li[elname="livefield-elem"]').each(function(idx,li){var compType=parseInt($(li).attr("comptype"));if($(li).attr("linkname")&&(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL||compType==ZFFieldTypeConstants.RATING||compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX||compType==ZFFieldTypeConstants.DROPDOWN||compType==ZFFieldTypeConstants.MULTIPLE_CHOICE||compType==ZFFieldTypeConstants.SLIDER||compType==ZFFieldTypeConstants.FORMULA)&&null!=ZFLive.formulaFieldsList)for(var fieldsArr=JSON.parse(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){var linkName=fieldsArr[fldInd];if(linkName===$(li).attr("linkname")){if(compType==ZFFieldTypeConstants.FORMULA)for(var formulaJsonArr=JSON.parse(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd];if(formulaJson.formula_type==ZFFormulaTypeConstants.CONDITIONAL){if(isCurrFldInCondFormulaExps(linkName,formulaJson))if(!formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD])formulaExpressionParser(getConditionalExpression(formulaJson,!0,-1),formulaJsonArr[formulaInd].link_name,!1,-1)}else isExpressionHasCurrentFld(formulaJsonArr[formulaInd].expression,linkName)&&(formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]||formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!1,-1))}else ZFLive.evalExpressionOnSfEntryDel(linkName);break}}})}function removeUploadedFiles(thisSubFormFldUl){$(thisSubFormFldUl).find('li[elname="livefield-elem"][comptype="19"],li[elname="livefield-elem"][comptype="32"]').each(function(idx,li){var fileElementUL=$(li).find('ul[elname="fileElementUL"]');$(fileElementUL).find('[name="singleFileElement"]').each(function(fileIdx,fileElem){$(fileElem).find('a[name="removeFileElement"]').click()})})}function modifyClonedSubFormEntryProp(myClonedChildUl,rowId,subFormParentLi,needToFocusNewRow){if(myClonedChildUl.find('[elname="livefield-elem"]').each(function(idx,li){var fldActualLinkName=$(li).attr("id").slice(0,-5),newComponentName=fldActualLinkName+"_"+rowId;$(li).attr("id",fldActualLinkName+"_"+rowId+"-li"),$(li).attr("compname",fldActualLinkName+"_"+rowId),1==$(li).attr("comptype")||3==$(li).attr("comptype")||4==$(li).attr("comptype")||20==$(li).attr("comptype")||10==$(li).attr("comptype")?setLiPropInSubFormForInputTextAndError($(li),rowId,fldActualLinkName):2==$(li).attr("comptype")?setMultiLineLiPropForSubForm($(li),rowId,fldActualLinkName):5==$(li).attr("comptype")?setDateLiPropForSubForm($(li),rowId,fldActualLinkName):11==$(li).attr("comptype")?setLiPropInSubFormForPhoneElem($(li),rowId,fldActualLinkName,subFormParentLi):6==$(li).attr("comptype")||7==$(li).attr("comptype")||8==$(li).attr("comptype")?setLiPropInSubFormForErrorElem($(li),rowId,fldActualLinkName):9==$(li).attr("comptype")?setLiPropInSubFormForEmailElem($(li),rowId,fldActualLinkName):12==$(li).attr("comptype")?setLiPropInSubFormForSelectAndError($(li),rowId,fldActualLinkName):13==$(li).attr("comptype")?setLiPropInSubFormFoRadioAndError($(li),rowId,fldActualLinkName):14==$(li).attr("comptype")?setLiPropInSubFormForCheckBoxAndError($(li),rowId,fldActualLinkName):15==$(li).attr("comptype")?setLiPropInSubFormForMultipleChoiceAndError($(li),rowId,fldActualLinkName):16==$(li).attr("comptype")?setDateTimeLiPropForSubForm($(li),rowId,fldActualLinkName):18==$(li).attr("comptype")?setLiPropForSubFormForDecision($(li),rowId,fldActualLinkName):19==$(li).attr("comptype")||32==$(li).attr("comptype")?setFileUploadLiPropForSubForm($(li),rowId,fldActualLinkName):21==$(li).attr("comptype")?setRatingLiPropForSubForm($(li),rowId,fldActualLinkName):23==$(li).attr("comptype")?setSliderLiPropForSubForm($(li),rowId,fldActualLinkName):27==$(li).attr("comptype")&&setLiPropInSubFormForFormula($(li),rowId,fldActualLinkName),$(li).attr("linkname")&&ZFLive.bindFormulaEventForSfFldElem($(li).attr("linkname"),newComponentName)}),null!=ZFLive.formulaFieldsList){var formulaFldArr=JSON.parse(ZFLive.formulaFieldsList),formulaJsonArr=JSON.parse(ZFLive.formulaJson);myClonedChildUl.find('[elname="livefield-elem"]').each(function(idx,li){var linkName=$(li).attr("linkname"),compType=getFormFieldType(linkName);if(compType==ZFFieldTypeConstants.FORMULA){for(var formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++)if(formulaJsonArr[formulaInd].link_name==linkName){var formulaJson=formulaJsonArr[formulaInd];if(formulaJson.formula_type==ZFFormulaTypeConstants.CONDITIONAL)formulaExpressionParser(getConditionalExpression(formulaJson,!0,rowId),formulaJsonArr[formulaInd].link_name,!0,rowId);else formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!0,rowId);calcFormFormulaWhichHasSFFormula(formulaJsonArr[formulaInd].link_name);break}}else compType!=ZFFieldTypeConstants.NUMBER&&compType!=ZFFieldTypeConstants.CURRENCY&&compType!=ZFFieldTypeConstants.DECIMAL&&compType!=ZFFieldTypeConstants.RATING&&compType!=ZFFieldTypeConstants.SLIDER&&compType!=ZFFieldTypeConstants.RADIO&&compType!=ZFFieldTypeConstants.CHECKBOX&&compType!=ZFFieldTypeConstants.DROPDOWN&&compType!=ZFFieldTypeConstants.MULTIPLE_CHOICE||linkName&&-1!=$.inArray(linkName,formulaFldArr)&&ZFLive.evalExpression(this)})}if(1==$(subFormParentLi).attr("viewtype")&&needToFocusNewRow){var subFormFirstChild=$(myClonedChildUl).find("li[elname=livefield-elem]:visible:first"),subFormFirstChildBottom=$(subFormFirstChild).offset().top+$(subFormFirstChild).outerHeight(),subFormEntryBottom=$(myClonedChildUl).offset().top+$(myClonedChildUl).outerHeight(),viewportTop=$(window).scrollTop(),viewportBottom=viewportTop+$(window).height(),viewPortCenter=(viewportBottom-viewportTop)/2;subFormFirstChildBottom>viewportBottom-50||subFormFirstChildBottom>viewportTop+viewPortCenter&&subFormEntryBottom>viewportBottom?$("html, body").animate({scrollTop:viewportTop+viewPortCenter},1e3,function(){focusFirstField($(myClonedChildUl))}):focusFirstField($(myClonedChildUl))}}function setLiPropInSubFormForInputTextAndError(li,rowId,fldActualLinkName){$(li).find("input").attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForEmailElem(li,rowId,fldActualLinkName){var emailSpan=$(li).find("span[elname=livefield-email-elem]");$(emailSpan).find("input").attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId);var needReconf=$(li).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var emailReconfSpan=$(li).find("span[elname=livefield-reconf-elem]");$(emailReconfSpan).find("input").attr("name",fldActualLinkName+"_"+rowId+"-reconf"),$(emailReconfSpan).find('p[elname="reconf-error"]').attr("id","error-"+fldActualLinkName+"_"+rowId+"-reconf"),$(emailReconfSpan).find("input").on("cut copy paste",function(e){e.preventDefault()})}}function setLiPropInSubFormForFormula(li,rowId,fldActualLinkName){$(li).find("input").attr("name",fldActualLinkName+"_"+rowId)}function setLiPropInSubFormFoRadioAndError(li,rowId,fldActualLinkName){$(li).find('input[type="radio"]').each(function(inputIdx,inputTag){$(inputTag).attr("name",fldActualLinkName+"_"+rowId),"radio-input"!==$(inputTag).attr("elname")&&$(inputTag).attr("elname",fldActualLinkName+"_"+rowId);var thisRadioId=$(inputTag).attr("id"),thisRadioNumIndex=thisRadioId.lastIndexOf("_"),thisRadioNum=thisRadioId.substr(thisRadioNumIndex+1);$(inputTag).attr("id",fldActualLinkName+"_"+rowId+"_"+thisRadioNum);var thisRadioLabel=$(inputTag).closest("span").find("label");$(thisRadioLabel).attr("for",fldActualLinkName+"_"+rowId+"_"+thisRadioNum)}),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForCheckBoxAndError(li,rowId,fldActualLinkName){$(li).find("input").each(function(inputIdx,inputTag){$(inputTag).attr("name",fldActualLinkName+"_"+rowId).attr("elname",fldActualLinkName+"_"+rowId);var thisRadioId=$(inputTag).attr("id"),thisRadioNumIndex=thisRadioId.lastIndexOf("_"),thisRadioNum=thisRadioId.substr(thisRadioNumIndex+1);$(inputTag).attr("id",fldActualLinkName+"_"+rowId+"_"+thisRadioNum);var thisRadioLabel=$(inputTag).closest("span").find("label");$(thisRadioLabel).attr("for",fldActualLinkName+"_"+rowId+"_"+thisRadioNum)}),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropForSubFormForDecision(li,rowId,fldActualLinkName){$(li).find("input").attr("id",fldActualLinkName+"_"+rowId).attr("name",fldActualLinkName+"_"+rowId),$(li).find("label").attr("for",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForSelectAndError(li,rowId,fldActualLinkName){$(li).find('select[name="'+fldActualLinkName+'_0"]').attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),$(li).find('select[name="'+fldActualLinkName+'_0-temp-select"]').attr("name",fldActualLinkName+"_"+rowId+"-temp-select")}function setLiPropInSubFormForMultipleChoiceAndError(li,rowId,fldActualLinkName){$(li).find("select").attr("name",fldActualLinkName+"_"+rowId).attr("id",fldActualLinkName+"_"+rowId+"-multiple-id"),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForErrorElem(li,rowId,fldActualLinkName){$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForPhoneElem(li,rowId,fldActualLinkName,subFormParentLi){var keyid=$(li).attr("compname");$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),$(li).find('p[elname="reconf-error"]').attr("id","error-"+fldActualLinkName+"_"+rowId+"-reconf");var subformFldParentInp=subFormParentLi.find("ul[elname=subFormFieldsCloneUl]").find("li[linkname="+fldActualLinkName+"]").find('div[elname="phoneFld"]').find('input[elname="countrycode"]'),isCodeEnabled=$(subformFldParentInp).attr("iscodeEnabled");if("INTERNATIONAL"==$(li).find('div[elname="phoneFormatElem"]').attr("phoneformat")&&$(li).find("input").attr("id",fldActualLinkName+"_"+rowId),"true"==isCodeEnabled){var phoneInp=$(li).find('input[elname="countrycode"]'),needConf=$(li).attr("need_reconf"),phoneInpConf=$(li).find('input[elname="countrycodeConf"]'),initVal=phoneInp.val();ZFPhone.countryCodeProps.initialCountry=$(subformFldParentInp).attr("initCountry");var listOfcountries=$(subformFldParentInp).attr("countrylist"),countryCodeProps=jQuery.extend(!0,{},ZFPhone.countryCodeProps),isRtlEnabled=!1;$("body").hasClass("rtlWrapper")&&(isRtlEnabled=!0),countryCodeProps.isRtl=isRtlEnabled,""!=listOfcountries.length&&(countryCodeProps.onlyCountries=listOfcountries.split(",")),phoneInp.attr("id",keyid),setcounytryCodeDetails(phoneInp,countryCodeProps,isRtlEnabled),null!=initVal&&""!=initVal&&phoneInp.intlTelInput("setNumber",$(phoneInp).val()),"true"==needConf&&(phoneInpConf.attr("id",keyid+"-reconf"),phoneInpConf.attr("name",keyid+"-reconf"),setcounytryCodeDetails(phoneInpConf,countryCodeProps,isRtlEnabled))}}function setcounytryCodeDetails(inpElem,countryCodeProps,isRtlEnabled){inpElem.intlTelInput(countryCodeProps),inpElem.on("countrychange",function(e,countryData){var valinfld=inpElem.val();"+"+inpElem.intlTelInput("getSelectedCountryData").dialCode==valinfld&&inpElem.val("")}),$(inpElem).parent().addClass("phCodeWrapper");var cssPaddingProp=0==isRtlEnabled?"padding-left":"padding-right";$(inpElem).css(cssPaddingProp,ZFUtil.getFlagContWidth(inpElem)+4+"px"),$(inpElem).on("countrychange",function(){$(inpElem).css(cssPaddingProp,ZFUtil.getFlagContWidth(inpElem)+4+"px")}),$(inpElem).on("open:countrydropdown",function(){ZFUtil.setCountryCodeDropdownPosition(inpElem)})}function setMultiLineLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find("textarea").attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setSliderLiPropForSubForm(li,rowId,fldActualLinkName){var inite=$(li).find("div#amount-"+fldActualLinkName+"_0").attr("value");$(li).find('div[name="slider"]').attr("id","amount-"+fldActualLinkName+"_"+rowId),$(li).find("div#sld-"+fldActualLinkName+"_0").attr("id","sld-"+fldActualLinkName+"_"+rowId),$(li).find("div#slid_"+fldActualLinkName+"_0_Div").attr("id","slid_"+fldActualLinkName+"_"+rowId+"_Div"),$(li).find("div#slid-"+fldActualLinkName+"_0").attr("id","slid-"+fldActualLinkName+"_"+rowId),callSliderScript(fldActualLinkName+"_"+rowId,inite,li),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setRatingLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),$(li).find('[elname="ratingSubData"]').find("a").each(function(ratingIdx,ratingAtag){$(ratingAtag).attr("name",fldActualLinkName+"_"+rowId)}),$(li).find("em#"+fldActualLinkName+"_0").attr("id",fldActualLinkName+"_"+rowId)}function setFileUploadLiPropForSubForm(li,rowId,fldActualLinkName){var fileUploadLimit=$(li).attr("uploadlimit");if($(li).find("input[type='file']").attr("name",fldActualLinkName+"_"+rowId).attr("id",fldActualLinkName+"_"+rowId+"-id").off("onchange"),isIELessThan10()||isWindowSafari()?$(li).find("input[type='file']").attr("onchange","ZFLive.addFileUploadFields('"+fldActualLinkName+"_"+rowId+"', this)"):$(li).find("input[type='file']").attr("onchange","ZFLive.addMultipleFileUploadFields(this.files, '"+fldActualLinkName+"_"+rowId+"', '"+fileUploadLimit+"')"),$(li).find('input[elname="'+fldActualLinkName+'_0"]').attr("elname",fldActualLinkName+"_"+rowId),$(li).find("#"+fldActualLinkName+"_0-singlediv").attr("id",fldActualLinkName+"_"+rowId+"-singlediv"),$(li).find("#"+fldActualLinkName+"_0-div-files").attr("id",fldActualLinkName+"_"+rowId+"-div-files"),$(li).find('[elname="delSpan"]').off("click"),$(li).find('[elname="delSpan"]').attr("onclick","ZFLive.deleteFilesNewlyAdded('"+fldActualLinkName+"_"+rowId+"')"),$(li).find('[elname="removeFUElement"]').off("click"),$(li).find('[elname="removeFUElement"]').attr("onclick","ZFLive.deleteMultiplyAddedFiles('"+fldActualLinkName+"_"+rowId+"', this, null)"),$(li).find('[name="fileElementDiv"]').attr("elname",fldActualLinkName+"_"+rowId),$(li).find('[elname="templateFileElement"]').length>0){var removeElementLink=$(li).find('[elname="templateFileElement"]').find('a[name="removeFileElement"]');$(removeElementLink).off("click"),ZFLive.isOldUploadType?$(removeElementLink).attr("onclick","ZFLive.removeFile('"+fldActualLinkName+"_"+rowId+"',this);"):($(removeElementLink).attr("onclick","ZFLive.removeAndDeleteFile('"+fldActualLinkName+"_"+rowId+"',this);"),$(li).find('p[elname="fu_error"]').attr("id","fu_error-"+fldActualLinkName+"_"+rowId))}else $(li).find('[elname="addFileElement"]').off("click").attr("onclick","ZFLive.addFUElementIE(this, '"+fldActualLinkName+"_"+rowId+"','"+fileUploadLimit+"');"),$(li).find('[elname="removeFileElement"]').off("click").attr("onclick","ZFLive.removeFUElementIE(this, '"+fldActualLinkName+"_"+rowId+"',null);");$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setDateLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find("#"+fldActualLinkName+"_0dateDiv").attr("id",fldActualLinkName+"_"+rowId+"dateDiv"),$(li).find("input").attr("id",fldActualLinkName+"_"+rowId+"-date").removeClass("hasDatepicker"),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),callDateScript(fldActualLinkName+"_"+rowId)}function setDateTimeLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find("#"+fldActualLinkName+"_0dateTimeDiv").attr("id",fldActualLinkName+"_"+rowId+"dateTimeDiv"),$(li).find("input").attr("id",fldActualLinkName+"_"+rowId+"-dateTime").removeClass("hasDatepicker"),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),callDateTimeScript(fldActualLinkName+"_"+rowId)}function callDateScript(key){var dateformat=$("#"+key+"dateDiv").attr("elname"),serverDateFormat=$("#zf_date_format").val(),dateElem=$("#"+key+"-date"),dateDiv=(dateElem=$("#"+key+"-date"),$("#"+key+"dateDiv")),dateLocale=$(dateDiv).attr("datelocale");typeof dateLocale!=ResponseKey.UNDEFINED&&""!=dateLocale||(dateLocale="en-GB");var isDisable=$("#"+key+"dateDiv").attr("isDisable");$(dateDiv).find("img").remove();var fldLi=$(dateDiv).closest("li[elname=livefield-elem]"),weekStart=$(fldLi).attr("startoftheweek"),disableDays=$(fldLi).attr("disableddays");$(dateElem).datepicker({showOn:"button",buttonImage:spacerGifLiveUrl,buttonImageOnly:!0,dateFormat:dateformat,showAnim:"drop",changeMonth:!0,yearRange:"1900:2100",firstDay:weekStart,beforeShowDay:function(date){return ZFUtil.blockDays(date,disableDays)},beforeShow:function(date){ZFUtil.setDateLimit(this,serverDateFormat,dateLocale)},monthNamesShort:CustomDateLocale[dateLocale].monthNamesShort,monthNames:CustomDateLocale[dateLocale].monthNames,dayNamesMin:CustomDateLocale[dateLocale].dayNamesMin,showMonthAfterYear:CustomDateLocale[dateLocale].showMonthAfterYear,yearSuffix:CustomDateLocale[dateLocale].yearSuffix,changeYear:!0});var imgElem=$(dateDiv).find("img");$(imgElem).removeClass("ui-datepicker-trigger"),$(imgElem).addClass("calendarIcon"),$(imgElem).removeAttr("alt"),$("#ui-datepicker-div").addClass("calIndex"),"true"==isDisable&&$(dateElem).datepicker().datepicker("disable")}function callDateTimeScript(key){var dateTimeDiv=$("#"+key+"dateTimeDiv");$(dateTimeDiv).find("img").remove();var dateformat=$("#"+key+"dateTimeDiv").attr("elname"),serverDateFormat=$("#"+key+"dateTimeDiv").attr("serverDateFormat"),dateLocale=$("#"+key+"dateTimeDiv").attr("dateLocale"),isDisable=$("#"+key+"dateTimeDiv").attr("isDisable");ZFUtil.datetimepicker(serverDateFormat,dateformat,$("#"+key+"-dateTime"),dateLocale,!1);var imgElem=$(dateTimeDiv).find("img");$(imgElem).removeClass("ui-datepicker-trigger"),$(imgElem).addClass("calendarIcon"),$(imgElem).removeAttr("alt"),$("#ui-datepicker-div").addClass("calIndex"),"true"==isDisable&&$("#"+key+"-dateTime").datepicker().datepicker("disable")}function callSliderScript(key,inite,li){var sliderType=$(li).attr("sliderType"),sliderMin=$(li).attr("sliderMin"),sliderMax=$(li).attr("sliderMax"),isDisable=$(li).attr("isDisable"),isRtlEnabled=!1;$("body").hasClass("rtlWrapper")&&(isRtlEnabled=!0);var thisSliderDiv=$("#sld-"+key);$(thisSliderDiv).children("div").remove(),inite===undefined&&(inite=""),$("#slid-"+key).text(inite),$("#sld-"+key).slider({orientation:sliderType,range:"min",min:Number(sliderMin),max:Number(sliderMax),animate:"300",value:inite,isRTL:isRtlEnabled,slide:function(event,ui){var slidval=ui.value;$("#amount-"+key).attr("value",slidval),$("#slid-"+key).text(slidval),$("#slid_"+key+"_Div").show()},stop:function(event,ui){setSfTotalValForSlider(key)}}),$("#amount-"+key).val(inite),1==isDisable&&$("#sld-"+key).slider({disabled:!0})}function showInfoPopUp(msg,refElem){$("body").addClass("hideWindowScroll");var errMsgPopupElem=$("#infomsg-popup-div");$(errMsgPopupElem).find('p[elname="infoMsg"]').text(msg),$(errMsgPopupElem).show(),setPopUpElemPositionNew($("#infomsg-popup-cont"),refElem),$(document).on("keyup",function(event){27===event.keyCode&&closeInfoPopUp()})}function closeInfoPopUp(){$("body").removeClass("hideWindowScroll"),unBindKeyUpEvent(),$("#infomsg-popup-div").hide()}function performCombinedUniqueCheckForFinalVal(sfLi,sfUniqueCheckJson,validRowsArray,sfRow,addRangeErrClass){var sfLinkName=$(sfLi).attr("linkname");if("undefined"!=typeof sfUniqueCheckJson.isValidForCombUniq&&"undefined"!=typeof ZFLive.sfUniqueJson[sfLinkName]&&"2"==ZFLive.sfUniqueJson[sfLinkName].unique_type)if("undefined"==typeof sfUniqueCheckJson.combined_unique&&(sfUniqueCheckJson.combined_unique=[]),sfUniqueCheckJson.isValidForCombUniq){var combVal=sfUniqueCheckJson.thisentrycombval,valPosInArray=$.inArray(combVal,sfUniqueCheckJson.combined_unique);if(-1!=valPosInArray){sfUniqueCheckJson.combined_unique.push(""),showCombinedUniqueErrorOnFinalValidation($(sfRow),sfLinkName,$(sfLi),addRangeErrClass);var oldSfRow=validRowsArray[valPosInArray];return void(-1==$.inArray($(oldSfRow).attr("rowid"),ZFLive.sfUniqueValidator[sfLinkName].combined_unique)&&showCombinedUniqueErrorOnFinalValidation($(oldSfRow),sfLinkName,$(sfLi),addRangeErrClass))}sfUniqueCheckJson.combined_unique.push(combVal)}else sfUniqueCheckJson.combined_unique.push("")}function validateSFUniquenessForAllFields(sfLi,elem,sfUniqueCheckJson,addRangeErrClass,validRowsArray){var sfLinkName=$(sfLi).attr("linkname");if(typeof ZFLive.sfUniqueJson!==ResponseKey.UNDEFINED&&typeof ZFLive.sfUniqueJson[sfLinkName]!==ResponseKey.UNDEFINED){var uniqueFlds=ZFLive.sfUniqueJson[sfLinkName].fields,linkname=$(elem).attr("linkname");if(void 0!==uniqueFlds&&uniqueFlds.length>0&&$.inArray(linkname,uniqueFlds)>-1)if("1"==ZFLive.sfUniqueJson[sfLinkName].unique_type){"undefined"==typeof sfUniqueCheckJson[linkname]&&(sfUniqueCheckJson[linkname]=[]);var compname=$(elem).attr("compname");if(-1!=$.inArray(compname,ZFLive.errorArray))return void sfUniqueCheckJson[linkname].push("");if(""!=(elemVal=getValueForSfUniqCheck($(elem)))){var valPosInArray=$.inArray(elemVal,sfUniqueCheckJson[linkname]);if(-1!=valPosInArray){sfUniqueCheckJson[linkname].push(""),showIndUniqueErrorOnFinalValidation($(elem),sfLinkName,sfLi,addRangeErrClass);var oldSfRow=validRowsArray[valPosInArray],oldErrElem=$(oldSfRow).find('li[elname="livefield-elem"][linkname="'+linkname+'"]');return void(-1==$.inArray(oldErrElem.attr("compname"),ZFLive.errorArray)&&showIndUniqueErrorOnFinalValidation($(oldErrElem),sfLinkName,sfLi,addRangeErrClass))}sfUniqueCheckJson[linkname].push(elemVal)}else sfUniqueCheckJson[linkname].push("")}else if("2"==ZFLive.sfUniqueJson[sfLinkName].unique_type){"undefined"==typeof sfUniqueCheckJson.isValidForCombUniq&&(sfUniqueCheckJson.isValidForCombUniq=!0);var elemVal;compname=$(elem).attr("compname");if(-1!=$.inArray(compname,ZFLive.errorArray))return void(sfUniqueCheckJson.isValidForCombUniq=!1);""!=(elemVal=getValueForSfUniqCheck($(elem)))?sfUniqueCheckJson.thisentrycombval+=elemVal+"--zf--":sfUniqueCheckJson.isValidForCombUniq=!1}}}function removeUniqueErrorOnDel(subFormParentLi,rowId){var sfLinkName=$(subFormParentLi).attr("linkname");typeof ZFLive.sfUniqueJson!==ResponseKey.UNDEFINED&&typeof ZFLive.sfUniqueJson[sfLinkName]!==ResponseKey.UNDEFINED&&("2"==ZFLive.sfUniqueJson[sfLinkName].unique_type?removeSFCombinedUniqueOnDel(subFormParentLi,sfLinkName,rowId):removeSFIndUniqueOnDel(subFormParentLi,sfLinkName,rowId))}function removeSFCombinedUniqueOnDel(sfLi,sfLinkName,rowId){if("undefined"!=typeof ZFLive.sfUniqueValidator[sfLinkName]&&"undefined"!=typeof ZFLive.sfUniqueValidator[sfLinkName].combined_unique){var previousErrorArr=ZFLive.sfUniqueValidator[sfLinkName].combined_unique,prevErrIdx=$.inArray(rowId,previousErrorArr);if(prevErrIdx>-1){previousErrorArr.splice(prevErrIdx,1);var errRowIdToRemove="";if(1==previousErrorArr.length)errRowIdToRemove=previousErrorArr[0];else{var errArr=[];for(i=0;i<previousErrorArr.length;i++){var thisErrIdx=previousErrorArr[i];if(!($.inArray(thisErrIdx,errArr)>-1)){var isMatchFound=!1,sfCombinedUniqueList=ZFLive.sfUniqueJson[sfLinkName].fields,thisErrVal=getCombinedUniqueValueForARow($(sfLi).find('[rowId="'+thisErrIdx+'"]'),sfCombinedUniqueList);for(j=i+1;j<previousErrorArr.length;j++){var comparingErrIdx=previousErrorArr[j];thisErrVal==getCombinedUniqueValueForARow($(sfLi).find('[rowId="'+comparingErrIdx+'"]'),sfCombinedUniqueList)&&(isMatchFound=!0,errArr.push(comparingErrIdx))}if(!isMatchFound){errRowIdToRemove=thisErrIdx;break}}}}if(""!==errRowIdToRemove){var errIdxToBeRemoved=$.inArray(errRowIdToRemove,previousErrorArr);previousErrorArr.splice(errIdxToBeRemoved,1),removeCombinedUniqueError($(sfLi).find('[rowId="'+errRowIdToRemove+'"]'),sfLinkName,$(sfLi),undefined,!0)}}}}function removeSFIndUniqueOnDel(sfLi,sfLinkName,rowId){if("undefined"!=typeof ZFLive.sfUniqueValidator[sfLinkName]){var uniqueFlds=ZFLive.sfUniqueJson[sfLinkName].fields;if(void 0!==uniqueFlds&&uniqueFlds.length>0)for(var fldIdx=0;fldIdx<uniqueFlds.length;fldIdx++){var fldLinkName=uniqueFlds[fldIdx];if("undefined"!=typeof ZFLive.sfUniqueValidator[sfLinkName][fldLinkName]){var previousErrorArr=ZFLive.sfUniqueValidator[sfLinkName][fldLinkName],prevErrIdx=$.inArray(rowId,previousErrorArr);if(prevErrIdx>-1){previousErrorArr.splice(prevErrIdx,1);var errRowIdToRemove="";if(1==previousErrorArr.length)errRowIdToRemove=previousErrorArr[0];else for(var errArr=[],i=0;i<previousErrorArr.length;i++){var thisErrIdx=previousErrorArr[i];if(!($.inArray(thisErrIdx,errArr)>-1)){var isMatchFound=!1,thisErrVal=getValueForSfUniqCheck($(sfLi).find('[rowId="'+thisErrIdx+'"]').find('li[linkname="'+fldLinkName+'"]'));for(j=i+1;j<previousErrorArr.length;j++){var comparingErrIdx=previousErrorArr[j];thisErrVal==getValueForSfUniqCheck($(sfLi).find('[rowId="'+comparingErrIdx+'"]').find('li[linkname="'+fldLinkName+'"]'))&&(isMatchFound=!0,errArr.push(comparingErrIdx))}if(!isMatchFound){errRowIdToRemove=thisErrIdx;break}}}if(""!==errRowIdToRemove){var errIdxToBeRemoved=$.inArray(errRowIdToRemove,previousErrorArr);previousErrorArr.splice(errIdxToBeRemoved,1);var fldToRemoveErr=$(sfLi).find('[rowId="'+errRowIdToRemove+'"]').find('li[linkname="'+fldLinkName+'"]');removeIndUniqueError($(fldToRemoveErr),sfLinkName,$(sfLi),!0)}}}}}}function validateSFUniqueness(elem){var clearError=!0,linkname=$(elem).attr("linkname");if("undefined"!=typeof ZFLive.sfUniqueJson&&!$.isEmptyObject(ZFLive.sfUniqueJson)){var sfLi,sfPopUp=$(elem).closest("#subFormPopUp");if($(sfPopUp).length>0){var sfLinkName=$(sfPopUp).attr("linkname");sfLi=$('li[compname="'+sfLinkName+'"]')}else sfLi=$(elem).closest('li[elemtype="subFormField"]');var sfFldLinkName=$(sfLi).attr("linkname");if("undefined"!=typeof ZFLive.sfUniqueJson[sfFldLinkName]){var thisSfUniqueJson=ZFLive.sfUniqueJson[sfFldLinkName],uniqueFields=thisSfUniqueJson.fields;$.inArray(linkname,uniqueFields)>-1&&(2==thisSfUniqueJson.unique_type?validateSfCombUnique(uniqueFields,elem,sfLi,!0):1==thisSfUniqueJson.unique_type&&validateSfIndUnique(elem,sfLi,!0),clearError=!1)}}if(clearError){removeErrorFromLiElem($(elem));var errorIdd=ZFLive.errorId($(elem).attr("compname"));$(errorIdd).removeClass("rangeError").removeClass("warningMessage")}}function validateSfIndUnique(elem,sfLi,removeError){var elemVal=getValueForSfUniqCheck($(elem)),errRowIdx=[],linkname=$(elem).attr("linkname");if(""!=elemVal&&($(sfLi).find('ul[elname="subFormFieldsUl"]').each(function(sfFldsUlIndex,sfFldsUl){var sfFldLi=$(sfFldsUl).find('li[linkname="'+linkname+'"]'),fldVal=getValueForSfUniqCheck(sfFldLi);$(sfFldLi).attr("compname")!=$(elem).attr("compname")&&elemVal==fldVal&&errRowIdx.push($(sfFldsUl).attr("rowId"))}),errRowIdx.length>0)){var sfFldUl=$(elem).closest('ul[elname="subFormFieldsUl"]');errRowIdx.push($(sfFldUl).attr("rowId"))}setSFIndUniqueError(errRowIdx,$(sfLi),$(sfLi).attr("linkname"),linkname,$(elem),removeError)}function validateSfCombUnique(sfCombinedUniqueList,elem,sfLi,removeError){var thisSfUl=$(elem).closest('ul[elname="subFormFieldsUl"]'),combinedUiqueVal=getCombinedUniqueValueForARow($(thisSfUl),sfCombinedUniqueList),combinedUiqueErrorEntries=[];void 0!==combinedUiqueVal&&""!=$.trim(combinedUiqueVal)&&($(sfLi).find('ul[elname="subFormFieldsUl"]').each(function(sfFldsUlIndex,sfFldsUl){if($(sfFldsUl).attr("rowid")!=thisSfUl.attr("rowid")){var thisEntryVal=getCombinedUniqueValueForARow($(sfFldsUl),sfCombinedUniqueList);combinedUiqueVal==thisEntryVal&&combinedUiqueErrorEntries.push($(sfFldsUl).attr("rowid"))}}),combinedUiqueErrorEntries.length>0&&combinedUiqueErrorEntries.push($(thisSfUl).attr("rowid"))),setSFCombinedUniqueError(combinedUiqueErrorEntries,$(sfLi),$(sfLi).attr("linkname"),$(elem).attr("linkname"),$(elem),removeError)}function getCombinedUniqueValueForARow(sfFldsUl,sfCombinedUniqueList){for(var thisEntryVal="",sfCombUniqFldPos=0;sfCombUniqFldPos<sfCombinedUniqueList.length;sfCombUniqFldPos++){var sfChildFldLinkName=sfCombinedUniqueList[sfCombUniqFldPos],sfChildFldVal=getValueForSfUniqCheck($(sfFldsUl).find('li[linkname="'+sfChildFldLinkName+'"]'));if(""==sfChildFldVal){thisEntryVal="";break}thisEntryVal+=sfChildFldVal+"--zf--"}return thisEntryVal.toLowerCase()}function getValueForSfUniqCheck(elem){if("true"==$(elem).attr("isvisible")){var elemVal=getValueFromLiForSFCard($(elem));if(void 0!==elemVal&&""!=elemVal.trim()){var compType=$(elem).attr("comptype");if(compType==ZFFieldTypeConstants.PHONE){if(needConf(elem)){var reconf_input=$(elem).find("div[elname=confPhoneFld]").find("input"),compname=$(elem).attr("compname");return $.trim($(reconf_input).val()).length>0&&ZFLive.checkPhFldIdentical(elem,compname,!1,!1)?elemVal.trim().toLowerCase():""}return elemVal.trim().toLowerCase()}if(compType==ZFFieldTypeConstants.EMAIL){if(needConf(elem)){reconf_input=$(elem).find("span[elname=livefield-reconf-elem]").find("input"),compname=$(elem).attr("compname");return typeof reconf_input!=ResponseKey.UNDEFINED&&$.trim($(reconf_input).val()).length>0&&ZFLive.checkIfIdentical(elem,compname,!1)?elemVal.trim().toLowerCase():""}return elemVal.trim().toLowerCase()}return elemVal.trim().toLowerCase()}}return""}function clearSFUniqueError(elem){var parentElname=$(elem).closest("ul").attr("elname");if(void 0!==parentElname&&"subFormFieldsUl"==parentElname){var sfLi,linkname=elem.attr("linkname"),sfPopUp=$(elem).closest("#subFormPopUp");if($(sfPopUp).length>0){var sfLinkName=$(sfPopUp).attr("linkname");sfLi=$('li[compname="'+sfLinkName+'"]')}else sfLi=$(elem).closest('li[elemtype="subFormField"]');var sfFldLinkName=$(sfLi).attr("linkname"),thisSfUniqueJson=ZFLive.sfUniqueJson[sfFldLinkName];if(typeof thisSfUniqueJson!==ResponseKey.UNDEFINED){var uniqueFields=thisSfUniqueJson.fields;$.inArray(linkname,uniqueFields)>-1&&(2==thisSfUniqueJson.unique_type?setSFCombinedUniqueError([],sfLi,sfFldLinkName,linkname,elem,!1):1==thisSfUniqueJson.unique_type&&setSFIndUniqueError([],sfLi,sfFldLinkName,linkname,elem,!1))}}}function setSFCombinedUniqueError(errArr,sfLi,sfLinkName,fldLinkName,thisElem,removeError){"undefined"!=typeof ZFLive.sfUniqueValidator[sfLinkName]?"undefined"==typeof ZFLive.sfUniqueValidator[sfLinkName].combined_unique&&(ZFLive.sfUniqueValidator[sfLinkName].combined_unique=[]):(ZFLive.sfUniqueValidator[sfLinkName]={},ZFLive.sfUniqueValidator[sfLinkName].combined_unique=[]);var previousErrorArr=ZFLive.sfUniqueValidator[sfLinkName].combined_unique,thisSfUl=$(thisElem).closest('ul[elname="subFormFieldsUl"]'),prevErrIdx=$.inArray($(thisSfUl).attr("rowid"),previousErrorArr);if(prevErrIdx>-1){if(errArr.length>0)for(i=0;i<errArr.length;i++){var errIdx=errArr[i];-1==$.inArray(errIdx,previousErrorArr)&&(previousErrorArr.push(errIdx),showCombinedUniqueError($(sfLi).find('[rowId="'+errIdx+'"]'),sfLinkName,$(sfLi)))}else previousErrorArr.splice(prevErrIdx,1),removeCombinedUniqueError(thisSfUl,sfLinkName,$(sfLi),thisElem,removeError);var errRowIdToRemove="";if(1==previousErrorArr.length)errRowIdToRemove=previousErrorArr[0];else for(i=0;i<previousErrorArr.length;i++){var thisErrIdx=previousErrorArr[i];if(!($.inArray(thisErrIdx,errArr)>-1)){var isMatchFound=!1,sfCombinedUniqueList=ZFLive.sfUniqueJson[sfLinkName].fields,thisErrVal=getCombinedUniqueValueForARow($(sfLi).find('[rowId="'+thisErrIdx+'"]'),sfCombinedUniqueList);for(j=i+1;j<previousErrorArr.length;j++){var comparingErrIdx=previousErrorArr[j];thisErrVal==getCombinedUniqueValueForARow($(sfLi).find('[rowId="'+comparingErrIdx+'"]'),sfCombinedUniqueList)&&(isMatchFound=!0,errArr.push(comparingErrIdx))}if(!isMatchFound){errRowIdToRemove=thisErrIdx;break}}}if(""!==errRowIdToRemove){var errIdxToBeRemoved=$.inArray(errRowIdToRemove,previousErrorArr);previousErrorArr.splice(errIdxToBeRemoved,1),removeCombinedUniqueError($(sfLi).find('[rowId="'+errRowIdToRemove+'"]'),sfLinkName,$(sfLi),thisElem,!0)}}else if(errArr.length>0)for(i=0;i<errArr.length;i++)-1==$.inArray(errArr[i],previousErrorArr)&&(errArr[i]==$(thisSfUl).attr("rowid")?showCombinedUniqueError($(thisSfUl),sfLinkName,$(sfLi)):showCombinedUniqueError($(sfLi).find('[rowId="'+errArr[i]+'"]'),sfLinkName,$(sfLi)),previousErrorArr.push(errArr[i]));else if(removeError){removeErrorFromLiElem($(thisElem));var errorIdd=ZFLive.errorId($(thisElem).attr("compname"));$(errorIdd).removeClass("rangeError").removeClass("warningMessage")}}function showCombinedUniqueErrorOnFinalValidation(sfUl,sfFldLinkName,sfLi,needToAddError){var sfViewType=$(sfLi).attr("viewtype"),sfCombinedUniqueList=ZFLive.sfUniqueJson[sfFldLinkName].fields;$(sfUl).find('p[elname="sfEntryError"]').text(i18n.sfcombineduniquecheckerr),animateErrorMsg_250($(sfUl).find('p[elname="sfEntryError"]'));for(var i=0;i<sfCombinedUniqueList.length;i++){var fldLi=$(sfUl).find('li[linkname="'+sfCombinedUniqueList[i]+'"]');$(fldLi).hasClass("error")||$(fldLi).addClass("error"),$(fldLi).find('p[elname="error"]').text(""),"undefined"==typeof ZFLive.sfUniqueValidator[sfFldLinkName]&&(ZFLive.sfUniqueValidator[sfFldLinkName]={}),"undefined"==typeof ZFLive.sfUniqueValidator[sfFldLinkName].combined_unique&&(ZFLive.sfUniqueValidator[sfFldLinkName].combined_unique=[]);var errArr=ZFLive.sfUniqueValidator[sfFldLinkName].combined_unique,thisRowId=$(sfUl).attr("rowid");-1==$.inArray(thisRowId,errArr)&&errArr.push(thisRowId),needToAddError&&ZFLive.changeErrArray($(fldLi).attr("compname"))}if("2"==sfViewType){var rowId=$(sfUl).attr("rowid"),cardDiv=$(sfLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]');1!=$(cardDiv).length||$(cardDiv).find('[elname="sfCardInnerElem"]').hasClass("sfCardError")||$(cardDiv).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),$(sfLi).find("p#error-"+sfFldLinkName).text(i18n.sfcombineduniquecheckerr),animateErrorMsg_250($(sfLi).find("p#error-"+sfFldLinkName))}}function showCombinedUniqueError(sfUl,sfFldLinkName,sfLi){var sfViewType=$(sfLi).attr("viewtype"),sfCombinedUniqueList=ZFLive.sfUniqueJson[sfFldLinkName].fields;$(sfUl).find('p[elname="sfEntryError"]').text(i18n.sfcombineduniquecheckerr),animateErrorMsg_250($(sfUl).find('p[elname="sfEntryError"]'));for(var i=0;i<sfCombinedUniqueList.length;i++){var fldLi=$(sfUl).find('li[linkname="'+sfCombinedUniqueList[i]+'"]');$(fldLi).hasClass("error")||$(fldLi).addClass("error"),$(fldLi).find('p[elname="error"]').text("")}if("2"==sfViewType){var rowId=$(sfUl).attr("rowid"),cardDiv=$(sfLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]');1!=$(cardDiv).length||$(cardDiv).find('[elname="sfCardInnerElem"]').hasClass("sfCardError")||$(cardDiv).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),$(sfLi).find("p#error-"+sfFldLinkName).text(i18n.sfcombineduniquecheckerr),animateErrorMsg_250($(sfLi).find("p#error-"+sfFldLinkName))}}function removeCombinedUniqueError(sfUl,sfFldLinkName,sfLi,thisElem,removeError){var sfViewType=$(sfLi).attr("viewtype");if($(sfUl).find('p[elname="sfEntryError"]').text("").hide(),"2"==sfViewType){var rowId=$(sfUl).attr("rowid"),cardDiv=$(sfLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]');1==$(cardDiv).length&&$(cardDiv).find('[elname="sfCardInnerElem"]').hasClass("sfCardError")&&$(cardDiv).find('[elname="sfCardInnerElem"]').removeClass("sfCardError"),0==$(sfLi).find('[elname="sfCardInnerElem"].sfCardError').length&&$(sfLi).children("p[elname=error]").hide()}for(var sfCombinedUniqueList=ZFLive.sfUniqueJson[sfFldLinkName].fields,i=0;i<sfCombinedUniqueList.length;i++){var fldLi=$(sfUl).find('li[linkname="'+sfCombinedUniqueList[i]+'"]');if($(fldLi).removeClass("error"),!removeError&&void 0!==thisElem&&sfCombinedUniqueList[i]==$(thisElem).attr("linkname")){var compName=$(thisElem).attr("compname"),errorIdd=$(fldLi).find(ZFLive.errorId(compName));$(errorIdd).hasClass("rangeError")&&($(errorIdd).removeClass("rangeError"),showWarningErrorMsg(thisElem,errorIdd,compName))}}}function setSFIndUniqueError(errArr,sfLi,sfLinkName,fldLinkName,thisElem,removeError){"undefined"!=typeof ZFLive.sfUniqueValidator[sfLinkName]?"undefined"==typeof ZFLive.sfUniqueValidator[sfLinkName][fldLinkName]&&(ZFLive.sfUniqueValidator[sfLinkName][fldLinkName]=[]):(ZFLive.sfUniqueValidator[sfLinkName]={},ZFLive.sfUniqueValidator[sfLinkName][fldLinkName]=[]);var previousErrorArr=ZFLive.sfUniqueValidator[sfLinkName][fldLinkName],thisSfUl=$(thisElem).closest('ul[elname="subFormFieldsUl"]'),prevErrIdx=$.inArray($(thisSfUl).attr("rowid"),previousErrorArr);if(prevErrIdx>-1){if(errArr.length>0)for(i=0;i<errArr.length;i++){var errIdx=errArr[i];if(-1==$.inArray(errIdx,previousErrorArr)){previousErrorArr.push(errIdx);var errorLi=$(sfLi).find('[rowId="'+errArr[i]+'"]').find('li[linkname="'+fldLinkName+'"]');showIndUniqueError($(errorLi),sfLinkName,$(sfLi))}}else previousErrorArr.splice(prevErrIdx,1),removeIndUniqueError($(thisElem),sfLinkName,$(sfLi),removeError);var errRowIdToRemove="";if(1==previousErrorArr.length)errRowIdToRemove=previousErrorArr[0];else for(i=0;i<previousErrorArr.length;i++){var thisErrIdx=previousErrorArr[i];if(!($.inArray(thisErrIdx,errArr)>-1)){var isMatchFound=!1,thisErrVal=getValueForSfUniqCheck($(sfLi).find('[rowId="'+thisErrIdx+'"]').find('li[linkname="'+fldLinkName+'"]'));for(j=i+1;j<previousErrorArr.length;j++){var comparingErrIdx=previousErrorArr[j];thisErrVal==getValueForSfUniqCheck($(sfLi).find('[rowId="'+comparingErrIdx+'"]').find('li[linkname="'+fldLinkName+'"]'))&&(isMatchFound=!0,errArr.push(comparingErrIdx))}if(!isMatchFound){errRowIdToRemove=thisErrIdx;break}}}if(""!==errRowIdToRemove){var errIdxToBeRemoved=$.inArray(errRowIdToRemove,previousErrorArr);previousErrorArr.splice(errIdxToBeRemoved,1);var fldToRemoveErr=$(sfLi).find('[rowId="'+errRowIdToRemove+'"]').find('li[linkname="'+fldLinkName+'"]');removeIndUniqueError($(fldToRemoveErr),sfLinkName,$(sfLi),!0)}}else if(errArr.length>0){for(i=0;i<errArr.length;i++)if(-1==$.inArray(errArr[i],previousErrorArr)){if(errArr[i]==$(thisSfUl).attr("rowid"))showIndUniqueError($(thisElem),sfLinkName,$(sfLi));else{errorLi=$(sfLi).find('[rowId="'+errArr[i]+'"]').find('li[linkname="'+fldLinkName+'"]');showIndUniqueError($(errorLi),sfLinkName,$(sfLi))}previousErrorArr.push(errArr[i])}}else if(removeError){removeErrorFromLiElem($(thisElem));var errorIdd=ZFLive.errorId($(thisElem).attr("compname"));$(errorIdd).removeClass("rangeError").removeClass("warningMessage")}}function showIndUniqueError(thisElem,sfFldLinkName,sfLi){var compName=$(thisElem).attr("compname"),errorComp=$(thisElem).find(ZFLive.errorId(compName));if($(errorComp).text(i18n.sfuniquecheckerr),$(errorComp).addClass("warningMessage"),animateErrorMsg_250(errorComp),"2"==$(sfLi).attr("viewtype")){var thisSfUl=$(thisElem).closest('ul[elname="subFormFieldsUl"]'),rowId=$(thisSfUl).attr("rowid"),cardDiv=$(sfLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]');1!=$(cardDiv).length||$(cardDiv).find('[elname="sfCardInnerElem"]').hasClass("sfCardError")||$(cardDiv).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),$(sfLi).find("p#error-"+sfFldLinkName).text(i18n.sfcombineduniquecheckerr),animateErrorMsg_250($(sfLi).find("p#error-"+sfFldLinkName))}}function showIndUniqueErrorOnFinalValidation(thisElem,sfFldLinkName,sfLi,applyErrorClass){var compName=$(thisElem).attr("compname"),errorComp=$(thisElem).find(ZFLive.errorId(compName));$(errorComp).text(i18n.sfuniquecheckerr),animateErrorMsg_250(errorComp),applyErrorClass?($(thisElem).addClass("error"),ZFLive.changeErrArray(compName)):$(errorComp).addClass("warningMessage"),"undefined"==typeof ZFLive.sfUniqueValidator[sfFldLinkName]&&(ZFLive.sfUniqueValidator[sfFldLinkName]={});var fldLinkName=$(thisElem).attr("linkname");"undefined"==typeof ZFLive.sfUniqueValidator[sfFldLinkName][fldLinkName]&&(ZFLive.sfUniqueValidator[sfFldLinkName][fldLinkName]=[]);var errArr=ZFLive.sfUniqueValidator[sfFldLinkName][fldLinkName],thisSfUl=$(thisElem).closest('ul[elname="subFormFieldsUl"]'),thisRowId=$(thisSfUl).attr("rowid");if(-1==$.inArray(thisRowId,errArr)&&ZFLive.sfUniqueValidator[sfFldLinkName][fldLinkName].push(thisRowId),"2"==$(sfLi).attr("viewtype")){thisSfUl=$(thisElem).closest('ul[elname="subFormFieldsUl"]');var rowId=$(thisSfUl).attr("rowid"),cardDiv=$(sfLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]');1!=$(cardDiv).length||$(cardDiv).find('[elname="sfCardInnerElem"]').hasClass("sfCardError")||$(cardDiv).find('[elname="sfCardInnerElem"]').addClass("sfCardError"),$(sfLi).find("p#error-"+sfFldLinkName).text(i18n.subformcarderrgeneral),animateErrorMsg_250($(sfLi).find("p#error-"+sfFldLinkName))}}function removeIndUniqueError(thisElem,sfFldLinkName,sfLi,removeError){if(removeError){var compName=$(thisElem).attr("compname");$(thisElem).find(ZFLive.errorId(compName)).removeClass("warningMessage").hide(),$(thisElem).hasClass("error")&&$(thisElem).removeClass("error")}if("2"==$(sfLi).attr("viewtype")){var thisSfUl=$(thisElem).closest('ul[elname="subFormFieldsUl"]'),rowId=$(thisSfUl).attr("rowid"),cardDiv=$(sfLi).find('[elname="sfcardelem"][cardrowid="'+rowId+'"]');if(1==$(cardDiv).length&&$(cardDiv).find('[elname="sfCardInnerElem"]').hasClass("sfCardError")){var uniqueFlds=ZFLive.sfUniqueJson[sfFldLinkName].fields,thisSfUniqueError=ZFLive.sfUniqueValidator[sfFldLinkName],removeCardErr=!0;if(void 0!==uniqueFlds&&uniqueFlds.length>0&&void 0!==thisSfUniqueError)for(var i=0;i<uniqueFlds.length;i++){var fldLinkName=uniqueFlds[i];if("undefined"!=typeof thisSfUniqueError[fldLinkName]&&thisSfUniqueError[fldLinkName].length>0&&$.inArray(rowId,thisSfUniqueError[fldLinkName])>-1){removeCardErr=!1;break}}removeCardErr&&($(cardDiv).find('[elname="sfCardInnerElem"]').removeClass("sfCardError"),0==$(sfLi).find('[elname="sfCardInnerElem"].sfCardError').length&&$(sfLi).children("p[elname=error]").hide())}}}function validateSFUniqueOnReConf(elem,isValid){var linkname=$(elem).attr("linkname");if("undefined"!=typeof ZFLive.sfUniqueJson&&!$.isEmptyObject(ZFLive.sfUniqueJson)){var sfLi,sfPopUp=$(elem).closest("#subFormPopUp");if($(sfPopUp).length>0){var sfLinkName=$(sfPopUp).attr("linkname");sfLi=$('li[compname="'+sfLinkName+'"]')}else sfLi=$(elem).closest('li[elemtype="subFormField"]');var sfFldLinkName=$(sfLi).attr("linkname");if("undefined"!=typeof ZFLive.sfUniqueJson[sfFldLinkName]){var thisSfUniqueJson=ZFLive.sfUniqueJson[sfFldLinkName],uniqueFields=thisSfUniqueJson.fields;if($.inArray(linkname,uniqueFields)>-1)if(isValid)2==thisSfUniqueJson.unique_type?validateSfCombUnique(uniqueFields,elem,sfLi,!1):1==thisSfUniqueJson.unique_type&&validateSfIndUnique(elem,sfLi,!1);else{2==thisSfUniqueJson.unique_type?setSFCombinedUniqueError([],sfLi,sfFldLinkName,linkname,elem,!0):1==thisSfUniqueJson.unique_type&&setSFIndUniqueError([],sfLi,sfFldLinkName,linkname,elem,!0)}}}}ZFCrmLive.prototype.getAndLoadCrmEntriesInSelectBox=function(searchIconElem){var zohoCrmSearchWrapperDiv=$(searchIconElem).closest('div[elname="zoho-crm-search-wrapper-div"]'),searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]'),searchKey=$.trim($(searchTextElem).val()),zohoCrmFldLiElem=$(zohoCrmSearchWrapperDiv).closest('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),entryListingDiv=$('div[elname="crm-entry-listing-div"]'),errEntryParaTag=$(entryListingDiv).find('p[elname="err-entry"]');$(entryListingDiv).hide();var entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');if($(entryULElem).empty(),searchKey.length>=2){if(this.processSearch){this.processSearch=!1,this.displaySearchingInteractionsForZohoCrmField(zohoCrmSearchWrapperDiv);var zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),ajaxOpts={URI:"/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/field/"+zohoCrmFldLinkName+"/searchcrmentries?"+ParamKey.SEARCH_KEY+"="+encodeURIComponent(searchKey),METHOD:ZFHttp.GET,CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($(errEntryParaTag).hide(),200===jqXhr.status){var entriesRespJsonArr=JSON.parse(jqXhr.responseText),entriesSummaryRespJsonArr=entriesRespJsonArr[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_SUMMARY];ZFCrmLive.zfCrmLive.loadCrmEntriesInSelectBox(entriesSummaryRespJsonArr,entryListingDiv);var entriesDetailsRespJson=entriesRespJsonArr[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_DETAILS];ZFCrmLive.zfCrmLive.storeEntriesDetailsInJson(zohoCrmFldLinkName,entriesDetailsRespJson)}else $(errEntryParaTag).text(i18n.zohocrmnoentries),animateErrorMsg(errEntryParaTag);ZFCrmLive.zfCrmLive.setDropdownPosition(zohoCrmSearchWrapperDiv,searchTextElem,entryListingDiv),$(entryListingDiv).show(),ZFCrmLive.zfCrmLive.processSearch=!0,ZFCrmLive.zfCrmLive.hideSearchingInteractionsForZohoCrmField(zohoCrmSearchWrapperDiv)}};ZFUtil.sendAjax(ajaxOpts,this)}}else ZFCrmLive.zfCrmLive.setDropdownPosition(zohoCrmSearchWrapperDiv,searchTextElem,entryListingDiv),$(errEntryParaTag).text(i18n.zohocrmmintwochars),animateErrorMsg(errEntryParaTag),$(entryListingDiv).show()},ZFCrmLive.prototype.setDropdownPosition=function(zohoCrmSearchWrapperDiv,searchTextElem,entryListingDiv){var searchWrapTop,searchWrapHeight;$(entryListingDiv).css("width",$(searchTextElem).width()+73),searchWrapTop=$(zohoCrmSearchWrapperDiv).offset().top,searchWrapHeight=$(zohoCrmSearchWrapperDiv).height(),$(entryListingDiv).css("top",searchWrapTop+searchWrapHeight),$(entryListingDiv).css("left",$(searchTextElem).offset().left)},ZFCrmLive.prototype.displaySearchingInteractionsForZohoCrmField=function(zohoCrmSearchWrapperDiv){var searchIconElem=$(zohoCrmSearchWrapperDiv).find('span[elname="search-icon"]');$(searchIconElem).hide();var loadingSpan=$(zohoCrmSearchWrapperDiv).find('span[elname="loading-icon"]');$(loadingSpan).css("display","inline-block")},ZFCrmLive.prototype.hideSearchingInteractionsForZohoCrmField=function(zohoCrmSearchWrapperDiv){var loadingSpan=$(zohoCrmSearchWrapperDiv).find('span[elname="loading-icon"]');$(loadingSpan).hide();var searchIconElem=$(zohoCrmSearchWrapperDiv).find('span[elname="search-icon"]');$(searchIconElem).css("display","inline-block")},ZFCrmLive.prototype.loadCrmEntriesInSelectBox=function(entriesSummaryRespJsonArr,entryListingDiv){var entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');if(0===entriesSummaryRespJsonArr.length){var errEntryParaTag=$(entryListingDiv).find('p[elname="err-entry"]');$(errEntryParaTag).text(i18n.zohocrmnoentries),animateErrorMsg(errEntryParaTag)}else{for(var entryULElemToBeCloned=$(entryListingDiv).find('ul[elname="entry-ul-clone"]'),entryLiElemToBeCloned=$(entryULElemToBeCloned).find('li[elname="entry-li-clone"]'),entryInd=0;entryInd<entriesSummaryRespJsonArr.length;entryInd++){var entrySummaryJson=entriesSummaryRespJsonArr[entryInd];this.addEntryLiElem(entrySummaryJson,entryLiElemToBeCloned,entryULElem)}ZFUtil.highLightLI($(entryULElem).find("li:first"))}},ZFCrmLive.prototype.addEntryLiElem=function(entrySummaryJson,entryLiElemToBeCloned,entryULElem){for(var entryId in entrySummaryJson){var primaryFldValue=entrySummaryJson[entryId],clonedEntryLiElem=$(entryLiElemToBeCloned).clone();$(clonedEntryLiElem).attr("elname","entry-li"),$(clonedEntryLiElem).attr("entry_id",entryId),$(clonedEntryLiElem).text(primaryFldValue),primaryFldValue.length>ZFCharLimit.TRIMMED_DISP_NAME_LIMIT&&$(clonedEntryLiElem).attr("title",primaryFldValue),$(entryULElem).append(clonedEntryLiElem)}},ZFCrmLive.prototype.storeEntriesDetailsInJson=function(zohoCrmFldLinkName,entriesDetailsRespJson){this.zohoCrmFieldEntriesDetailsJson[zohoCrmFldLinkName]=entriesDetailsRespJson},ZFCrmLive.prototype.selectCrmEntry=function(entryLiElem){this.showSelCrmEntry(entryLiElem);var zohoCrmFldLiElem=$("#formBodyDiv").find('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]'),searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]');$(searchTextElem).val(""),$(zohoCrmSearchWrapperDiv).hide();var entryListingDiv=$(entryLiElem).closest('div[elname="crm-entry-listing-div"]'),entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');$(entryULElem).empty(),$(entryListingDiv).hide(),this.fillMappedDetails(zohoCrmFldLiElem)},ZFCrmLive.prototype.showSelCrmEntry=function(entryLiElem){var zohoCrmFldLiElem=$("#formBodyDiv").find('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');$(zohoCrmFldLiElem).addClass("disabled");var zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(entryLiElem).attr("entry_id"),selCrmEntryValue=$(entryLiElem).text();$(displayTextElem).attr("entry_id",selCrmEntryId),$(displayTextElem).val(selCrmEntryValue),selCrmEntryValue.length>ZFCharLimit.TRIMMED_DISP_NAME_LIMIT&&$(displayTextElem).attr("title",selCrmEntryValue),$(zohoCrmDisplayWrapperDiv).show()},ZFCrmLive.prototype.fillMappedDetails=function(zohoCrmFldLiElem){var zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(displayTextElem).attr("entry_id"),zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),entryDetailsJson=this.zohoCrmFieldEntriesDetailsJson[zohoCrmFldLinkName][selCrmEntryId],zohoCrmFieldDetailsJson=this.zohoCrmFieldPropsJson[zohoCrmFldLinkName],mappingDetailsJson=zohoCrmFieldDetailsJson[ZohoCrmFieldLiveConstants.RESP_KEYS.MAPPING_DETAILS],dataTypeDetailsJson=zohoCrmFieldDetailsJson[ZohoCrmFieldLiveConstants.RESP_KEYS.DATA_TYPE_DETAILS],evalFormula=[],formulaFldsArr=[];for(var mappingFormCompLabelName in null!=ZFLive.formulaFieldsList&&(formulaFldsArr=JSON.parse(ZFLive.formulaFieldsList)),mappingDetailsJson){var mappingCrmFieldApiName=mappingDetailsJson[mappingFormCompLabelName],mappingCrmFieldDataType=dataTypeDetailsJson[mappingCrmFieldApiName],fldLiElem=this.getLiveFldLiElem(mappingFormCompLabelName);this.getAndFillCrmDetailsInFormFields(mappingCrmFieldApiName,mappingCrmFieldDataType,fldLiElem,mappingFormCompLabelName,entryDetailsJson),-1!=$.inArray(mappingFormCompLabelName,formulaFldsArr)&&evalFormula.push(mappingFormCompLabelName)}if(evalFormula.length>0&&ZFLive.mode!=undefined&&evalFormulaOnCrmPrefill(evalFormula),null!=ZFLive.paymentMerchantList){var paymentDiv=$("#test").find("div[elname=merchantDiv]"),selectedMerchantType=$(paymentDiv).attr("merchantType");if(null!=selectedMerchantType&&""!=selectedMerchantType){var pymntType=$(paymentDiv).attr("paymenttype");if(pymntType==ZFFormPayments.PAYMENT_TYPE.DONATION){var selectedMerchantDiv=$(paymentDiv).find("a[merchanttype="+selectedMerchantType+"]"),dispAmnt=$.trim($(selectedMerchantDiv).attr("dispamnt"));""!=dispAmnt?ZFLive.changeValueInPayment(selectedMerchantType,pymntType,dispAmnt):ZFLive.changeValueInPayment(selectedMerchantType,pymntType)}else ZFLive.changeValueInPayment(selectedMerchantType,pymntType)}}},ZFCrmLive.prototype.getLiveFldLiElem=function(formCompLabelName){var formElemLinkName,indexOfUSInFormCompLabelName=formCompLabelName.indexOf("_");return formElemLinkName=-1!==indexOfUSInFormCompLabelName?formCompLabelName.substring(0,indexOfUSInFormCompLabelName):formCompLabelName,$(this.formBodyDiv).find('li[elname="livefield-elem"][compname="'+formElemLinkName+'"]')},ZFCrmLive.prototype.getAndFillCrmDetailsInFormFields=function(crmFieldApiName,crmFieldDataType,fldLiElem,formCompLabelName,entryDetailsJson){if(crmFieldDataType===CrmDataTypes.TEXT||crmFieldDataType===CrmDataTypes.TEXTAREA||crmFieldDataType===CrmDataTypes.EMAIL||crmFieldDataType===CrmDataTypes.PHONE||crmFieldDataType===CrmDataTypes.PICKLIST||crmFieldDataType===CrmDataTypes.BIGINT||crmFieldDataType===CrmDataTypes.WEBSITE||crmFieldDataType===CrmDataTypes.AUTONUMBER||crmFieldDataType===CrmDataTypes.CURRENCY||crmFieldDataType===CrmDataTypes.DOUBLE||crmFieldDataType===CrmDataTypes.DATE||crmFieldDataType===CrmDataTypes.DATETIME||crmFieldDataType===CrmDataTypes.INTEGER){var stringCrmEntryValue=this.getStringCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillStringCrmEntryValue(fldLiElem,formCompLabelName,stringCrmEntryValue),setValueInFldLabel(formCompLabelName,stringCrmEntryValue)}else if(crmFieldDataType===CrmDataTypes.MULTISELECT){var jsonArrCrmEntryValue=this.getJsonArrCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillJsonArrCrmEntryValue(fldLiElem,formCompLabelName,jsonArrCrmEntryValue)}else if(crmFieldDataType===CrmDataTypes.BOOLEAN){var boolCrmEntryValue=this.getBoolCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillBoolCrmEntryValue(fldLiElem,formCompLabelName,boolCrmEntryValue)}else if(crmFieldDataType===CrmDataTypes.LOOKUP||crmFieldDataType===CrmDataTypes.OWNER_LOOKUP){stringCrmEntryValue=this.getLookupStringCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillStringCrmEntryValue(fldLiElem,formCompLabelName,stringCrmEntryValue),setValueInFldLabel(formCompLabelName,stringCrmEntryValue)}evalRulesAfterCrmPrefill(fldLiElem,formCompLabelName)},ZFCrmLive.prototype.getStringCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var stringCrmEntryValue=entryDetailsJson[crmFieldApiName];return typeof stringCrmEntryValue!==ResponseKey.UNDEFINED?stringCrmEntryValue:""},ZFCrmLive.prototype.fillStringCrmEntryValue=function(fldLiElem,formCompLabelName,stringCrmEntryValue){switch(parseInt($(fldLiElem).attr("comptype"))){case ZFFieldTypeConstants.SINGLE_LINE:this.fillSingleLineFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.NAME:this.fillNameFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.ADDRESS:this.fillAddressFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.DROPDOWN:this.fillDropdownFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.RADIO:this.fillRadioFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.MATRIX_CHOICE:this.fillMatrixChoiceFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.IMAGE_CHOICE:this.fillImgChoiceFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.MULTI_LINE:this.fillMultiLineFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.EMAIL:this.fillEmailFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.PHONE:this.fillPhoneFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.NUMBER:this.fillNumberFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.SLIDER:this.fillSliderFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.RATING:this.fillRatingFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.WEBSITE:this.fillWebsiteFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.CURRENCY:this.fillCurrencyFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.DECIMAL:this.fillDecimalFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.DATE:this.fillDateFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.DATETIME:this.fillDateTimeFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.CHECKBOX:this.fillCBFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.MULTIPLE_CHOICE:this.fillMCFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue)}},ZFCrmLive.prototype.fillSingleLineFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillNameFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){-1==formCompLabelName.indexOf(ZFFormField.NAME.SALUTATION.KEY)?$(fldLiElem).find(':text[complink="'+formCompLabelName+'"]').val(stringCrmEntryValue):this.fillNameAndAddComplinkFormField(fldLiElem,formCompLabelName,stringCrmEntryValue)},ZFCrmLive.prototype.fillAddressFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){-1!==formCompLabelName.indexOf(ZFFormField.ADDRESS.COUNTRY.KEY)?this.fillNameAndAddComplinkFormField(fldLiElem,formCompLabelName,stringCrmEntryValue):$(fldLiElem).find(':text[complink="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDropdownFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var dropDownElem=$(fldLiElem).find('select[name="'+formCompLabelName+'"]');$(dropDownElem).find('option[value="'+stringCrmEntryValue+'"]').length>0?$(dropDownElem).val(stringCrmEntryValue):$(dropDownElem).val("-Select-")},ZFCrmLive.prototype.fillNameAndAddComplinkFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var dropDownElem=$(fldLiElem).find('select[complink="'+formCompLabelName+'"]');$(dropDownElem).find('option[value="'+stringCrmEntryValue+'"]').length>0?$(dropDownElem).val(stringCrmEntryValue):$(dropDownElem).val("-Select-")},ZFCrmLive.prototype.fillRadioFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var radioElems=$(fldLiElem).find(':radio[elname="'+formCompLabelName+'"]');$(radioElems).prop("checked",!1);var othersSpan=$(fldLiElem).find('span[elname="allow-others-span"]');if(0!==$(othersSpan).length&&($(othersSpan).find(':text[name="allow-others-text"]').val(""),$(othersSpan).find(':radio[elname="radio-input"]').prop("checked",!1)),""!==stringCrmEntryValue){var attrName=ElementAttributes.VALUE,selectedRadioElem=ZFUtil.getSelectedChoiceElem(radioElems,attrName,stringCrmEntryValue);typeof selectedRadioElem===ResponseKey.UNDEFINED?0!==$(othersSpan).length&&($(othersSpan).find(':text[name="allow-others-text"]').val(stringCrmEntryValue),$(othersSpan).find(':radio[elname="radio-input"]').prop("checked",!0)):$(selectedRadioElem).prop("checked",!0)}},ZFCrmLive.prototype.fillMatrixChoiceFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var matrixChoiceType=parseInt($(fldLiElem).attr("choicetype"));if(matrixChoiceType===MatrixChoicesType.RADIO.CODE||matrixChoiceType===MatrixChoicesType.CHECKBOX.CODE){var choiceElems=$(fldLiElem).find(":"+ZFUtil.getMatrixChoiceTypeString(matrixChoiceType)+'[name="'+formCompLabelName+'"]');$(choiceElems).prop("checked",!1),""!==stringCrmEntryValue&&this.tickMatrixChoice(choiceElems,stringCrmEntryValue)}},ZFCrmLive.prototype.tickMatrixChoice=function(choiceElems,selectedChoiceValue){var attrName=ElementAttributes.COL_VALUE,selectedChoiceElem=ZFUtil.getSelectedChoiceElem(choiceElems,attrName,selectedChoiceValue);return typeof selectedChoiceElem!==ResponseKey.UNDEFINED&&($(selectedChoiceElem).prop("checked",!0),!0)},ZFCrmLive.prototype.fillImgChoiceFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var imgChoiceDiv=$(fldLiElem).find('div[elname="imageChoiceEle"]'),imgChoiceType=$(imgChoiceDiv).attr("choicetype");if(imgChoiceType===ImageChoicesType.RADIO||imgChoiceType===ImageChoicesType.CHECKBOX){var tickedChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"][prevVal="'+BooleanConstants.TRUE+'"]');$(tickedChoiceElems).each(function(choiceElemInd,tickedChoiceElem){ZFLive.selectImage(tickedChoiceElem)});var imgChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"]');this.tickImgChoice(imgChoiceElems,stringCrmEntryValue)}else if(imgChoiceType===ImageChoicesType.IMG_PICKER){var tickedChoiceDivs=$(imgChoiceDiv).find('div[name="selectDiv"][selected="selected"]');$(tickedChoiceDivs).each(function(choiceDivInd,tickedChoiceDiv){ZFLive.selectImage(tickedChoiceDiv)});imgChoiceElems=$(imgChoiceDiv).find('div[name="selectDiv"]');this.tickImgChoice(imgChoiceElems,stringCrmEntryValue)}},ZFCrmLive.prototype.tickImgChoice=function(imgChoiceElems,stringCrmEntryValue){var attrName=ElementAttributes.VALUE,selectedChoiceDiv=ZFUtil.getSelectedChoiceElem(imgChoiceElems,attrName,stringCrmEntryValue);return 0!==$(selectedChoiceDiv).length&&(ZFLive.selectImage(selectedChoiceDiv),!0)},ZFCrmLive.prototype.fillMultiLineFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){$(fldLiElem).find('textarea[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillEmailFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.isValidMailId(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillPhoneFormField=function(fldLiElem,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||this.validatePhone(stringCrmEntryValue)||(stringCrmEntryValue="");var phoneFormat=$(fldLiElem).find('div[elname="phoneFormatElem"]').attr("phoneFormat");if(phoneFormat===ZFPhoneFormatConstants.INTERNATIONAL){var inpTextElem=$(fldLiElem).find("div[elname=phoneFld]").find(':text[elname="countrycode"]');"true"==$(inpTextElem).attr("iscodeenabled")?$(inpTextElem).intlTelInput("setNumber",stringCrmEntryValue):$(inpTextElem).val(stringCrmEntryValue)}else if(phoneFormat===ZFPhoneFormatConstants.USAFORMAT){var splittedPhoneNum1="",splittedPhoneNum2="",splittedPhoneNum3="";stringCrmEntryValue.length>6?(splittedPhoneNum1=stringCrmEntryValue.substring(0,3),splittedPhoneNum2=stringCrmEntryValue.substring(3,6),splittedPhoneNum3=stringCrmEntryValue.substring(6,stringCrmEntryValue.length)):stringCrmEntryValue.length>3&&(splittedPhoneNum1=stringCrmEntryValue.substring(0,3),splittedPhoneNum2=stringCrmEntryValue.substring(3,stringCrmEntryValue.length));var phoneFldMainDiv=$(fldLiElem).find("div[elname=phoneFld]");$(phoneFldMainDiv).find(':text[elname="countrycode"]').val(splittedPhoneNum1),$(phoneFldMainDiv).find(':text[elname="first"]').val(splittedPhoneNum2),$(phoneFldMainDiv).find(':text[elname="second"]').val(splittedPhoneNum3)}},ZFCrmLive.prototype.validatePhone=function(val){if(val.length<5||val.length>20||getNumberOfDigitsInString($.trim(val))>15)return!1;return!(""!=$.trim(val)&&!/^[+]{0,1}[()0-9- ]+$/.test(val))},ZFCrmLive.prototype.fillNumberFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateNumber(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillPaymentFormField=function(fldLiElem,formElemLinkName,stringCrmEntryValue){var merchantDivElem=$(fldLiElem).find('div[elname="merchantDiv"]');if(parseInt($(merchantDivElem).attr("paymentType"))===ZFFormPayments.PAYMENT_TYPE.DONATION){var paymentDetailsDivElem=$(fldLiElem).find('div[elname="paymentDetailsDiv"]');$(paymentDetailsDivElem).find(':text[name="'+formElemLinkName+'"]').val(stringCrmEntryValue)}},ZFCrmLive.prototype.fillSliderFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var sliderMin=$(fldLiElem).find("#sld-"+formCompLabelName).slider("option","min"),sliderMax=$(fldLiElem).find("#sld-"+formCompLabelName).slider("option","max");ZFUtil.isValidNumWithinRange(sliderMin,sliderMax,stringCrmEntryValue)||(stringCrmEntryValue=""),this.fillSliderFormFieldWithoutValidation(fldLiElem,formCompLabelName,stringCrmEntryValue)},ZFCrmLive.prototype.fillSliderFormFieldWithoutValidation=function(fldLiElem,formCompLabelName,stringCrmEntryValue){$(fldLiElem).find("#amount-"+formCompLabelName).attr("value",stringCrmEntryValue);var sliderDiv=$(fldLiElem).find("#sld-"+formCompLabelName),sliderAmountDiv=$(sliderDiv).find("#slid_"+formCompLabelName+"_Div");""===stringCrmEntryValue?$(sliderAmountDiv).hide():$(sliderAmountDiv).show(),$(sliderDiv).slider("value",stringCrmEntryValue),$(sliderAmountDiv).find("#slid-"+formCompLabelName).text(stringCrmEntryValue)},ZFCrmLive.prototype.fillRatingFormField=function(fldLiElem,stringCrmEntryValue){var totalRatingCount=parseInt($(fldLiElem).find('em[elname="total_rating_count"]').text());ZFUtil.isValidNumWithinRange(1,totalRatingCount,stringCrmEntryValue)||(stringCrmEntryValue=""),this.fillRatingFormFieldWithoutVaidation($(fldLiElem),stringCrmEntryValue)},ZFCrmLive.prototype.fillRatingFormFieldWithoutVaidation=function(fldLiElem,stringCrmEntryValue){if(""===stringCrmEntryValue)$(fldLiElem).find('span[elname="refresh-rating-span"]').click();else{var ratingInt=parseInt(stringCrmEntryValue);$(fldLiElem).find('a[rating_value="'+ratingInt+'"]').click().mouseout()}},ZFCrmLive.prototype.fillWebsiteFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateLiveUrl(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillCurrencyFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateCurrency(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDecimalFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateDecimal(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDateFormField=function(fldLiElem,stringCrmEntryValue){$(fldLiElem).find(':text[elname="date"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDateTimeFormField=function(fldLiElem,stringCrmEntryValue){var timeFormat=parseInt($(fldLiElem).attr("timeformat")),dateFormat=$("#zf_date_format").val(),dateLocale=$("#zf_date_format").attr("dateLocale");timeFormat==TimeFormat.HOURS_24.CODE&&ZFUtil.validateDateTime(stringCrmEntryValue,dateFormat,dateLocale,TimeFormat.HOURS_12.CODE)&&(stringCrmEntryValue=ZFUtil.convertDateTimeValToTimeFormat(stringCrmEntryValue,dateFormat,dateLocale,TimeFormat.HOURS_12.CODE,timeFormat)),$(fldLiElem).find(':text[elname="dateTime"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillCBFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var cbElems=$(fldLiElem).find(':checkbox[elname="'+formCompLabelName+'"]');$(cbElems).prop("checked",!1),""!==stringCrmEntryValue&&this.tickCBChoice(cbElems,stringCrmEntryValue)},ZFCrmLive.prototype.tickCBChoice=function(cbElems,selectedChoiceValue){var attrName=ElementAttributes.VALUE,selectedCBElem=ZFUtil.getSelectedChoiceElem(cbElems,attrName,selectedChoiceValue);typeof selectedCBElem!==ResponseKey.UNDEFINED&&$(selectedCBElem).prop("checked",!0)},ZFCrmLive.prototype.fillMCFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var selectElem=$(fldLiElem).find('select[name="'+formCompLabelName+'"]');if($(selectElem).val(""),""!==stringCrmEntryValue){var optionElems=$(selectElem).find("option");this.tickMCChoice(optionElems,stringCrmEntryValue)}},ZFCrmLive.prototype.tickMCChoice=function(optionElems,selectedChoiceValue){var attrName=ElementAttributes.VALUE,selectedOptionElem=ZFUtil.getSelectedChoiceElem(optionElems,attrName,selectedChoiceValue);typeof selectedOptionElem!==ResponseKey.UNDEFINED&&$(selectedOptionElem).attr("selected",!0)},ZFCrmLive.prototype.getJsonArrCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var jsonArrCrmEntryValue=entryDetailsJson[crmFieldApiName];return typeof jsonArrCrmEntryValue===ResponseKey.UNDEFINED&&(jsonArrCrmEntryValue=[]),jsonArrCrmEntryValue},ZFCrmLive.prototype.fillJsonArrCrmEntryValue=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){switch(parseInt($(fldLiElem).attr("comptype"))){case ZFFieldTypeConstants.CHECKBOX:this.fillCBFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue);break;case ZFFieldTypeConstants.MULTIPLE_CHOICE:this.fillMCFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue);break;case ZFFieldTypeConstants.MATRIX_CHOICE:this.fillMatrixChoiceFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue);break;case ZFFieldTypeConstants.IMAGE_CHOICE:this.fillImgChoiceFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue)}},ZFCrmLive.prototype.fillCBFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var cbElems=$(fldLiElem).find(':checkbox[elname="'+formCompLabelName+'"]');$(cbElems).prop("checked",!1);for(var arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickCBChoice(cbElems,selectedChoiceValue)}},ZFCrmLive.prototype.fillMCFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){$(fldLiElem).find('select[name="'+formCompLabelName+'"]').val(jsonArrCrmEntryValue)},ZFCrmLive.prototype.fillMatrixChoiceFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var matrixChoiceType=parseInt($(fldLiElem).attr("choicetype")),choiceElems=$(fldLiElem).find(":"+ZFUtil.getMatrixChoiceTypeString(matrixChoiceType)+'[name="'+formCompLabelName+'"]');if($(choiceElems).prop("checked",!1),matrixChoiceType===MatrixChoicesType.RADIO.CODE)for(var foundChoice=!1,arrInd=0;arrInd<jsonArrCrmEntryValue.length&&!foundChoice;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];foundChoice=this.tickMatrixChoice(choiceElems,selectedChoiceValue)}else if(matrixChoiceType===MatrixChoicesType.CHECKBOX.CODE)for(arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickMatrixChoice(choiceElems,selectedChoiceValue)}},ZFCrmLive.prototype.fillImgChoiceFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var imgChoiceDiv=$(fldLiElem).find('div[elname="imageChoiceEle"]'),imgChoiceType=$(imgChoiceDiv).attr("choicetype");if(imgChoiceType===ImageChoicesType.RADIO||imgChoiceType===ImageChoicesType.CHECKBOX){var tickedChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"][prevVal="'+BooleanConstants.TRUE+'"]');$(tickedChoiceElems).each(function(choiceElemInd,tickedChoiceElem){ZFLive.selectImage(tickedChoiceElem)});var imgChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"]');if(imgChoiceType===ImageChoicesType.RADIO)for(var foundChoice=!1,arrInd=0;arrInd<jsonArrCrmEntryValue.length&&!foundChoice;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];foundChoice=this.tickImgChoice(imgChoiceElems,selectedChoiceValue)}else if(imgChoiceType===ImageChoicesType.CHECKBOX)for(arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickImgChoice(imgChoiceElems,selectedChoiceValue)}}else if(imgChoiceType===ImageChoicesType.IMG_PICKER){var tickedChoiceDivs=$(imgChoiceDiv).find('div[name="selectDiv"][selected="selected"]');$(tickedChoiceDivs).each(function(choiceDivInd,tickedChoiceDiv){ZFLive.selectImage(tickedChoiceDiv)});for(imgChoiceElems=$(imgChoiceDiv).find('div[name="selectDiv"]'),arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickImgChoice(imgChoiceElems,selectedChoiceValue)}}},ZFCrmLive.prototype.getBoolCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var boolCrmEntryValue=entryDetailsJson[crmFieldApiName];return typeof boolCrmEntryValue===ResponseKey.UNDEFINED&&(boolCrmEntryValue=!1),boolCrmEntryValue},ZFCrmLive.prototype.fillBoolCrmEntryValue=function(fldLiElem,formCompLabelName,boolCrmEntryValue){switch(parseInt($(fldLiElem).attr("comptype"))){case ZFFieldTypeConstants.DECISION_BOX:this.fillDecBoxFormField(fldLiElem,formCompLabelName,boolCrmEntryValue)}},ZFCrmLive.prototype.fillDecBoxFormField=function(fldLiElem,formCompLabelName,boolCrmEntryValue){var decBoxElem=$(fldLiElem).find(':checkbox[name="'+formCompLabelName+'"]');$(decBoxElem).prop("checked",!1),boolCrmEntryValue&&$(decBoxElem).prop("checked",!0)},ZFCrmLive.prototype.getLookupStringCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var lookupJson=entryDetailsJson[crmFieldApiName];return typeof lookupJson===ResponseKey.UNDEFINED?"":lookupJson[ZohoCrmFieldLiveConstants.CRM_PROPS.NAME]},ZFCrmLive.prototype.checkMandatoryZohoCrmFld=function(zohoCrmFldLiElem){var zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]');return""!==$(displayTextElem).attr("entry_id")},ZFCrmLive.prototype.constructZohoCrmFldDataJson=function(valueJson,zohoCrmFldLiElem,checkForParentLookUpDetails){var zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(displayTextElem).attr("entry_id"),selCrmEntryValue=$(displayTextElem).val(),zohoCrmFldDataJson={};if(""!==selCrmEntryId){zohoCrmFldDataJson[ZohoCrmFieldLiveConstants.REQ_KEYS.ID]=selCrmEntryId,zohoCrmFldDataJson[ZohoCrmFieldLiveConstants.CRM_PROPS.NAME]=selCrmEntryValue;var selCrmParentLookupDetailsJson={},foundCrmParentLookupDetailsJson=!1;if(checkForParentLookUpDetails){var selCrmParentLookupDetailsJsonInString=$(displayTextElem).attr(ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS);""!==selCrmParentLookupDetailsJsonInString&&(selCrmParentLookupDetailsJson=JSON.parse(selCrmParentLookupDetailsJsonInString),foundCrmParentLookupDetailsJson=!0)}if(!foundCrmParentLookupDetailsJson){var entryDetailsJson=this.zohoCrmFieldEntriesDetailsJson[zohoCrmFldLinkName][selCrmEntryId],parentLookupDetailsJson=this.zohoCrmFieldPropsJson[zohoCrmFldLinkName][ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS];for(var lookupModuleApiName in parentLookupDetailsJson){var selLookupJson=entryDetailsJson[parentLookupDetailsJson[lookupModuleApiName]];if(typeof selLookupJson!==ResponseKey.UNDEFINED){var idInSelLookupJson=selLookupJson[ZohoCrmFieldLiveConstants.REQ_KEYS.ID];selCrmParentLookupDetailsJson[lookupModuleApiName]=idInSelLookupJson}}}zohoCrmFldDataJson[ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS]=selCrmParentLookupDetailsJson}valueJson[zohoCrmFldLinkName]=zohoCrmFldDataJson},ZFCrmLive.prototype.removeCrmEntry=function(delIcon){var zohoCrmDisplayWrapperDiv=$(delIcon).closest('div[elname="zoho-crm-display-wrapper-div"]'),zohoCrmFldLiElem=$(zohoCrmDisplayWrapperDiv).closest('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');$(zohoCrmFldLiElem).removeClass("disabled");var zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]');$(zohoCrmSearchWrapperDiv).show();var searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]');$(searchTextElem).focus();var displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]');$(displayTextElem).attr("entry_id",""),$(displayTextElem).val(""),$(displayTextElem).attr(ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS,""),$(displayTextElem).removeAttr("title"),$(zohoCrmDisplayWrapperDiv).hide()},ZFCrmLive.prototype.triggerKeyupInCrmSearch=function(searchTextElem,event){var zohoCrmSearchWrapperDiv=$(searchTextElem).closest('div[elname="zoho-crm-search-wrapper-div"]'),entryListingDiv=$('div[elname="crm-entry-listing-div"]'),entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]'),isNavigation=!1;if($(entryListingDiv).is(":visible")&&$(entryULElem).find("li").length>0&&(event.keyCode===ZFKeyConstants.UP?(ZFUtil.focusPrevLIElem(entryULElem),isNavigation=!0):event.keyCode===ZFKeyConstants.DOWN?(ZFUtil.focusNextLIElem(entryULElem),isNavigation=!0):event.keyCode===ZFKeyConstants.ENTER&&(this.selectCrmEntry(ZFUtil.getSelectedLI(entryULElem)),isNavigation=!0)),!isNavigation){var searchIconElem=$(zohoCrmSearchWrapperDiv).find('span[elname="search-icon"]');""===$.trim($(searchTextElem).val())?$(searchIconElem).hide():$(searchIconElem).css("display","inline-block"),$(entryULElem).empty(),$(entryListingDiv).hide(),event.keyCode===ZFKeyConstants.ENTER&&this.getAndLoadCrmEntriesInSelectBox(searchIconElem)}},ZFCrmLive.prototype.focusZohoCrmField=function(zohoCrmFldLiElem){if(!$(zohoCrmFldLiElem).hasClass("disabled")){var zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]');if($(zohoCrmSearchWrapperDiv).is(":visible")){var searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]');$(searchTextElem).focus()}}},ZFCrmLive.prototype.getCrmRecordForPublicForm=function(){if(""!==ZFCrmLive.zfCrmLive.crmEncryptedRecordId){var zohoCrmFldLiElem=$("#formBodyDiv").find('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),getCrmRecordUri="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/field/"+zohoCrmFldLinkName+"/getcrmrecord?"+ParamKey.CRM_ENTITY_ID+"="+ZFCrmLive.zfCrmLive.crmEncryptedRecordId+"&"+ParamKey.CRM_ZSOID+"="+ZFCrmLive.zfCrmLive.crmEncryptedZsoid;ZFCrmLive.zfCrmLive.crmEncryptionType!==undefined&&(getCrmRecordUri+="&"+ParamKey.CRM_ETYPE+"="+ZFCrmLive.zfCrmLive.crmEncryptionType);var ajaxOpts={URI:getCrmRecordUri,METHOD:ZFHttp.POST,CALLBACK:function(jsonData,ajaxOpts,jqXhr){if(200===jqXhr.status){var crmRecordResponseJson=JSON.parse(jqXhr.responseText);ZFCrmLive.zfCrmLive.fillCrmFieldForPublicForm(crmRecordResponseJson)}}};ZFUtil.sendAjax(ajaxOpts,this)}},ZFCrmLive.prototype.fillCrmFieldForPublicForm=function(entriesRespJson){if(Object.keys(entriesRespJson).length>0){var zohoCrmFldLiElem=$("#formBodyDiv").find('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),entriesSummaryRespJsonArr=entriesRespJson[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_SUMMARY],entriesDetailsRespJson=entriesRespJson[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_DETAILS];ZFCrmLive.zfCrmLive.storeEntriesDetailsInJson(zohoCrmFldLinkName,entriesDetailsRespJson);var primaryFldValue,crmEntryId,zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),entrySummaryJson=entriesSummaryRespJsonArr[0];for(var entryId in entrySummaryJson)crmEntryId=entryId,primaryFldValue=entrySummaryJson[entryId];$(displayTextElem).attr("entry_id",crmEntryId),$(displayTextElem).val(primaryFldValue),primaryFldValue.length>ZFCharLimit.TRIMMED_DISP_NAME_LIMIT&&$(displayTextElem).attr("title",primaryFldValue),this.fillMappedDetails(zohoCrmFldLiElem)}},$(document).click(function(event){if(typeof ZFCrmLive.zfCrmLive!==ResponseKey.UNDEFINED){var zohoCrmFldLiElem=$('li[elname="livefield-elem"][comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');if(0!==$(zohoCrmFldLiElem).length){var zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]');if(0!==$(zohoCrmSearchWrapperDiv).length){var entryListingDiv=$('div[elname="crm-entry-listing-div"]');if(0!==$(entryListingDiv).length&&$(entryListingDiv).is(":visible")&&0===$(event.target).closest('div[elname="zoho-crm-search-wrapper-div"]').length){var entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');$(entryULElem).empty(),$(entryListingDiv).hide()}}}}}),ZFLive.validateSubFormField=function(elem,addRangeErrClass){for(var validRowsArray=this.validateSubFormFieldCommonAndGetValidRows(elem),childrenCount=validRowsArray.length,sfUniqueCheckJson={},sfRowIndex=0;sfRowIndex<childrenCount;sfRowIndex++)this.loopValidSfEntryAndValidateFld(elem,validRowsArray[sfRowIndex],addRangeErrClass,sfUniqueCheckJson,validRowsArray)},ZFLive.validateSubFormFieldCommonAndGetValidRows=function(elem){var validRowsArray=this.getValidRowsInSubForm(elem),childrenCount=validRowsArray.length;return this.validateSubFormFieldEntryRange(elem,childrenCount),validRowsArray},ZFLive.getValidRowsInSubForm=function(elem){var validRowsArray=[];return $(elem).find('ul[elname="subFormFieldsUl"]').each(function(rowIndex,subFormRow){var isThisRowEmpty=!0;$(subFormRow).children('li[elname="livefield-elem"]').each(function(subFormChildIndex,subFormChildFieldElem){isThisRowEmpty&&($(subFormChildFieldElem).attr("isvisible")===BooleanConstants.TRUE&&(ZFLive.doesSFChildHasEmptyVal(subFormChildFieldElem)||(isThisRowEmpty=!1)))}),isThisRowEmpty?$(subFormRow).attr("isvalidentry",!1):($(subFormRow).attr("isvalidentry",!0),validRowsArray.push(subFormRow))}),validRowsArray},ZFLive.validateSubFormFieldEntryRange=function(elem,childrenCount){var elemLinkName=$(elem).attr("linkname");if(!ZFLive.isSaveReq){var maxEntryVal=calcMaxEntryValForThisSF($(elem)),minEntryVal=calcMinEntryValForThisSF($(elem));maxEntryVal<minEntryVal&&(maxEntryVal=minEntryVal),maxEntryVal>100&&(maxEntryVal=100),minEntryVal>100&&(minEntryVal=100),minEntryVal>childrenCount?(1==minEntryVal?$(elem).find("p#error-"+elemLinkName).text(i18n.subformentriesminlimit1).show():$(elem).find("p#error-"+elemLinkName).text(ZFUtil.replaceParams(i18n.subformentriesminlimit,minEntryVal)).show(),this.changeErrArray(elemLinkName)):maxEntryVal<childrenCount&&(1==maxEntryVal?$(elem).find("p#error-"+elemLinkName).text(i18n.subformentriesmaxlimit1).show():$(elem).find("p#error-"+elemLinkName).text(ZFUtil.replaceParams(i18n.subformentriesmaxlimit,maxEntryVal)).show(),this.changeErrArray(elemLinkName))}},ZFLive.loopValidSfEntryAndValidateFld=function(sfLi,sfRow,addRangeErrClass,sfUniqueCheckJson,validRowsArray){var initialErrorCount=ZFLive.errCnt;(sfUniqueCheckJson.isValidForCombUniq=undefined,sfUniqueCheckJson.thisentrycombval="",$(sfRow).children('li[elname="livefield-elem"]').each(function(subFormChildIndex,subFormChildFieldElem){removeErrorFromLiElem(subFormChildFieldElem),ZFLive.validateField(subFormChildFieldElem,addRangeErrClass),ZFLive.isSaveReq||validateSFUniquenessForAllFields($(sfLi),$(subFormChildFieldElem),sfUniqueCheckJson,addRangeErrClass,validRowsArray)}),ZFLive.isSaveReq||performCombinedUniqueCheckForFinalVal(sfLi,sfUniqueCheckJson,validRowsArray,sfRow,addRangeErrClass),ZFLive.errCnt>initialErrorCount)&&("2"==$(sfLi).attr("viewtype")&&($(sfLi).find('div[elname="sfcardelem"][cardrowid="'+$(sfRow).attr("rowid")+'"]').find('[elname="sfCardInnerElem"]').addClass("sfCardError"),$(sfLi).find("p#error-"+$(sfLi).attr("compname")).text(i18n.subformcarderrgeneral).show()))},ZFLive.doesSFChildHasEmptyVal=function(elem){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype"));if(compname&&""!=compname)if(comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD){var totalfiles=$("#"+compname+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;if(isIELessThan10()||isWindowSafari()){var addFUDivnew=$(elem).find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]'),file=$(addFUDivnew).find("div[elname=filePathSpan]").html();if(file=file.trim?file.trim():file.replace(/^\s+/,""),1==addFUDivnew.length&&""==file)return!0}else{var storedfiles=0;if(ZFLive.storedFiles[compname]!=undefined&&(storedfiles=Object.keys(ZFLive.storedFiles[compname]).length),totalfiles<=0&&storedfiles<=0)return!0}}else if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS){if(!doesAnyCompositeFieldHasValue(elem,comptype))return!0}else if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.SLIDER||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE){if(!checkMandatory(elem,comptype))return!0}else if(comptype==ZFFieldTypeConstants.TIME){if(!doesAnyCompInTimeHasVal(elem))return!0}else if(comptype==ZFFieldTypeConstants.MULTI_LINE){if(!checkMandatoryTextArea(elem))return!0}else if(comptype==ZFFieldTypeConstants.DROPDOWN){if(!checkMandatoryDropDown(elem,compname))return!0}else if(comptype==ZFFieldTypeConstants.RATING){if(!checkMandatoryRating(elem))return!0}else if(comptype==ZFFieldTypeConstants.RADIO){if(!checkMandatoryRadio(elem))return!0}else if(comptype==ZFFieldTypeConstants.CHECKBOX||comptype==ZFFieldTypeConstants.DECISION_BOX){if(!checkMandatoryCheckBox(elem))return!0}else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE&&!checkMandatoryMultiSelect(elem))return!0;return!1},ZFSubFormLive.prototype.constructSubFormDataJson=function(valueJson,elem){$(elem).find("ul[elname='subFormFieldsUl'][isvalidentry='true']").each(function(rowIndex,subFormRow){ZFSubFormLive.zfSubFormLive.subFormValueJson={},$(subFormRow).children('li[elname="livefield-elem"]').each(function(childIndex,childElem){var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype"));$(childElem).attr("compname");id&&ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonCommon(comptype,childElem)}),ZFSubFormLive.zfSubFormLive.subFormValueArray.push(ZFSubFormLive.zfSubFormLive.subFormValueJson)}),valueJson[$(elem).attr("compname")]=ZFSubFormLive.zfSubFormLive.subFormValueArray},ZFSubFormLive.prototype.constructSubFormDataJsonReview=function(valueJson,elem){var subFormRowValues=[],subFormRowJson={};$(elem).find("ul[elname='subFormFieldsUl'][isempty='false']").each(function(rowIndex,subFormRow){ZFSubFormLive.zfSubFormLive.subFormReviewJson={};var subFormFieldArray=[];$(subFormRow).children('li[elname="livefield-elem"][isvisible=true][needdata=true]').each(function(childIndex,childElem){ZFSubFormLive.zfSubFormLive.subFormFieldJson={};var comptype=parseInt($(childElem).attr("comptype")),compname=$.trim($(childElem).attr("compname"));ZFSubFormLive.zfSubFormLive.subFormFieldJson.display_name=$.trim($(childElem).children("label").children("span").text()),ZFSubFormLive.zfSubFormLive.subFormFieldJson.compname=compname,ZFSubFormLive.zfSubFormLive.subFormFieldJson.comptype=comptype,constructFormFieldDataJsonCommon(ZFSubFormLive.zfSubFormLive.subFormFieldJson,childElem,!0),comptype===ZFFieldTypeConstants.FORMULA&&constructNormalField(ZFSubFormLive.zfSubFormLive.subFormFieldJson,childElem),subFormFieldArray.push(ZFSubFormLive.zfSubFormLive.subFormFieldJson)}),ZFSubFormLive.zfSubFormLive.subFormReviewJson.fields=subFormFieldArray,subFormRowValues.push(ZFSubFormLive.zfSubFormLive.subFormReviewJson)}),subFormRowJson.rows=subFormRowValues,valueJson.value=subFormRowJson},ZFSubFormLive.prototype.constructBackUpDataForPopUp=function(subFormRow){ZFSubFormLive.zfSubFormLive.subFormValueJson={},$(subFormRow).children('li[elname="livefield-elem"]').each(function(childIndex,childElem){var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype")),compname=$(childElem).attr("compname"),needdata=$(childElem).attr("needdata");if(id&&"true"==needdata)if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.WEBSITE)ZFSubFormLive.zfSubFormLive.constructNormalField(childElem);else if(comptype==ZFFieldTypeConstants.MULTI_LINE)ZFSubFormLive.zfSubFormLive.constructTextArea(childElem);else if(comptype==ZFFieldTypeConstants.DATE)ZFSubFormLive.zfSubFormLive.constructDate(childElem);else if(comptype===ZFFieldTypeConstants.DATETIME)ZFSubFormLive.zfSubFormLive.constructDateTime(childElem);else if(comptype==ZFFieldTypeConstants.TIME){var actualCompName=ZFSubFormLive.zfSubFormLive.getActualCompName($(childElem).attr("compname")),hours=$(childElem).find('select[timecomp="hours"]').val(),minutes=$(childElem).find('select[timecomp="minutes"]').val(),meridian=$(childElem).find('select[timecomp="Meridiem"]').find("option:selected").attr("value"),timeVal={};timeVal.hours=hours,timeVal.minutes=minutes,typeof meridian!==undefined&&(timeVal.meridian=meridian),ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=timeVal}else if(comptype==ZFFieldTypeConstants.NAME)ZFSubFormLive.zfSubFormLive.constructName(childElem);else if(comptype==ZFFieldTypeConstants.ADDRESS)ZFSubFormLive.zfSubFormLive.constructAddress(childElem);else if(comptype==ZFFieldTypeConstants.EMAIL)ZFSubFormLive.zfSubFormLive.constructEmailField(childElem);else if(comptype==ZFFieldTypeConstants.PHONE){var linkName=$(childElem).attr("compname"),phoneJson=(actualCompName=ZFSubFormLive.zfSubFormLive.getActualCompName(linkName),{});if("INTERNATIONAL"==$(childElem).find('[elname="phoneFormatElem"]').attr("phoneformat")){var phoneInp=$(childElem).find("input"),phoneval=$(phoneInp).val();if("true"==$(phoneInp).attr("iscodeEnabled")){phoneJson.isCodeEnabled=!0;var countryCode=$(childElem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode;void 0!==countryCode&&null!=countryCode&&(phoneval="+"+countryCode+phoneval)}else phoneJson.isCodeEnabled=!1;phoneJson.value=phoneval}else phoneJson.countrycode=$(childElem).find('[elname="countrycode"]').val(),phoneJson.first=$(childElem).find('[elname="first"]').val(),phoneJson.second=$(childElem).find('[elname="second"]').val();ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=phoneJson}else comptype==ZFFieldTypeConstants.DROPDOWN?$(childElem).find("select[name='"+compname+"']").each(function(indexelem,elemnew){var actualCompName=ZFSubFormLive.zfSubFormLive.getActualCompName($(elemnew).attr("name")),selectVal=$(elemnew).val();if((null==selectVal&&(selectVal="-Select-"),ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=selectVal,"-Select-"!=selectVal)&&$(elemnew).find("optgroup").length>0){var groupName=getGroupValueofSelectedChoice(elemnew,compname);ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName+"_group_name"]=groupName}}):comptype==ZFFieldTypeConstants.RADIO?ZFSubFormLive.zfSubFormLive.constructRadio(childElem):comptype==ZFFieldTypeConstants.CHECKBOX?ZFSubFormLive.zfSubFormLive.constructCheckBox(childElem):comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE?ZFSubFormLive.zfSubFormLive.constructMultiSelect(childElem):comptype==ZFFieldTypeConstants.DECISION_BOX?ZFSubFormLive.zfSubFormLive.constructDecision(childElem):comptype==ZFFieldTypeConstants.RATING?ZFSubFormLive.zfSubFormLive.constructRating(childElem):comptype==ZFFieldTypeConstants.SLIDER?ZFSubFormLive.zfSubFormLive.constructSlider(childElem):comptype!=ZFFieldTypeConstants.DECIMAL&&comptype!=ZFFieldTypeConstants.CURRENCY||ZFSubFormLive.zfSubFormLive.constructNormalField(childElem)})},ZFSubFormLive.prototype.constructSubFormDataJsonCommon=function(comptype,childElem){var compname=$(childElem).attr("compname");comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.WEBSITE?ZFSubFormLive.zfSubFormLive.constructNormalField(childElem):comptype==ZFFieldTypeConstants.MULTI_LINE?ZFSubFormLive.zfSubFormLive.constructTextArea(childElem):comptype==ZFFieldTypeConstants.DATE?ZFSubFormLive.zfSubFormLive.constructDate(childElem):comptype===ZFFieldTypeConstants.DATETIME?ZFSubFormLive.zfSubFormLive.constructDateTime(childElem):comptype==ZFFieldTypeConstants.TIME?ZFSubFormLive.zfSubFormLive.constructTime(childElem):comptype==ZFFieldTypeConstants.NAME?ZFSubFormLive.zfSubFormLive.constructName(childElem):comptype==ZFFieldTypeConstants.ADDRESS?ZFSubFormLive.zfSubFormLive.constructAddress(childElem):comptype==ZFFieldTypeConstants.EMAIL?ZFSubFormLive.zfSubFormLive.constructEmailField(childElem):comptype==ZFFieldTypeConstants.PHONE?ZFSubFormLive.zfSubFormLive.constructPhone(childElem):comptype==ZFFieldTypeConstants.DROPDOWN?ZFSubFormLive.zfSubFormLive.constructDropdown(childElem,compname):comptype==ZFFieldTypeConstants.RADIO?ZFSubFormLive.zfSubFormLive.constructRadio(childElem):comptype==ZFFieldTypeConstants.CHECKBOX?ZFSubFormLive.zfSubFormLive.constructCheckBox(childElem):comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE?ZFSubFormLive.zfSubFormLive.constructMultiSelect(childElem):comptype==ZFFieldTypeConstants.DECISION_BOX?ZFSubFormLive.zfSubFormLive.constructDecision(childElem):comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD?ZFLive.isOldUploadType?ZFSubFormLive.zfSubFormLive.constructFileUpload(childElem):ZFSubFormLive.zfSubFormLive.constructFileUpload_New(childElem):comptype==ZFFieldTypeConstants.RATING?ZFSubFormLive.zfSubFormLive.constructRating(childElem):comptype==ZFFieldTypeConstants.SLIDER?ZFSubFormLive.zfSubFormLive.constructSlider(childElem):comptype!=ZFFieldTypeConstants.DECIMAL&&comptype!=ZFFieldTypeConstants.CURRENCY||ZFSubFormLive.zfSubFormLive.constructDecimalField(childElem)},ZFSubFormLive.prototype.setBackedUpValueToFields=function(subFormRow){if($(subFormRow).children('li[elname="livefield-elem"]').each(function(childIndex,childElem){var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype")),compname=$(childElem).attr("compname"),linkname=ZFSubFormLive.zfSubFormLive.getActualCompName(compname),needdata=$(childElem).attr("needdata");if(id&&"true"==needdata)if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.WEBSITE||comptype==ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY)$(childElem).find("input").val(ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname]);else if(comptype==ZFFieldTypeConstants.EMAIL){var needReconf=$(childElem).attr("need_reconf");$(childElem).find("input").val(ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname]),"true"==needReconf&&$(childElem).find('[elname="livefield-reconf-elem"]').find("input").blur()}else if(comptype==ZFFieldTypeConstants.MULTI_LINE)$(childElem).find("textarea").val(ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname]);else if(comptype==ZFFieldTypeConstants.TIME)$(childElem).find('select[timecomp="hours"]').val(ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname].hours),$(childElem).find('select[timecomp="minutes"]').val(ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname].minutes),$(childElem).find('select[timecomp="Meridiem"]').length>0&&$(childElem).find('select[timecomp="Meridiem"]').val(ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname].meridian);else if(comptype==ZFFieldTypeConstants.NAME||comptype==ZFFieldTypeConstants.ADDRESS){var nameValJson=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname];$.each(nameValJson,function(key,val){$(childElem).find("[complink='"+key+"']").val(val)})}else if(comptype==ZFFieldTypeConstants.PHONE){var phoneFormatElem=$(childElem).find('[elname="phoneFormatElem"]'),phoneJson=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname];needReconf=$(childElem).attr("need_reconf");if("INTERNATIONAL"==phoneFormatElem.attr("phoneformat"))phoneJson.isCodeEnabled?($(childElem).find('[elname="phoneFld"]').find("#"+compname).intlTelInput("setNumber",phoneJson.value),"true"==needReconf&&$(childElem).find('[elname="confPhoneFld"]').find("input").intlTelInput("setNumber",phoneJson.value).blur()):($(childElem).find('[elname="phoneFld"]').find("#"+compname).val(phoneJson.value),"true"==needReconf&&$(childElem).find('[elname="confPhoneFld"]').find("input").val(phoneJson.value).blur());else{var sfPhoneFld=$(childElem).find('[elname="phoneFld"]');if($(sfPhoneFld).find('[elname="countrycode"]').val(phoneJson.countrycode),$(sfPhoneFld).find('[elname="first"]').val(phoneJson.first),$(sfPhoneFld).find('[elname="second"]').val(phoneJson.second),"true"==needReconf){var sfConfPhoneFld=$(childElem).find('[elname="confPhoneFld"]');$(sfConfPhoneFld).find('[elname="countrycode"]').val(phoneJson.countrycode),$(sfConfPhoneFld).find('[elname="first"]').val(phoneJson.first),$(sfConfPhoneFld).find('[elname="second"]').val(phoneJson.second).blur()}}}else if(comptype==ZFFieldTypeConstants.DROPDOWN){var optGroupName=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname+"_group_name"],selectVal=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname];if(void 0!==optGroupName){var optGroupElem=$(childElem).find('optgroup[label="'+optGroupName+'"]');optGroupElem.length>0?optGroupElem.find('option[value="'+selectVal+'"]').prop("selected",!0):$(childElem).find("select[name='"+compname+"']").val(selectVal)}else $(childElem).find("select[name='"+compname+"']").val(selectVal)}else if(comptype==ZFFieldTypeConstants.RADIO){if(""!=(selectVal=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname])){var selectedRadio=$(childElem).find('input[value="'+selectVal+'"]'),allowothersRadio=$(childElem).find('input[allowothers="true"]');$(selectedRadio).length>0?($(selectedRadio).prop("checked",!0),allowothersRadio.length>0&&$(childElem).find("input[name=allow-others-text]").val("")):allowothersRadio.length>0&&(allowothersRadio.prop("checked",!0),$(childElem).find("input[name=allow-others-text]").val(selectVal))}}else if(comptype==ZFFieldTypeConstants.CHECKBOX){selectVal=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname];if($(childElem).find("input[name='"+compname+"']").prop("checked",!1),""!=selectVal)for(var index=0;index<selectVal.length;index++)$(childElem).find("input[name='"+compname+"'][value='"+selectVal[index]+"']").prop("checked","true")}else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE){selectVal=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname];$(childElem).find("#"+compname+"-multiple-id").val(selectVal)}else if(comptype==ZFFieldTypeConstants.DECISION_BOX){"true"==(selectVal=ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname])?$(childElem).find("input").prop("checked",!0):$(childElem).find("input").prop("checked",!1)}else if(comptype==ZFFieldTypeConstants.RATING)ZFCrmLive.zfCrmLive.fillRatingFormFieldWithoutVaidation($(childElem),ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname]);else if(comptype==ZFFieldTypeConstants.SLIDER)ZFCrmLive.zfCrmLive.fillSliderFormFieldWithoutValidation($(childElem),compname,ZFSubFormLive.zfSubFormLive.subFormValueJson[linkname]);else if(comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD){var fileElementUL=$(childElem).find('ul[elname="fileElementUL"]');$(fileElementUL).find('[name="singleFileElement"]').each(function(fileIdx,fileElem){$(fileElem).removeAttr("isdelsfpopup").show(),"true"==$(fileElem).attr("isnewlyadded")&&$(fileElem).find('a[name="removeFileElement"]').click()});var parentFileDiv=$(fileElementUL).parent("div");$(parentFileDiv).find("li[name=singleFileElement]").length<=0?$(parentFileDiv).hide():$(parentFileDiv).show()}}),null!=ZFLive.formulaFieldsList){var formulaFldArr=JSON.parse(ZFLive.formulaFieldsList);$(subFormRow).find('[elname="livefield-elem"]').each(function(idx,li){var linkName=$(li).attr("linkname");getFormFieldType(linkName)!=ZFFieldTypeConstants.FORMULA&&linkName&&-1!=$.inArray(linkName,formulaFldArr)&&ZFLive.evalExpression(this)})}},ZFSubFormLive.prototype.constructSubFormDataJsonOnUpdate=function(valueJson,elem){$(elem).find("ul[elname='subFormFieldsUl'][isvalidentry='true']").each(function(rowIndex,subFormRow){ZFSubFormLive.zfSubFormLive.subFormValueJson={},$(subFormRow).children('li[elname="livefield-elem"]').each(function(childIndex,childElem){var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype"));$(childElem).attr("compname");id&&ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonCommon(comptype,childElem)});var sfRowId=$(subFormRow).attr("sf_id");void 0!==sfRowId&&""!=sfRowId&&(ZFSubFormLive.zfSubFormLive.subFormValueJson.sf_id=sfRowId),ZFSubFormLive.zfSubFormLive.subFormValueArray.push(ZFSubFormLive.zfSubFormLive.subFormValueJson)}),valueJson[$(elem).attr("compname")]=ZFSubFormLive.zfSubFormLive.subFormValueArray},ZFSubFormLive.prototype.getActualCompName=function(compName){return compName.substr(0,compName.lastIndexOf("_"))},ZFSubFormLive.prototype.constructNormalField=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("input").val())},ZFSubFormLive.prototype.constructDecimalField=function(elem){var inpVal=$.trim($(elem).find("input").val()),decimalFormat=$(elem).attr("decimalformat"),actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=ZFUtil.getReformattedDecimal(inpVal,decimalFormat)},ZFSubFormLive.prototype.constructTextArea=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("TextArea").val())},ZFSubFormLive.prototype.constructDate=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("input").val())},ZFSubFormLive.prototype.constructDateTime=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("input").val())},ZFSubFormLive.prototype.constructTime=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=getTimeValueFromElem($(elem))},ZFSubFormLive.prototype.constructName=function(elem){var nameJsonObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("complink"),val=$.trim($(elemnew).val()),elmid=$(elemnew).attr("id");nameJsonObj[namenew]=elmid&&"-Select-"==val?"":val});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=nameJsonObj},ZFSubFormLive.prototype.constructAddress=function(elem){var addressJsonObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("complink"),val=$.trim($(elemnew).val()),elemid=$(elemnew).attr("id");addressJsonObj[namenew]=elemid&&"-Select-"==val?"":val});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=addressJsonObj},ZFSubFormLive.prototype.constructEmailField=function(elem){$(elem).find("input").each(function(indexelem,elemnew){var actualCompName=ZFSubFormLive.zfSubFormLive.getActualCompName($(elem).attr("compname"));ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=$.trim($(elemnew).val())})},ZFSubFormLive.prototype.constructPhone=function(elem){var phoneval="",linkName=$(elem).attr("compname");$(elem).find("div[elname=phoneFld]").find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());phoneval+=val});var actualCompName=this.getActualCompName($(elem).attr("compname"));if(this.subFormValueJson[actualCompName]=phoneval,"true"==$(elem).find("div[elname=phoneFld]").find("input").attr("iscodeEnabled")){var countryCode="";""!=phoneval&&(countryCode=null!=(countryCode=$(elem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode)?"+"+countryCode:""),this.subFormValueJson[actualCompName+"_country_code"]=countryCode}},ZFSubFormLive.prototype.constructDropdown=function(elem,fldLinkName){$(elem).find("select[name='"+fldLinkName+"']").each(function(indexelem,elemnew){var actualCompName=ZFSubFormLive.zfSubFormLive.getActualCompName($(elemnew).attr("name"));"-Select-"==$(elemnew).val()?ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]="":(ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=$(elemnew).val(),$(elemnew).find("optgroup").length>0&&(ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName+"_group_name"]=getGroupValueofSelectedChoice(elemnew)))})},ZFSubFormLive.prototype.constructRadio=function(elem){var value="";$(elem).find("input[type=radio]").each(function(indexelem,elemnew){$(elemnew).is(":checked")&&(value=$(elemnew).attr("allowothers")?$(elem).find("input[name=allow-others-text]").val():$(elemnew).attr("value"))});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=value},ZFSubFormLive.prototype.constructCheckBox=function(elem){var checkboxJsonArr=[],actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&checkboxJsonArr.push(val)}),checkboxJsonArr.length>0?this.subFormValueJson[actualCompName]=checkboxJsonArr:this.subFormValueJson[actualCompName]=""},ZFSubFormLive.prototype.constructMultiSelect=function(elem){var multiJsonArr=[],actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("select").each(function(indexelem,elemnew){for(var id=$(elemnew).attr("id"),txtSelectedObj=document.getElementById(id),i=0;i<txtSelectedObj.options.length;i++)if(txtSelectedObj.options[i].selected){var selectedVal=txtSelectedObj.options[i].value;multiJsonArr.push(selectedVal),0}multiJsonArr.length>0?ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=multiJsonArr:ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=""})},ZFSubFormLive.prototype.constructDecision=function(elem){$(elem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).is(":checked");val=val?"true":"false";var namenew=ZFSubFormLive.zfSubFormLive.getActualCompName($(elemnew).attr("name"));ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew]=val})},ZFSubFormLive.prototype.constructFileUpload=function(elem){var filepatharr=[],namenew=($(elem).attr("comptype"),ZFSubFormLive.zfSubFormLive.getActualCompName($(elem).attr("compname")));if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();""==(previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""))?ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr}else $(elem).find("input[elname="+$(elem).attr("compname")+"]").each(function(indexelem,elemnew){var value=$(elemnew).attr("filepath");if(""!=value){for(var splittedArr=value.split(","),index=0;index<splittedArr.length;index++)filepatharr.push(splittedArr[index]);ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr}else ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr})},ZFSubFormLive.prototype.constructFileUpload_New=function(elem){var filepatharr=[],namenew=($(elem).attr("comptype"),ZFSubFormLive.zfSubFormLive.getActualCompName($(elem).attr("compname")));if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();""==(previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""))?ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr}else $(elem).find("ul[elname=fileElementUL]").find("li[elname!=templateFileElement]").each(function(index,elem){var value=$(elem).attr("uploadpath");""!=value&&filepatharr.push(value)}),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v2"]=filepatharr},ZFSubFormLive.prototype.constructRating=function(elem){var value="";$(elem).find("a").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");null!=val&&(value=val)});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=value},ZFSubFormLive.prototype.constructSlider=function(elem){$(elem).find("div[name=slider]").each(function(index,elemnew){val=$(elemnew).attr("value")});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=val};var ZFRuleConstants={FORM:"form",FIELD_RULES_ENABLED:"field_rules_enabled",FIELD_RULES:"field_rules",CONDITIONS:"conditions",VALUE:"value",VALUE_ARRAY:"value_array",ROW_LINK_NAME:"row",FIELD_LINK_NAME:"field_link_name",COMP_OPER:"comparison_oper",LOGICAL_OPER:"logical_oper",ACTIONS:"actions",PRE_DEF_VALUE:"predefined_value",OPERATOR:"operator",RESULT:"result",ACTION_LINK_NAME:"actionLinkName",FieldLinkName:"fieldLinkName",RULE_ACTION:"ruleaction",SHOW:"show",HIDE:"hide",SHOW_GROUP:"showgroup",HIDE_GROUP:"hidegroup",ACTION:"action",ACTION_ID:"action_id",CONDN_VALUE:"condValue",OPERATORS:{EQUALS:"EQUALS",NOT_EQUAL:"NOT_EQUAL",STARTS_WITH:"STARTS_WITH",LIKE:"LIKE",EQUALS:"EQUALS",CONTAINS:"CONTAINS",NOT_CONTAINS:"NOT_CONTAINS",IS_EMPTY:"IS_EMPTY",IS_NOT_EMPTY:"IS_NOT_EMPTY",LESS_THAN:"LESS_THAN",GREATER_THAN:"GREATER_THAN",LESS_EQUAL:"LESS_EQUAL",GREATER_EQUAL:"GREATER_EQUAL",BETWEEN:"BETWEEN",TODAY:"TODAY",YESTERDAY:"YESTERDAY",TOMORROW:"TOMORROW",LAST_7_DAYS:"LAST_7_DAYS",LAST_30_DAYS:"LAST_30_DAYS",LAST_60_DAYS:"LAST_60_DAYS",LAST_90_DAYS:"LAST_90_DAYS",LAST_120_DAYS:"LAST_120_DAYS",LAST_WEEK:"LAST_WEEK",THIS_WEEK:"THIS_WEEK",NEXT_WEEK:"NEXT_WEEK",CURR_PREV_WEEK:"CURR_PREV_WEEK",CURR_NEXT_WEEK:"CURR_NEXT_WEEK",LAST_MONTH:"LAST_MONTH",THIS_MONTH:"THIS_MONTH",NEXT_MONTH:"NEXT_MONTH",CURR_PREV_MONTH:"CURR_PREV_MONTH",CURR_NEXT_MONTH:"CURR_NEXT_MONTH",LAST_YEAR:"LAST_YEAR",THIS_YEAR:"THIS_YEAR",NEXT_YEAR:"NEXT_YEAR",LAST_2_YEAR:"LAST_2_YEAR",NEXT_2_YEAR:"NEXT_2_YEAR",CURR_PREV_YEAR:"CURR_PREV_YEAR",CURR_NEXT_YEAR:"CURR_NEXT_YEAR",SAME_FILETYPE:"SAME_FILETYPE",NOT_SAME_FILETYPE:"NOT_SAME_FILETYPE",IS_ANYOF:"IS_ANYOF",IS_NONEOF:"IS_NONEOF",CONTAINS_ANYOF:"CONTAINS_ANYOF",CONTAINS_ALLOF:"CONTAINS_ALLOF",CONTAINS_NONEOF:"CONTAINS_NONEOF"},FIELD:{TYPE:{DROPDOWN:12},OPT_GROUP_ID:"group_id",OPT_GROUP_NAME:"group_name"}},Num_Status={INVALID:"INVALID",EQUAL:"EQUAL",LESSER:"LESSER",GREATER:"GREATER"},RULE_FROM_CONST={EVAL:"eval",PRE_EVAL:"preeval"};function ZFRule(){this.rulemeta={},this.zfRules,this.resultArray=[],this.bindArr=["IS_EMPTY","IS_NOT_EMPTY","NOT_CONTAINS"],this.bindedFields=[],this.formBodyDiv}function ZFFieldRule(){this.actionsObj={},this.conditionsObj={},this.oper,this.fieldElems=[],this.ruleid}function ZFConditions(){this.operator,this.condValue}function ZFActions(){}function ZFCondition(){this.fieldLinkName,this.operator,this.condValue,this.result=!1,this.group_name}function ZFAction(){this.ruleaction,this.actionLinkName,this.group_name}function preEvalRules(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={};var evalAllRulesArr=[];zf_rule.formBodyDiv.find("li[elname=livefield-elem]").each(function(index,elem){var comptype=$(elem).attr("comptype");0!=comptype&&19!=comptype&&32!=comptype&&(evalAllRulesArr=[],evaluateRule(elem,RULE_FROM_CONST.PRE_EVAL,evalAllRulesArr,groupActionVisibleHiddenJsonObj))}),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj)}function callEvalRules(inp){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(inp,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}function bindevents(){var matrixRowArr=[];for(var i in zf_rule.zfRules){for(var x in zf_rule.zfRules[i].actionsObj){if(zf_rule.zfRules[i].actionsObj[x][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW)getFieldElem(zf_rule.zfRules[i].actionsObj[x][ZFRuleConstants.ACTION_LINK_NAME]).hide()}for(var y in zf_rule.zfRules[i].conditionsObj){var fieldLinkName=zf_rule.zfRules[i].conditionsObj[y].fieldLinkName,liElem=getFieldElem(fieldLinkName);if(ZFUtil.isFieldVisible(liElem)){var compType=parseInt($(liElem).attr("comptype")),encryptionfldtype=parseInt($(liElem).attr("encryptionfldtype"));if(-1==$.inArray(fieldLinkName,zf_rule.bindedFields)||30==compType)if(zf_rule.bindedFields.push(fieldLinkName),6==compType||12==compType||15==compType)liElem.on("change","select",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),12==$(this).parents("li").attr("comptype")&&ZFLive.evalExpression(this),triggerFormResize()});else if(7==compType||8==compType||13==compType||6==compType)liElem.on("change","select",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),liElem.on("click keyup","input",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()});else if(14==compType||18==compType||34==compType)liElem.on("change","input",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()});else if(30==compType)-1==$.inArray(zf_rule.zfRules[i].conditionsObj[y].rowLinkName,matrixRowArr)&&(liElem.on("click","input[name="+zf_rule.zfRules[i].conditionsObj[y].rowLinkName+"]",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),matrixRowArr.push(zf_rule.zfRules[i].conditionsObj[y].rowLinkName));else if(21==compType)liElem.on("click","a,span",function(){callEvalRules(this)});else if(2==compType||33==compType&&encryptionfldtype==EncryptionFieldType.MULTI_LINE)liElem.on("change keyup","textarea",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()});else if(23==compType){var sliderElems=liElem.find("a");for(index=0;index<sliderElems.length;index++)$(sliderElems[index]).parent().on("slidestop",evalSliderRule())}else if(9==compType)liElem.on("change keyup","input:first",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj)});else if(29==compType){if("imagePicker"!=liElem.find("div[elname=imageChoiceEle]").attr("choicetype")){var inputs=liElem.find("input");$(inputs).each(function(){var parentDiv=$(this).parent();$(this).on("click",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),$(parentDiv).find("div").on("click",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),$(parentDiv).find("b").on("click",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()})})}else{var divEle=liElem.find("div[elname=choiceContDiv]");$(divEle).each(function(){$(this).find("div[name=selectDiv]").on("click",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),$(this).find("b").on("click",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()})})}}else 11==compType?liElem.find("div[elname=phoneFld]").on("change keyup","input",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}):25==compType?liElem.find("div[elname=signContainer]").on("click",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}):liElem.on("change keyup","input",function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()})}}}}function reEvalFieldRules(liElem){var compType=$(liElem).attr("comptype");callEvalRules(29==compType?$(liElem).find("div[elname=choiceContDiv]"):6==compType||12==compType||15==compType?$(liElem).find("select"):21==compType||23==compType?$(liElem).find("a"):2==compType?$(liElem).find("textarea"):9==compType?$(liElem).find("input:first"):$(liElem).find("input"))}function evalSliderRule(){return function(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,[],groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}}function disableAction(ruleObj,evalAllRulesArr,groupActionVisibleHiddenJsonObj){if(-1==$.inArray(ruleObj.ruleid,evalAllRulesArr))for(var y in evalAllRulesArr.push(ruleObj.ruleid),ruleObj.actionsObj){var fldLnkName=ruleObj.actionsObj[y][ZFRuleConstants.ACTION_LINK_NAME];if(ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW||ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE)re_evalAction(fldLnkName,ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]),evalAllRules(fldLnkName,evalAllRulesArr,groupActionVisibleHiddenJsonObj);else if(ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW_GROUP){if(!(groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]).hasOwnProperty(fldLnkName)){var grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}else if(ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE_GROUP){var groupActionShowObj;if(!(groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]).hasOwnProperty(fldLnkName)){grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}}}function evalAllRules(fldLnkName,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li"),comptype=$(fldLinkElem).attr("comptype");if(0!=comptype&&19!=comptype&&32!=comptype&&25!=comptype)for(var i in zf_rule.zfRules)if(-1!=$.inArray(fldLnkName,zf_rule.zfRules[i].fieldElems)){evaluateRule($(fldLinkElem),RULE_FROM_CONST.EVAL,evalAllRulesArr,groupActionVisibleHiddenJsonObj);break}}function re_evalAction(fldLnkName,rulAct){var fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li");ZFUtil.isFieldVisible(fldLinkElem)&&(rulAct==ZFRuleConstants.SHOW&&fldLinkElem.hide().attr("needdata",!1),rulAct==ZFRuleConstants.HIDE&&fldLinkElem.show().attr("needdata",!0))}function evalRuleActions(rulActObj){for(var x in rulActObj){var fldLinkElem=getFieldElem(rulActObj[x][ZFRuleConstants.ACTION_LINK_NAME]);rulActObj[x][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW?fldLinkElem.show().attr("needdata",!0):rulActObj[x][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE&&fldLinkElem.hide().attr("needdata",!1)}}function evaluateRule(elem,from,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var compType=parseInt($(elem).attr("comptype")),encryptionFldType=parseInt($(elem).attr("encryptionfldtype"));33===compType&&(encryptionFldType==EncryptionFieldType.SINGLE_LINE||encryptionFldType==EncryptionFieldType.NUMBER)||27===compType||1===compType||3===compType||4===compType||5===compType||7===compType||9===compType||10===compType||11===compType||20===compType||26===compType||16===compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):2==compType||33===compType&&encryptionFldType==EncryptionFieldType.MULTI_LINE?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("textarea:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("textarea:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):21===compType||23===compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("a:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("a:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):6==compType||12==compType||15==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("select:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("select:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):13==compType||14==compType||18==compType||34==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):29==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("div[elname=imageChoiceEle]:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("div[elname=imageChoiceEle]:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):30==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("input").eq(0),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("input").eq(0),evalAllRulesArr,groupActionVisibleHiddenJsonObj):8===compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules(elem,evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules(elem,evalAllRulesArr,groupActionVisibleHiddenJsonObj):25===compType&&(from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules(elem,evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules(elem,evalAllRulesArr,groupActionVisibleHiddenJsonObj))}function evalAction(actionObj,fldLnkName,rulAct,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li");ZFUtil.isFieldVisible(fldLinkElem)&&(rulAct==ZFRuleConstants.SHOW?(fldLinkElem.show().attr("needdata",!0),25===parseInt($(fldLinkElem).attr("comptype"))&&setWidthForSignatureElem(fldLinkElem)):rulAct==ZFRuleConstants.HIDE&&fldLinkElem.hide().attr("needdata",!1),evaluateRule($(fldLinkElem),RULE_FROM_CONST.EVAL,evalAllRulesArr,groupActionVisibleHiddenJsonObj))}function evalGroupAction(fldLnkName,rulAct,groupActionVisibleHiddenJsonObj){if(rulAct==ZFRuleConstants.SHOW_GROUP){if(!(groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]).hasOwnProperty(fldLnkName)){var grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}else if(rulAct==ZFRuleConstants.HIDE_GROUP){var groupActionShowObj;if(!(groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]).hasOwnProperty(fldLnkName)){grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}}function performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj){evalDependentGroupAction(groupActionVisibleHiddenJsonObj,getFieldsInvolvedInGroupAction(groupActionVisibleHiddenJsonObj)),showOrHideOptionGroupBasedOnRules(groupActionVisibleHiddenJsonObj)}function performShowHideGroupActions(currRule,groupActionVisibleHiddenJsonObj){for(var x in currRule.actionsObj){var currRuleActionObj=currRule.actionsObj[x],rulAct=currRuleActionObj[ZFRuleConstants.RULE_ACTION],fldLnkName=currRuleActionObj[ZFRuleConstants.ACTION_LINK_NAME];if(rulAct==ZFRuleConstants.SHOW_GROUP){var optGroupNameToShow=currRuleActionObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP];if(groupActionShowObj.hasOwnProperty(fldLnkName)){var grpNameArray=groupActionShowObj[fldLnkName];-1==$.inArray(optGroupNameToShow,grpNameArray)&&grpNameArray.push(optGroupNameToShow)}}else if(rulAct==ZFRuleConstants.HIDE_GROUP){var optGroupNameToHide=currRuleActionObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],groupActionHideObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP];if(groupActionHideObj.hasOwnProperty(fldLnkName)){grpNameArray=groupActionHideObj[fldLnkName];-1==$.inArray(optGroupNameToHide,grpNameArray)&&grpNameArray.push(optGroupNameToHide)}}}}function evalDependentGroupAction(groupActionVisibleHiddenJsonObj,fieldsArrayInCurrGroupAction){for(var iter1 in fieldsArrayInCurrGroupAction){var currFldLinkName=fieldsArrayInCurrGroupAction[iter1];for(var iter2 in zf_rule.zfRules)isCurrentRuleHasGroupActionWithCurrentField(zf_rule.zfRules[iter2],currFldLinkName)&&evalConditionForCurrentRule(zf_rule.zfRules[iter2])&&performShowHideGroupActions(zf_rule.zfRules[iter2],groupActionVisibleHiddenJsonObj)}}function getVisibleChoicesFromField(fldLinkElem,fldLinkName){var visibleChoicesList=[],optionGroup=$(fldLinkElem).find('select[name="'+fldLinkName+'"]').find("optgroup");return $(optionGroup).each(function(index,currOptionGroup){if("display: none;"!=$(currOptionGroup).attr("style")){var optChoices=$(currOptionGroup).find("option");$(optChoices).each(function(index,currChoice){var choiceVal=$(currChoice).attr("value");visibleChoicesList.push(choiceVal)})}}),visibleChoicesList}function getVisibleGroupFromField(fldLinkElem,fldLinkName){var visibleGroupsList=[],optionGroup=$(fldLinkElem).find('select[name="'+fldLinkName+'"]').find("optgroup");return $(optionGroup).each(function(index,currOptionGroup){if("display: none;"!=$(currOptionGroup).attr("style")){var grpVal=$(currOptionGroup).attr("value");visibleGroupsList.push(grpVal)}}),visibleGroupsList}function evalConditionForCurrentRule(currRule){for(var x in currRule.conditionsObj){var result=!1,fldLinkElem=zf_rule.formBodyDiv.find("li#"+currRule.conditionsObj[x][ZFRuleConstants.FieldLinkName]+"-li"),compType=parseInt(fldLinkElem.attr("comptype"));"true"==$(fldLinkElem).attr("needdata")&&"true"==$(fldLinkElem).parent("ul").attr("needpagedata")&&(result=compType===ZFFieldTypeConstants.DATE?evalDateCondition(currRule.conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.DATETIME?evalDateTimeCondn(currRule.conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.TIME?evalTimeCondition(currRule.conditionsObj[x],fldLinkElem):evalCondition(currRule.conditionsObj[x],compType)),currRule.conditionsObj[x][ZFRuleConstants.RESULT]=result}var cnt=1,size=0,str="";for(var x in currRule.conditionsObj)size++;for(var x in currRule.conditionsObj)cnt!=size?str=str+currRule.conditionsObj[x][ZFRuleConstants.RESULT]+currRule.oper:str+=currRule.conditionsObj[x][ZFRuleConstants.RESULT],cnt++;return evalBoolExp($.trim(str))}function isCurrentRuleHasGroupActionWithCurrentField(currRule,currFldLinkName){var hasGrpActionFlag=!1;for(var iter in currRule.actionsObj){var actionObjLinkName=currRule.actionsObj[iter][ZFRuleConstants.ACTION_LINK_NAME];if((currRule.actionsObj[iter][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW_GROUP||currRule.actionsObj[iter][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE_GROUP)&&actionObjLinkName==currFldLinkName)return hasGrpActionFlag=!0}return hasGrpActionFlag}function getFieldsInvolvedInGroupAction(groupActionVisibleHiddenJsonObj){var fieldsList=[];for(var grpAction in groupActionVisibleHiddenJsonObj){var fieldsObjInvolvedInGroupAction=groupActionVisibleHiddenJsonObj[grpAction];for(var fldLinkName in fieldsObjInvolvedInGroupAction)fieldsList.push(fldLinkName)}return fieldsList}function showOrHideOptionGroupBasedOnRules(groupActionVisibleHiddenJsonObj){for(var grpAction in groupActionVisibleHiddenJsonObj){var fieldsObjInvolvedInGroupAction=groupActionVisibleHiddenJsonObj[grpAction];if(grpAction==ZFRuleConstants.SHOW_GROUP)for(var fldLinkName in fieldsObjInvolvedInGroupAction){var grpNameArray=fieldsObjInvolvedInGroupAction[fldLinkName],fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLinkName+"-li"),selectedInp=(selectInpElem=$(fldLinkElem).find('select[name="'+fldLinkName+'"]')).find(":selected").attr("value"),selectedGroupName=getGroupValueofSelectedChoice(fldLinkElem,fldLinkName);for(var iter in selectInpElem.find("optgroup").remove(),grpNameArray){var grpName=grpNameArray[iter],optGrpToClone=ZFUtil.getSelectedChoiceElem($(fldLinkElem).find("div[elname=liveFieldTempChoiceCont]").find("select").find("optgroup"),"value",grpName),optGrpElem=$(optGrpToClone).clone();selectInpElem[0].appendChild(optGrpElem[0])}clearSelectFieldInputIfHidden(fldLinkElem,fldLinkName,selectedInp,selectedGroupName)}else if(grpAction==ZFRuleConstants.HIDE_GROUP)for(var fldLinkName in fieldsObjInvolvedInGroupAction){var selectInpElem;grpNameArray=fieldsObjInvolvedInGroupAction[fldLinkName],fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLinkName+"-li"),selectedInp=(selectInpElem=$(fldLinkElem).find('select[name="'+fldLinkName+'"]')).find(":selected").attr("value"),selectedGroupName=getGroupValueofSelectedChoice(fldLinkElem,fldLinkName);selectInpElem.find("optgroup").remove();optGrpElem=$(fldLinkElem).find("div[elname=liveFieldTempChoiceCont]").find("select").find("optgroup").clone();for(var iter in $.each(optGrpElem,function(index,elem){selectInpElem[0].appendChild(elem)}),grpNameArray){grpName=grpNameArray[iter];var optGrpToRemove=ZFUtil.getSelectedChoiceElem(selectInpElem.find("optgroup"),"value",grpName);$(optGrpToRemove).remove()}clearSelectFieldInputIfHidden(fldLinkElem,fldLinkName,selectedInp,selectedGroupName)}}}function clearSelectFieldInputIfHidden(fldLinkElem,fldLinkName,selectedInp,selectedGroupName){var visibleChoicesList;if(visibleChoicesList=getVisibleChoicesFromField(fldLinkElem,fldLinkName),visibleGroupList=getVisibleGroupFromField(fldLinkElem,fldLinkName),"-Select-"==selectedInp||-1!=$.inArray(selectedInp,visibleChoicesList)&&-1!=$.inArray(selectedGroupName,visibleGroupList))-1!=$.inArray(selectedInp,visibleChoicesList)&&-1!=$.inArray(selectedGroupName,visibleGroupList)&&ZFUtil.selectChoiceInOptGroup($(fldLinkElem).find('select[name="'+fldLinkName+'"]'),selectedGroupName,selectedInp);else{var selectElem=$(fldLinkElem).find('select[name="'+fldLinkName+'"]');selectElem.find("option[value=-Select-]").attr("selected","selected"),selectElem.change()}}function getOperTypeFromCond(cond){return cond[ZFRuleConstants.OPERATOR]}function getCompName(elem){return"livefield-elem"===$(elem).attr("elname")?$(elem).attr("compname"):$(elem).parents("li[elname=livefield-elem]").attr("compname")}function getLogicalOper(oper){return"matchany"==oper?"||":"matchall"==oper?"&&":void 0}function getFieldElem(fldLnkName){return $("li#"+fldLnkName+"-li")}function getMatrixRowValue(fldLnkName,rowLinkName,columnValue){var matrixArr=[];return getFieldElem(fldLnkName).find("input[name="+rowLinkName+"]:checked").each(function(index,elem){""!=columnValue&&columnValue!=undefined?$(elem).attr("columnValue")==columnValue&&matrixArr.push($(elem).attr("columnValue")):matrixArr.push($(elem).attr("columnValue"))}),matrixArr}function getInputValForTime(fldElem){var timeVal="";return fldElem.find("select").each(function(index,elem){timeVal=0==index?$.trim($(elem).val()):timeVal+":"+$.trim($(elem).val())}),timeVal}function getInputValue(fldLnkName,comptype){var inputVal,fldElem=getFieldElem(fldLnkName),encryptionfldtype=parseInt($(fldElem).attr("encryptionfldtype"));if(2==comptype||33==comptype&&encryptionfldtype==EncryptionFieldType.MULTI_LINE)return $.trim(fldElem.find("TextArea").val());if(6==comptype)return getInputValForTime(fldElem);if(7==comptype){var nameArr=[];return fldElem.find("input,select").each(function(index,elem){""!=$.trim($(elem).val())&&"-Select-"!=$.trim($(elem).val())&&nameArr.push($.trim($(elem).val()))}),nameArr}if(8==comptype){var addressArr=[];return fldElem.find("input,select").each(function(index,elem){""!=$.trim($(elem).val())&&"-Select-"!=$.trim($(elem).val())&&addressArr.push($.trim($(elem).val()))}),addressArr}if(11==comptype){if("INTERNATIONAL"==fldElem.find("div[elname=phoneFormatElem]").attr("phoneformat"))return $.trim(fldElem.find("div[elname=phoneFld]").find("input").val());var phoneVal="";return fldElem.find("div[elname=phoneFld]").find("input").each(function(index,elem){var elemValue=$.trim($(elem).val());""!==elemValue&&(phoneVal+=elemValue)}),phoneVal}if(12==comptype)return"-Select-"!=(inputVal=$.trim(fldElem.find("select[name='"+fldLnkName+"']").val()))?inputVal:void 0;if(13==comptype)return"zfs-others-zfs"==(inputVal=$.trim(fldElem.find("input:radio:checked").val()))?$.trim(fldElem.find("input[name=allow-others-text]").val()):inputVal;if(14==comptype){var checkboxArr=[];return fldElem.find("input:checkbox:checked").each(function(index,elem){checkboxArr.push($(elem).val())}),checkboxArr}if(15==comptype)return fldElem.find("select").val();if(21==comptype)return fldElem.find("a").attr("value");if(18==comptype||34==comptype)return!!fldElem.find("input:checkbox").is(":checked");if(23==comptype)return $.trim(fldElem.find("div[name=slider]").attr("value"));if(26==comptype){var geolocationArr=[];return fldElem.find("input").each(function(index,elem){var inpVal=$.trim($(elem).val());""!=inpVal&&geolocationArr.push(inpVal)}),geolocationArr}if(29==comptype){checkboxArr=[];if("imagePicker"!=fldElem.find("div[elname=imageChoiceEle]").attr("choicetype")){var inputs=fldElem.find("input");$(inputs).each(function(index,elem){"true"==$(elem).attr("prevVal")&&checkboxArr.push($(elem).attr("value"))})}else fldElem.find("div[name=selectDiv]").each(function(index,elem){"selected"==$(elem).attr("selected")&&checkboxArr.push($(elem).attr("value"))});return checkboxArr}if(20==comptype||4==comptype||27==comptype){var decimalFormat=fldElem.attr("decimalformat"),val=fldElem.find("input").val(),newVal=val;return"-"==val.charAt(0)&&(newVal=val.substring(1,val.length)),ZFUtil.checkDecimalFormat(newVal,decimalFormat,10)?$.trim(ZFUtil.getReformattedDecimal(val,decimalFormat)):val}return 9==comptype?$.trim(fldElem.find("input:first").val()):25==comptype?document.getElementById("drawingCanvas-"+fldLnkName):$.trim(fldElem.find("input").val())}function evalCondition(condObj,comptype){var inpVal,oper=condObj[ZFRuleConstants.OPERATOR],fldLnkName=condObj[ZFRuleConstants.FieldLinkName];switch(inpVal=30==comptype?getMatrixRowValue(fldLnkName,condObj.rowLinkName,condObj.condValue):getInputValue(fldLnkName,comptype),oper){case"EQUALS":opers=check_Equals(condObj,inpVal,comptype,fldLnkName);break;case"NOT_EQUAL":opers=check_NotEquals(condObj,inpVal,comptype,fldLnkName);break;case"IS_EMPTY":opers=check_IsEmpty(inpVal,comptype,fldLnkName);break;case"IS_NOT_EMPTY":opers=check_IsNotEmpty(inpVal,comptype,fldLnkName);break;case"STARTS_WITH":opers=check_StartsWith(inpVal,condObj.condValue);break;case"ENDS_WITH":opers=check_EndsWith(inpVal,condObj.condValue);break;case"LESS_THAN":opers=check_Lessthan(inpVal,condObj.condValue,comptype);break;case"GREATER_THAN":opers=check_Greaterthan(inpVal,condObj.condValue,comptype);break;case"LESS_EQUAL":opers=check_Lessthanequal(inpVal,condObj.condValue);break;case"GREATER_EQUAL":opers=check_Greaterthanequal(inpVal,condObj.condValue);break;case"CONTAINS":opers=check_Contains(condObj.condValue,inpVal,comptype);break;case"NOT_CONTAINS":opers=check_NotContains(condObj.condValue,inpVal,comptype);break;case"BETWEEN":opers=check_Between(condObj.condValue,inpVal,comptype);break;case"TRUE":opers=!!inpVal;break;case"FALSE":opers=!inpVal;break;case"OTHER_IS_NOT_EMPTY":opers=check_OthersNotEmpty(inpVal,fldLnkName);break;case"IS_ANYOF":if(condObj.hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)){var condGrpName=condObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],selectedChoiceGrpName=getGroupNameofSelectedChoice(getFieldElem(fldLnkName),fldLnkName);opers=condGrpName===selectedChoiceGrpName&&check_IsAnyOne(condObj.condValue,inpVal)}else opers=check_IsAnyOne(condObj.condValue,inpVal);break;case"IS_NONEOF":if(condObj.hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)){condGrpName=condObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],selectedChoiceGrpName=getGroupNameofSelectedChoice(getFieldElem(fldLnkName),fldLnkName);opers=condGrpName!==selectedChoiceGrpName||check_IsNotAll(condObj.condValue,inpVal)}else opers=check_IsNotAll(condObj.condValue,inpVal);break;case"CONTAINS_ANYOF":opers=check_ContainsAnyOne(condObj.condValue,inpVal);break;case"CONTAINS_ALLOF":opers=check_ContainsAll(condObj.condValue,inpVal);break;case"CONTAINS_NONEOF":opers=check_NotContainsAll(condObj.condValue,inpVal)}return opers}function check_EmptyValue(inpVal){return null==inpVal||""==inpVal}function check_StartsWith(inpVal,condVal){return!check_EmptyValue(inpVal)&&condVal==inpVal.substring(0,condVal.length)}function check_EndsWith(inpVal,condVal){return!check_EmptyValue(inpVal)&&condVal==inpVal.substring(inpVal.length-condVal.length,inpVal.length)}function check_Lessthan(inpVal,condVal,comptype){return 6==comptype?checkTime(inpVal,condVal):!check_EmptyValue(inpVal)&&new Number(inpVal)<new Number(condVal)}function check_Greaterthan(inpVal,condVal,comptype){return 6==comptype?checkTime(condVal,inpVal):!check_EmptyValue(inpVal)&&new Number(inpVal)>new Number(condVal)}function check_Lessthanequal(inpVal,condVal){return!check_EmptyValue(inpVal)&&new Number(inpVal)<=new Number(condVal)}function check_Greaterthanequal(inpVal,condVal){return!check_EmptyValue(inpVal)&&new Number(inpVal)>=new Number(condVal)}function check_IsNotEmpty(inpVal,comptype,compname){if(comptype===ZFFieldTypeConstants.TIME)return"::"!==inpVal&&":"!==inpVal;if(comptype===ZFFieldTypeConstants.SIGNATURE){var editSignCont=$("#editsignContainer-"+compname);if($(editSignCont).length&&"none"!=$(editSignCont).css("display"))return!0;var signWidth=inpVal.width,signHeight=inpVal.height,blankCanvas=document.createElement("canvas");return blankCanvas.width=signWidth,blankCanvas.height=signHeight,blankCanvas.toDataURL()!=inpVal.toDataURL()}return null!=inpVal&&""!=inpVal}function check_IsEmpty(inpVal,comptype,compname){if(7==comptype||8==comptype||26==comptype)return 0==inpVal.length;if(comptype===ZFFieldTypeConstants.TIME)return"::"===inpVal||":"===inpVal;if(comptype===ZFFieldTypeConstants.SIGNATURE){var editSignCont=$("#editsignContainer-"+compname);if($(editSignCont).length&&"none"!=$(editSignCont).css("display"))return!1;var signWidth=inpVal.width,signHeight=inpVal.height,blankCanvas=document.createElement("canvas");return blankCanvas.width=signWidth,blankCanvas.height=signHeight,blankCanvas.toDataURL()==inpVal.toDataURL()}return null==inpVal||""==inpVal}function check_Between(condValue,inpVal,comptype){var fromVal=condValue.substring(0,condValue.indexOf("--zf--")),toVal=condValue.substring(condValue.indexOf("--zf--")+6,condValue.length);if(!check_EmptyValue(inpVal)){var inpValNum=parseFloat(inpVal);if(!checkNumeric(inpValNum)){var fromValNum=parseFloat(fromVal),toValNum=parseFloat(toVal);if(inpValNum>fromValNum&&inpValNum<toValNum)return!0}}return!1}function check_Contains(condValue,inpVal,comptype){if(comptype=parseInt(comptype),!check_EmptyValue(inpVal)){if(1===comptype||2===comptype||11===comptype||16===comptype)return-1!=inpVal.indexOf(condValue);if(7==comptype||8==comptype||26==comptype){for(var i=0;i<inpVal.length;i++)if(-1!=inpVal[i].indexOf(condValue))return!0}else if(14==comptype||15==comptype||29==comptype)return-1!=$.inArray(condValue,inpVal)}return!1}function check_NotContains(condValue,inpVal,comptype){if(comptype=parseInt(comptype),!check_EmptyValue(inpVal)){if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.PHONE)return-1===inpVal.indexOf(condValue);if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS||comptype===ZFFieldTypeConstants.GEOLOCATION){for(var i=0;i<inpVal.length;i++)if(-1!==inpVal[i].indexOf(condValue))return!1}else if(comptype===ZFFieldTypeConstants.CHECKBOX||comptype===ZFFieldTypeConstants.MULTIPLE_CHOICE||comptype===ZFFieldTypeConstants.IMAGE_CHOICE)return-1===$.inArray(condValue,inpVal)}return!0}function checkNumeric(inpVal){return isNaN(inpVal)}function check_Equals(condObj,inpVal,comptype,fldLnkName){var condValue=condObj[ZFRuleConstants.CONDN_VALUE];if(comptype=parseInt(comptype),!check_EmptyValue(inpVal)){if(1===comptype||2===comptype||13===comptype||9===comptype||11===comptype||5===comptype||6===comptype||10===comptype||16===comptype)return condValue===inpVal;if(3==comptype){if(!checkNumeric(inpVal))return condValue==Number(inpVal)}else{if(12===comptype){if(condObj.hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)){var condGrpName=condObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],selectedChoiceGrpName=getGroupValueofSelectedChoice(getFieldElem(fldLnkName),fldLnkName);return condValue===inpVal&&condGrpName===selectedChoiceGrpName}return condValue===inpVal}if(23==comptype){if(!checkNumeric(inpVal))return condValue==Number(inpVal)}else if(4==comptype){if(!checkNumeric(inpVal))return condValue==new Number(inpVal)}else if(20==comptype||27==comptype){if(!checkNumeric(inpVal))return condValue==new Number(inpVal)}else if(21==comptype){if(!checkNumeric(inpVal))return condValue==new Number(inpVal)}else if(30==comptype&&""!=inpVal)return!0}}return!1}function check_NotEquals(condObj,inpVal,comptype,fldLnkName){var condValue=condObj[ZFRuleConstants.CONDN_VALUE];if((comptype=parseInt(comptype))===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.RADIO||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.PHONE||comptype===ZFFieldTypeConstants.WEBSITE)return condValue!==inpVal;if(comptype===ZFFieldTypeConstants.DROPDOWN)return condObj.hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)&&condObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME]!==getGroupValueofSelectedChoice(getFieldElem(fldLnkName),fldLnkName)||condValue!==inpVal;if(comptype===ZFFieldTypeConstants.TIME){var compareStatus=compareTime(inpVal,condValue);if(compareStatus===Num_Status.LESSER||compareStatus===Num_Status.GREATER)return!0}else if(comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.SLIDER||comptype===ZFFieldTypeConstants.RATING){if(check_NotEmptyValue(inpVal)&&!checkNumeric(inpVal))return condValue!=Number(inpVal)}else if(comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.FORMULA){if(check_NotEmptyValue(inpVal)&&!checkNumeric(inpVal))return condValue!=new Number(inpVal)}else if(comptype==ZFFieldTypeConstants.MATRIX_CHOICE&&""==inpVal)return!0;return!1}function check_NotEmptyValue(inputVal){return""!=inputVal}function checkTime(liveTime,ruleTime){return compareTime(liveTime,ruleTime)===Num_Status.LESSER}function evalTimeCondition(condObj,fldElem){var oper=condObj[ZFRuleConstants.OPERATOR],comptype=parseInt(fldElem.attr("comptype")),inpVal=getInputValForTime(fldElem),timeFormat=fldElem.attr("timeformat");condObj[ZFRuleConstants.CONDN_VALUE]=getCondValueForTime(condObj[ZFRuleConstants.CONDN_VALUE]);var opers,condVal=condObj[ZFRuleConstants.CONDN_VALUE];switch(oper){case"EQUALS":opers=check_Equals(condObj,inpVal,comptype);break;case"NOT_EQUAL":opers=check_Time_NotEquals(inpVal,condVal,timeFormat);break;case"IS_EMPTY":opers=check_IsEmpty(inpVal,comptype);break;case"IS_NOT_EMPTY":opers=check_IsNotEmpty(inpVal,comptype);break;case"LESS_THAN":opers=check_Time_IsLesserThan(inpVal,condVal,timeFormat);break;case"GREATER_THAN":opers=check_Time_IsGreaterThan(inpVal,condVal,timeFormat)}return opers}function check_Time_NotEquals(inpVal,condVal,timeFormat){var compareStatus=compareTimeWithFormat(inpVal,condVal,timeFormat);return compareStatus===Num_Status.LESSER||compareStatus===Num_Status.GREATER}function check_Time_IsLesserThan(inpVal,condVal,timeFormat){return compareTimeWithFormat(inpVal,condVal,timeFormat)===Num_Status.LESSER}function check_Time_IsGreaterThan(inpVal,condVal,timeFormat){return compareTimeWithFormat(inpVal,condVal,timeFormat)===Num_Status.GREATER}function evalDateCondition(condObj,dateFormat,dateLocale,fldElem){var oper=condObj[ZFRuleConstants.OPERATOR],inpVal=$.trim(fldElem.find("input").val());if(ZFUtil.validateDate(inpVal,dateFormat,dateLocale))switch(oper){case"EQUALS":opers=dateComparision_Equal(inpVal,condObj.condValue,dateFormat,dateLocale,"EQUALS");break;case"NOT_EQUAL":opers=dateComparision_Equal(inpVal,condObj.condValue,dateFormat,dateLocale,"NOT_EQUAL");break;case"LESS_THAN":opers=dateComparision(inpVal,condObj.condValue,dateFormat,dateLocale);break;case"GREATER_THAN":opers=dateComparision(condObj.condValue,inpVal,dateFormat,dateLocale);break;case"BETWEEN":opers=dateComparision_between(condObj.condValue,inpVal,dateFormat,dateLocale);break;case"IS_NOT_EMPTY":opers=check_NotEmptyValue(inpVal);break;case"IS_EMPTY":opers=check_EmptyValue(inpVal)}else opers=!1;return opers}function dateComparision_Equal(date1,date2,dateFormat,dateLocale,opertype){if(""!=date1&&""!=date2){var day=getDayDifference(date1,date2,dateFormat,dateLocale);if("EQUALS"==opertype){if(0==day)return!0}else if("NOT_EQUAL"==opertype&&0!=day)return!0}return!1}function dateComparision_between(date1,inputdate,dateFormat,dateLocale){var fromDate=date1.substring(0,date1.indexOf("--zf--")),toDate=date1.substring(date1.indexOf("--zf--")+6,date1.length);if(""!=fromDate&&""!=toDate&&""!=inputdate){var day1=getDayDifference(fromDate,inputdate,dateFormat,dateLocale),day2=getDayDifference(inputdate,toDate,dateFormat,dateLocale);if(day1>0&&day2>0)return!0}return!1}function dateComparision(date1,date2,dateFormat,dateLocale){if(""!=date1&&""!=date2&&getDayDifference(date1,date2,dateFormat,dateLocale)>0)return!0;return!1}function getDayDifference(date1,date2,dateFormat,dateLocale){var d1=ZFUtil.splitDateVal(date1,dateFormat,dateLocale),formatdate1=new Date(d1[2],d1[1],d1[0]),d2=ZFUtil.splitDateVal(date2,dateFormat,dateLocale),formatdate2=new Date(d2[2],d2[1],d2[0]);return Math.round((formatdate2.getTime()-formatdate1.getTime())/864e5)}function evalBoolExp(expStr){return-1!==expStr.indexOf("&&")?-1===expStr.indexOf("false"):-1!==expStr.indexOf("||")?-1!==expStr.indexOf("true"):"true"===expStr}function evalDateTimeCondn(condnObj,dateFormat,dateLocale,fldElem){var condnOper=condnObj[ZFRuleConstants.OPERATOR],userEnteredDateTime=$.trim($(fldElem).find(":text").val()),timeFormat=$(fldElem).attr("timeformat");if(ZFUtil.validateDateTime(userEnteredDateTime,dateFormat,dateLocale,timeFormat)){if(condnOper===Operators.EQUALS)return areDateTimeValuesEqual(condnObj[ZFRuleConstants.CONDN_VALUE],userEnteredDateTime,dateFormat,dateLocale,timeFormat);if(condnOper===Operators.NOT_EQUAL)return areDateTimeValuesNotEqual(condnObj[ZFRuleConstants.CONDN_VALUE],userEnteredDateTime,dateFormat,dateLocale,timeFormat);if(condnOper===Operators.IS_EMPTY){if(""===userEnteredDateTime)return!0}else if(condnOper===Operators.IS_NOT_EMPTY){if(""!==userEnteredDateTime)return!0}else{if(condnOper===Operators.LESS_THAN)return compareDateTimeValues(userEnteredDateTime,condnObj[ZFRuleConstants.CONDN_VALUE],dateFormat,dateLocale,timeFormat);if(condnOper===Operators.GREATER_THAN)return compareDateTimeValues(condnObj[ZFRuleConstants.CONDN_VALUE],userEnteredDateTime,dateFormat,dateLocale,timeFormat);if(condnOper===Operators.BETWEEN)return isDateTimeBetween(userEnteredDateTime,condnObj[ZFRuleConstants.CONDN_VALUE],dateFormat,dateLocale,timeFormat)}}return!1}function areDateTimeValuesEqual(condnDateTime,userEnteredDateTime,dateFormat,dateLocale,timeFormat){if(""!==condnDateTime&&""!==userEnteredDateTime){var condnDate=getDateFromDateTimeValue(condnDateTime);if(dateComparision_Equal(getDateFromDateTimeValue(userEnteredDateTime),condnDate,dateFormat,dateLocale,Operators.EQUALS)){var userEnteredTime=getTimeFromDateTimeValue(userEnteredDateTime);userEnteredTime=userEnteredTime.replace(" ",":");var condnTime=getTimeFromDateTimeValue(condnDateTime);if(compareTimeWithLocale(userEnteredTime,condnTime=condnTime.replace(" ",":"),dateLocale,timeFormat)===Num_Status.EQUAL)return!0}}return!1}function areDateTimeValuesNotEqual(condnDateTime,userEnteredDateTime,dateFormat,dateLocale,timeFormat){if(""!==condnDateTime&&""!==userEnteredDateTime){var condnDate=getDateFromDateTimeValue(condnDateTime);if(dateComparision_Equal(getDateFromDateTimeValue(userEnteredDateTime),condnDate,dateFormat,dateLocale,Operators.NOT_EQUAL))return!0;var userEnteredTime=getTimeFromDateTimeValue(userEnteredDateTime);userEnteredTime=userEnteredTime.replace(" ",":");var condnTime=getTimeFromDateTimeValue(condnDateTime);if(compareTimeWithLocale(userEnteredTime,condnTime=condnTime.replace(" ",":"),dateLocale,timeFormat)===Num_Status.LESSER||compareTimeWithLocale(userEnteredTime,condnTime,dateLocale,timeFormat)===Num_Status.GREATER)return!0}return!1}function compareDateTimeValues(dateTime1,dateTime2,dateFormat,dateLocale,timeFormat){if(""!==dateTime1&&""!==dateTime2){var diffInDays=getDayDifference(getDateFromDateTimeValue(dateTime1),getDateFromDateTimeValue(dateTime2),dateFormat,dateLocale);if(diffInDays>0)return!0;if(0===diffInDays){var time1=getTimeFromDateTimeValue(dateTime1);time1=time1.replace(" ",":");var time2=getTimeFromDateTimeValue(dateTime2);if(compareTimeWithLocale(time1,time2=time2.replace(" ",":"),dateLocale,timeFormat)===Num_Status.LESSER)return!0}}return!1}function isDateTimeBetween(userEnteredDateTime,zfSeparatedCondnDateTime,dateFormat,dateLocale,timeFormat){if(""!==userEnteredDateTime){var condnDateTimesArray=zfSeparatedCondnDateTime.split(Separators.ZF_SEPARATOR);if(compareDateTimeValues(condnDateTimesArray[0],userEnteredDateTime,dateFormat,dateLocale,timeFormat)&&compareDateTimeValues(userEnteredDateTime,condnDateTimesArray[1],dateFormat,dateLocale,timeFormat))return!0}return!1}function getDateFromDateTimeValue(dateTime){return dateTime.substring(0,dateTime.indexOf(" "))}function getTimeFromDateTimeValue(dateTime){return dateTime.substring(dateTime.indexOf(" ")+1,dateTime.length)}function compareTime(timeValue1,timeValue2){var timeValues=[];timeValues[0]=timeValue1,timeValues[1]=timeValue2;var splittedTimeValues=[],meridianValues=[];for(var ind in timeValues){var timeVal=timeValues[ind],firstColonIndex=timeVal.indexOf(":");if(0===firstColonIndex)return Num_Status.INVALID;var secondColonIndex=timeVal.lastIndexOf(":");if(firstColonIndex+1===secondColonIndex)return Num_Status.INVALID;if(secondColonIndex+1===timeVal.length)return Num_Status.INVALID;var hrVal=parseInt(timeVal.substring(0,firstColonIndex));12===hrVal&&(hrVal=0);var timeInMin=60*hrVal+parseInt(timeVal.substring(firstColonIndex+1,secondColonIndex));splittedTimeValues.push(timeInMin);var meridianVal=timeVal.substring(secondColonIndex+1,timeVal.length);meridianValues.push(meridianVal)}return meridianValues[0]!==meridianValues[1]?meridianValues[0]===Meridian.AM?Num_Status.LESSER:Num_Status.GREATER:splittedTimeValues[0]===splittedTimeValues[1]?Num_Status.EQUAL:splittedTimeValues[0]>splittedTimeValues[1]?Num_Status.GREATER:splittedTimeValues[0]<splittedTimeValues[1]?Num_Status.LESSER:Num_Status.INVALID}function compareTimeWithLocale(timeValue1,timeValue2,dateLocale,timeFormat){var timeValues=[];timeValues[0]=timeValue1,timeValues[1]=timeValue2;var splittedTimeValues=[],meridianValues=[];for(var ind in timeValues){var timeVal=timeValues[ind],firstColonIndex=timeVal.indexOf(":");if(0===firstColonIndex)return Num_Status.INVALID;var hrVal=parseInt(timeVal.substring(0,firstColonIndex));timeFormat==TimeFormat.HOURS_12.CODE&&12===hrVal&&(hrVal=0);var minVal=parseInt(timeVal.substring(firstColonIndex+1,timeVal.length));if(timeFormat==TimeFormat.HOURS_12.CODE){var secondColonIndex=timeVal.lastIndexOf(":");if(firstColonIndex+1===secondColonIndex)return Num_Status.INVALID;if(secondColonIndex+1===timeVal.length)return Num_Status.INVALID;minVal=parseInt(timeVal.substring(firstColonIndex+1,secondColonIndex));var meridianVal=timeVal.substring(secondColonIndex+1,timeVal.length);meridianValues.push(meridianVal)}var timeInMin=60*hrVal+minVal;splittedTimeValues.push(timeInMin)}return timeFormat==TimeFormat.HOURS_12.CODE&&meridianValues[0]!==meridianValues[1]?meridianValues[0]===CustomDateLocale[dateLocale].AM?Num_Status.LESSER:Num_Status.GREATER:splittedTimeValues[0]===splittedTimeValues[1]?Num_Status.EQUAL:splittedTimeValues[0]>splittedTimeValues[1]?Num_Status.GREATER:splittedTimeValues[0]<splittedTimeValues[1]?Num_Status.LESSER:Num_Status.INVALID}function compareTimeWithFormat(timeValue1,timeValue2,timeFormat){var timeValues=[];timeValues[0]=timeValue1,timeValues[1]=timeValue2;var splittedTimeValues=[],meridianValues=[];if(1==timeFormat){for(var ind in timeValues){if(0===(firstColonIndex=(timeVal=timeValues[ind]).indexOf(":")))return Num_Status.INVALID;var secondColonIndex=timeVal.lastIndexOf(":");if(firstColonIndex+1===secondColonIndex)return Num_Status.INVALID;if(secondColonIndex+1===timeVal.length)return Num_Status.INVALID;12===(hrVal=parseInt(timeVal.substring(0,firstColonIndex)))&&(hrVal=0);var timeInMin=60*hrVal+parseInt(timeVal.substring(firstColonIndex+1,secondColonIndex));splittedTimeValues.push(timeInMin);var meridianVal=timeVal.substring(secondColonIndex+1,timeVal.length);meridianValues.push(meridianVal)}if(meridianValues[0]!==meridianValues[1])return meridianValues[0]===Meridian.AM?Num_Status.LESSER:Num_Status.GREATER}else if(2==timeFormat)for(var ind in timeValues){var timeVal,firstColonIndex;if(0===(firstColonIndex=(timeVal=timeValues[ind]).indexOf(":")))return Num_Status.INVALID;if(firstColonIndex===timeVal.length)return Num_Status.INVALID;var hrVal;timeInMin=60*(hrVal=parseInt(timeVal.substring(0,firstColonIndex)))+parseInt(timeVal.substring(firstColonIndex+1,timeVal.length));splittedTimeValues.push(timeInMin)}return splittedTimeValues[0]===splittedTimeValues[1]?Num_Status.EQUAL:splittedTimeValues[0]>splittedTimeValues[1]?Num_Status.GREATER:splittedTimeValues[0]<splittedTimeValues[1]?Num_Status.LESSER:Num_Status.INVALID}function setWidthForSignatureElem(elem){if($(elem).is(":visible")){var canvasEle=$(elem).find("canvas")[0];void 0!==canvasEle&&0==canvasEle.width&&(canvasEle.width=$(elem).find("div[elname=signContainer]").width())}}function check_OthersNotEmpty(inpVal,fldLnkName){var fldElem=getFieldElem(fldLnkName);return"zfs-others-zfs"==$.trim(fldElem.find("input:radio:checked").val())&&0!=inpVal.length}function check_IsAnyOne(condValue,inpVal){return!check_EmptyValue(inpVal)&&-1!=$.inArray(inpVal,condValue)}function check_IsNotAll(condValue,inpVal){return!(!check_EmptyValue(inpVal)&&-1!=$.inArray(inpVal,condValue))}function check_ContainsAnyOne(condValue,inpVal){if(!check_EmptyValue(inpVal))for(var index=0;index<condValue.length;index++){var condStr=condValue[index];if(-1!=$.inArray(condStr,inpVal))return!0}return!1}function check_ContainsAll(condValue,inpVal){if(!check_EmptyValue(inpVal)){for(var index=0;index<condValue.length;index++){var condStr=condValue[index];if(-1==$.inArray(condStr,inpVal))return!1}return!0}return!1}function check_NotContainsAll(condValue,inpVal){if(!check_EmptyValue(inpVal))for(var index=0;index<condValue.length;index++){var condStr=condValue[index];if(-1!=$.inArray(condStr,inpVal))return!1}return!0}function ZFPageRule(){this.fieldElemsInConditionsList=[],this.pageConditions={},this.fromPageList=[],this.path=[],this.pageRules={}}ZFRule.prototype.getRules=function(url,fromPage){var ajaxOpts={URI:url,METHOD:ZFHttp.GET,ACCEPT:"application/json",CALLBACK:function(jsonData,ajaxOpts){if(jsonData){zf_rule.rulemeta=jsonData,zfPageRule.pageRules=jsonData[ZFRuleConstants.FORM][PageRule.KEYS.PAGE_RULES],zf_rule.formBodyDiv=$("#formBodyDiv");var dateFormatInp=$("#zf_date_format");zf_rule.dateLocale=dateFormatInp.attr("dateLocale"),zf_rule.dateFormat=dateFormatInp.val(),zf_rule.init(),bindevents(),preEvalRules(),"{}"!==JSON.stringify(zfPageRule.pageRules)&&$("#navigBar").parent().addClass("pBarcursor_remove"),initPageRules(),void 0!==ZFLive&&null!=ZFLive.formulaJson&&ZFLive.evalExpressionOnFormLoad(),1==$("#formBodyDiv").find("ul[elname=formBodyULName]").length&&document.getElementById("recaptcha_checkbox")?triggerFormResize(100):triggerFormResize()}fromPage!=undefined&&"pdfPrint"==fromPage&&("{}"!==JSON.stringify(zfPageRule.pageRules)&&evalPageRulesForPdf(),customizingFormForPdf())}};ZFUtil.sendAjax(ajaxOpts,this)},ZFRule.prototype.getFormRules=function(url,csrf,fromPage){var ajaxOpts={URI:url,METHOD:ZFHttp.GET,CSRF:csrf,ACCEPT:"application/zoho.forms-v3+json",CALLBACK:function(jsonData,ajaxOpts){if(jsonData){zf_rule.rulemeta=jsonData,zf_rule.formBodyDiv=$("#formBodyDiv");var dateFormatInp=$("#zf_date_format");zf_rule.dateLocale=dateFormatInp.attr("dateLocale"),zf_rule.dateFormat=dateFormatInp.val(),zf_rule.init(),bindevents(),preEvalRules(),null!=ZFLive.formulaJson&&ZFLive.evalExpressionOnFormLoad()}fromPage!=undefined&&"pdfPrint"==fromPage&&customizingFormForPdf()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFRule.prototype.init=function(){var zfArr=[],rulesArr=this.rulemeta[ZFRuleConstants.FORM][ZFRuleConstants.FIELD_RULES];for(var i in rulesArr){var zffieldRule=new ZFFieldRule,rule_conditions=rulesArr[i][ZFRuleConstants.CONDITIONS],rule_actions=rulesArr[i][ZFRuleConstants.ACTIONS],rule_oper=rulesArr[i][ZFRuleConstants.LOGICAL_OPER];for(var x in zffieldRule.ruleid=rulesArr[i].rule_id,zffieldRule.oper=getLogicalOper(rule_oper),rule_conditions){var zfRuleCond=new ZFCondition;zfRuleCond.fieldLinkName=rule_conditions[x][ZFRuleConstants.FIELD_LINK_NAME],zffieldRule.fieldElems.push(zfRuleCond.fieldLinkName),zfRuleCond.operator=rule_conditions[x][ZFRuleConstants.COMP_OPER],rule_conditions[x][ZFRuleConstants.VALUE_ARRAY]!=undefined?zfRuleCond.condValue=rule_conditions[x][ZFRuleConstants.VALUE_ARRAY]:zfRuleCond.condValue=rule_conditions[x][ZFRuleConstants.VALUE],zfRuleCond.rowLinkName=rule_conditions[x][ZFRuleConstants.ROW_LINK_NAME],zffieldRule.conditionsObj[rule_conditions[x].condition_id]=zfRuleCond,rule_conditions[x].hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)&&(zfRuleCond.group_name=rule_conditions[x][ZFRuleConstants.FIELD.OPT_GROUP_NAME])}for(var y in rule_actions){var zfAction=new ZFAction;zfAction.ruleaction=rule_actions[y][ZFRuleConstants.ACTION],zfAction.actionLinkName=rule_actions[y][ZFRuleConstants.FIELD_LINK_NAME],rule_actions[y][ZFRuleConstants.ACTION]!=ZFRuleConstants.SHOW_GROUP&&rule_actions[y][ZFRuleConstants.ACTION]!=ZFRuleConstants.HIDE_GROUP||(zfAction.group_name=rule_actions[y][ZFRuleConstants.FIELD.OPT_GROUP_NAME]),zffieldRule.actionsObj[rule_actions[y][ZFRuleConstants.ACTION_ID]]=zfAction}zfArr[i]=zffieldRule}zf_rule.zfRules=zfArr},ZFRule.prototype.evalRules=function(elem,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var compname=getCompName(elem);for(var i in zf_rule.zfRules)if(-1!=$.inArray(compname,zf_rule.zfRules[i].fieldElems))for(var x in zf_rule.zfRules[i].conditionsObj){var result=!1,fldLinkElem=zf_rule.formBodyDiv.find("li#"+zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.FieldLinkName]+"-li"),compType=parseInt(fldLinkElem.attr("comptype"));"true"==$(fldLinkElem).attr("needdata")&&"true"==$(fldLinkElem).parent("ul").attr("needpagedata")&&(result=compType===ZFFieldTypeConstants.DATE?evalDateCondition(zf_rule.zfRules[i].conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.DATETIME?evalDateTimeCondn(zf_rule.zfRules[i].conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.TIME?evalTimeCondition(zf_rule.zfRules[i].conditionsObj[x],fldLinkElem):evalCondition(zf_rule.zfRules[i].conditionsObj[x],compType)),zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.RESULT]=result}var str="";for(var i in zf_rule.zfRules)if(-1!=$.inArray(compname,zf_rule.zfRules[i].fieldElems)){var cnt=1,size=0;for(var x in zf_rule.zfRules[i].conditionsObj)size++;for(var x in zf_rule.zfRules[i].conditionsObj)cnt!=size?str=str+zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.RESULT]+zf_rule.zfRules[i].oper:str+=zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.RESULT],cnt++;if(evalBoolExp($.trim(str))){if(-1==$.inArray(zf_rule.zfRules[i].ruleid,evalAllRulesArr))for(var y in evalAllRulesArr.push(zf_rule.zfRules[i].ruleid),zf_rule.zfRules[i].actionsObj)zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW||zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE?evalAction(zf_rule.zfRules[i].actionsObj[y],zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.ACTION_LINK_NAME],zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION],evalAllRulesArr,groupActionVisibleHiddenJsonObj):zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]!=ZFRuleConstants.SHOW_GROUP&&zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]!=ZFRuleConstants.HIDE_GROUP||evalGroupAction(zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.ACTION_LINK_NAME],zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION],groupActionVisibleHiddenJsonObj)}else disableAction(zf_rule.zfRules[i],evalAllRulesArr,groupActionVisibleHiddenJsonObj);str=""}};var PageRule={KEYS:{PAGE_RULES:"page_rules",ACTION_TYPE:"action_type",CONDITIONED_RULE:"conditioned_rule",DEFAULT_RULE:"default_rule",LOGICAL_OPER:"logical_oper",TO_PAGE:"to_page_link_name"},CONDITIONS:{KEY:"conditions",CONDN_NAME:"condition_name",CONDN_LINK_NAME:"condition",FIELD_LINK_NAME:"field_link_name",ROW_LINK_NAME:"row_link_name",COMPARISON_OPER:"comparison_oper",VALUE:"value",VALUE_ARRAY:"value_array",ROW_VALUE:"row",OPT_GROUP_NAME:"group_name"},CONSTANTS:{CONDITIONED_RULE:1,DEFAULT_RULE:2}};function isPageInPath(pageNo){return-1!=$.inArray(pageNo,zfPageRule.path)}function initPageRules(){for(var key in zfPageRule.pageRules)zfPageRule.fromPageList.push(key)}function sortList(){zfPageRule.path.sort(function(a,b){return a-b})}function evalRulesAndGetNextPageNo(currentPageNo){return reinitialisePathAndEvalPageRules(currentPageNo),getNextPageNo(currentPageNo)}function reinitialisePathAndEvalPageRules(currentPageNo){var pageNo=1;for(zfPageRule.path=[],addPageNumInList(pageNo);pageNo<=currentPageNo;)evalPageRules(pageNo),pageNo=getNextPageNo(pageNo)}function getNextPageNo(currentPageNo){var nextPageNo;return sortList(),$.each(zfPageRule.path,function(idx,pageNo){if(pageNo>currentPageNo)return nextPageNo=pageNo,!1}),nextPageNo}function evalPageRules(pageNo){var pageLinkName=getPageLinkNameFromPageNum(pageNo);if(-1!=$.inArray(pageLinkName,zfPageRule.fromPageList)){var pageRule=zfPageRule.pageRules[pageLinkName];pageRule[PageRule.KEYS.ACTION_TYPE]==PageRule.CONSTANTS.CONDITIONED_RULE?evalConditionedRule(pageRule):evalDefaultRule(pageRule[PageRule.KEYS.DEFAULT_RULE])}else addPageNumInList(parseInt(pageNo)+1)}function addPageNumInList(pageNo){pageNo=parseInt(pageNo),-1==$.inArray(pageNo,zfPageRule.path)&&zfPageRule.path.push(pageNo)}function evalConditionedRule(pageRule){var flag=!1,conditionedRuleList=pageRule[PageRule.KEYS.CONDITIONED_RULE];$.each(conditionedRuleList,function(idx,conditionedRule){evalConditions(conditionedRule[PageRule.CONDITIONS.KEY],conditionedRule[PageRule.KEYS.LOGICAL_OPER])&&(flag=!0,addPageNumInList(getPageNumFromLinkName(conditionedRule[PageRule.KEYS.TO_PAGE])))}),flag||evalDefaultRule(pageRule[PageRule.KEYS.DEFAULT_RULE])}function evalDefaultRule(defaultRule){addPageNumInList(getPageNumFromLinkName(defaultRule[PageRule.KEYS.TO_PAGE]))}function getPageNumFromLinkName(pageLinkName){return $("#formRedirectURL").find("ul[elname=footer][page_link_name="+pageLinkName+"]").attr("page_no")}function getPageLinkNameFromPageNum(pageNo){return $("#formRedirectURL").find("ul[elname=footer][page_no="+pageNo+"]").attr("page_link_name")}function getConditionObj(condition){var condObj={};return condObj.fieldLinkName=condition[PageRule.CONDITIONS.FIELD_LINK_NAME],condObj.operator=condition[PageRule.CONDITIONS.COMPARISON_OPER],condition.hasOwnProperty(PageRule.CONDITIONS.VALUE_ARRAY)?condObj.condValue=condition[PageRule.CONDITIONS.VALUE_ARRAY]:condObj.condValue=condition[PageRule.CONDITIONS.VALUE],condition.hasOwnProperty(PageRule.CONDITIONS.ROW_LINK_NAME)?condObj.rowLinkName=condition[PageRule.CONDITIONS.ROW_LINK_NAME]:condition.hasOwnProperty(PageRule.CONDITIONS.OPT_GROUP_NAME)&&(condObj.group_name=condition[PageRule.CONDITIONS.OPT_GROUP_NAME]),condObj}function evalConditions(conditionList,logicalOper){var finalResult=null;return $.each(conditionList,function(i,condition){var result=!1,condLiElem=$("#formBodyDiv").find("li[compname="+condition.field_link_name+"]"),needPageData=$(condLiElem).parent("ul").attr("needpagedata");if("true"==condLiElem.attr("needdata")&&"true"==needPageData){var condElemCompType=condLiElem.attr("comptype"),condObj=getConditionObj(condition);result=condElemCompType==ZFFieldTypeConstants.DATE?evalDateCondition(condObj,zf_rule.dateFormat,zf_rule.dateLocale,condLiElem):condElemCompType==ZFFieldTypeConstants.DATETIME?evalDateTimeCondn(condObj,zf_rule.dateFormat,zf_rule.dateLocale,condLiElem):condElemCompType==ZFFieldTypeConstants.TIME?evalTimeCondition(condObj,condLiElem):evalCondition(condObj,condElemCompType)}if(null!=finalResult){if("matchany"==logicalOper){if(finalResult=finalResult||result)return!1}else if(!(finalResult=finalResult&&result))return!1}else finalResult=result}),finalResult}function getCondValueForTime(val){if(val!=undefined&&""!=val)return val.replace(/\s/g,":")}function evalPageRulesForPdf(){for(var pageNo=1,formBodyUl=$("#formBodyUL");pageNo<pageCount;){reinitialisePathAndEvalPageRules(pageNo);var nextPageNo=getNextPageNo(pageNo);for(pageNo++;pageNo<nextPageNo;){var liElem=formBodyUl.find("li[page_no="+pageNo+"]");liElem.attr("needdata",!1),reEvalFieldRulesForPdf(liElem),liElem.attr("needdata",!1),pageNo++}}hideHiddenPageFields()}function hideHiddenPageFields(){for(var pageNo=1,formBodyUl=$("#formBodyUL");pageNo<pageCount;){var nextPageNo=getNextPageNo(pageNo);for(pageNo++;pageNo<nextPageNo;)formBodyUl.find("li[page_no="+pageNo+"]").hide(),pageNo++}}function reEvalFieldRulesForPdf(liEle){liEle.each(function(index,elem){reEvalFieldRules(elem)})}var countryUniqueCode={101:"af",102:"al",103:"dz",104:"as",105:"ad",106:"ao",107:"ai",108:"ag",109:"ar",110:"am",111:"aw",112:"au",113:"at",114:"az",115:"bs",116:"bh",117:"bd",118:"bb",119:"by",120:"be",121:"bz",122:"bj",123:"bm",124:"bt",125:"bo",126:"ba",127:"bw",128:"br",129:"io",130:"vg",131:"bn",132:"bg",133:"bf",134:"bi",135:"kh",136:"cm",137:"ca",138:"cv",139:"bq",140:"ky",141:"cf",142:"td",143:"cl",144:"cn",145:"cx",146:"cc",147:"co",148:"km",149:"cd",150:"cg",151:"ck",152:"cr",153:"ci",154:"hr",155:"cu",156:"cw",157:"cy",158:"cz",159:"dk",160:"dj",161:"dm",162:"do",163:"ec",164:"eg",165:"sv",166:"gq",167:"er",168:"ee",169:"et",170:"fk",171:"fo",172:"fj",173:"fi",174:"fr",175:"gf",176:"pf",177:"ga",178:"gm",179:"ge",180:"de",181:"gh",182:"gi",183:"gr",184:"gl",185:"gd",186:"gp",187:"gu",188:"gt",189:"gg",190:"gn",191:"gw",192:"gy",193:"ht",194:"hn",195:"hk",196:"hu",197:"is",198:"in",199:"id",200:"ir",201:"iq",202:"ie",203:"im",204:"il",205:"it",206:"jm",207:"jp",208:"je",209:"jo",210:"kz",211:"ke",212:"ki",213:"xk",214:"kw",215:"kg",216:"la",217:"lv",218:"lb",219:"ls",220:"lr",221:"ly",222:"li",223:"lt",224:"lu",225:"mo",226:"mk",227:"mg",228:"mw",229:"my",230:"mv",231:"ml",232:"mt",233:"mh",234:"mq",235:"mr",236:"mu",237:"yt",238:"mx",239:"fm",240:"md",241:"mc",242:"mn",243:"me",244:"ms",245:"ma",246:"mz",247:"mm",248:"na",249:"nr",250:"np",251:"nl",252:"nc",253:"nz",254:"ni",255:"ne",256:"ng",257:"nu",258:"nf",259:"kp",260:"mp",261:"no",262:"om",263:"pk",264:"pw",265:"ps",266:"pa",267:"pg",268:"py",269:"pe",270:"ph",271:"pl",272:"pt",273:"pr",274:"qa",275:"re",276:"ro",277:"ru",278:"rw",279:"bl",280:"sh",281:"kn",282:"lc",283:"mf",284:"pm",285:"vc",286:"ws",287:"sm",288:"st",289:"sa",290:"sn",291:"rs",292:"sc",293:"sl",294:"sg",295:"sx",296:"sk",297:"si",298:"sb",299:"so",300:"za",301:"kr",302:"ss",303:"es",304:"lk",305:"sd",306:"sr",307:"sj",308:"sz",309:"se",310:"ch",311:"sy",312:"tw",313:"tj",314:"tz",315:"th",316:"tl",317:"tg",318:"tk",319:"to",320:"tt",321:"tn",322:"tr",323:"tm",324:"tc",325:"tv",326:"vi",327:"ug",328:"ua",329:"ae",330:"gb",331:"us",332:"uy",333:"uz",334:"vu",335:"va",336:"ve",337:"vn",338:"wf",339:"eh",340:"ye",341:"zm",342:"zw",343:"ax"},countrylists={101:"Afghanistan",102:"Albania",103:"Algeria",104:"American Samoa",105:"Andorra",106:"Angola",107:"Anguilla",108:"Antigua and Barbuda",109:"Argentina",110:"Armenia",111:"Aruba",112:"Australia",113:"Austria",114:"Azerbaijan",115:"Bahamas",116:"Bahrain",117:"Bangladesh",118:"Barbados",119:"Belarus",120:"Belgium",121:"Belize",122:"Benin",123:"Bermuda",124:"Bhutan",125:"Bolivia",126:"Bosnia and Herzegovina",127:"Botswana",128:"Brazil",129:"British Indian Ocean Territory",130:"British Virgin Islands",131:"Brunei",132:"Bulgaria",133:"Burkina Faso",134:"Burundi",135:"Cambodia",136:"Cameroon",137:"Canada",138:"Cape Verde",139:"Caribbean Netherlands",140:"Cayman Islands",141:"Central African Republic",142:"Chad",143:"Chile",144:"China",145:"Christmas Island",146:"Cocos (Keeling) Islands",147:"Colombia",148:"Comoros",149:"Congo (DRC)",150:"Congo (Republic)",151:"Cook Islands",152:"Costa Rica",153:"Cote d’Ivoire",154:"Croatia",155:"Cuba",156:"Curacao",157:"Cyprus",158:"Czech Republic",159:"Denmark",160:"Djibouti",161:"Dominica",162:"Dominican Republic",163:"Ecuador",164:"Egypt",165:"El Salvador",166:"Equatorial Guinea",167:"Eritrea",168:"Estonia",169:"Ethiopia",170:"Falkland Islands",171:"Faroe Islands",172:"Fiji",173:"Finland",174:"France",175:"French Guiana",176:"French Polynesia",177:"Gabon",178:"Gambia",179:"Georgia",180:"Germany",181:"Ghana",182:"Gibraltar",183:"Greece",184:"Greenland",185:"Grenada",186:"Guadeloupe",187:"Guam",188:"Guatemala",189:"Guernsey",190:"Guinea",191:"Guinea-Bissau",192:"Guyana",193:"Haiti",194:"Honduras",195:"Hong Kong",196:"Hungary",197:"Iceland",198:"India",199:"Indonesia",200:"Iran",201:"Iraq",202:"Ireland",203:"Isle of Man",204:"Israel",205:"Italy",206:"Jamaica",207:"Japan",208:"Jersey",209:"Jordan",210:"Kazakhstan",211:"Kenya",212:"Kiribati",213:"Kosovo",214:"Kuwait",215:"Kyrgyzstan",216:"Laos",217:"Latvia",218:"Lebanon",219:"Lesotho",220:"Liberia",221:"Libya",222:"Liechtenstein",223:"Lithuania",224:"Luxembourg",225:"Macau",226:"Macedonia",227:"Madagascar",228:"Malawi",229:"Malaysia",230:"Maldives",231:"Mali",232:"Malta",233:"Marshall Islands",234:"Martinique",235:"Mauritania",236:"Mauritius",237:"Mayotte",238:"Mexico",239:"Micronesia",240:"Moldova",241:"Monaco",242:"Mongolia",243:"Montenegro",244:"Montserrat",245:"Morocco",246:"Mozambique",247:"Myanmar",248:"Namibia",249:"Nauru",250:"Nepal",251:"Netherlands",252:"New Caledonia",253:"New Zealand",254:"Nicaragua",255:"Niger",256:"Nigeria",257:"Niue",258:"Norfolk Island",259:"North Korea",260:"Northern Mariana Islands",261:"Norway",262:"Oman",263:"Pakistan",264:"Palau",265:"Palestine",266:"Panama",267:"Papua New Guinea",268:"Paraguay",269:"Peru",270:"Philippines",271:"Poland",272:"Portugal",273:"Puerto Rico",274:"Qatar",275:"Réunion",276:"Romania",277:"Russia",278:"Rwanda",279:"Saint Barthélemy",280:"Saint Helena",281:"Saint Kitts and Nevis",282:"Saint Lucia",283:"Saint Marti",284:"Saint Pierre and Miquelon",285:"Saint Vincent and the Grenadines",286:"Samoa",287:"San Marino",288:"São Tomé and Príncipe",289:"Saudi Arabia",290:"Senegal",291:"Serbia",292:"Seychelles",293:"Sierra Leone",294:"Singapore",295:"Sint Maarten",296:"Slovakia",297:"Slovenia",298:"Solomon Islands",299:"Somalia",300:"South Africa",301:"South Korea",302:"South Sudan",303:"Spain",304:"Sri Lanka",305:"Sudan",306:"Suriname",307:"Svalbard and Jan Mayen",308:"Swaziland",309:"Sweden",310:"Switzerland",311:"Syria",312:"Taiwan",313:"Tajikistan",314:"Tanzania",315:"Thailand",316:"Timor-Leste",317:"Togo",318:"Tokelau",319:"Tonga",320:"Trinidad and Tobago",321:"Tunisia",322:"Turkey",323:"Turkmenistan",324:"Turks and Caicos Islands",325:"Tuvalu",326:"U.S. Virgin Islands",327:"Uganda",328:"Ukraine",329:"United Arab Emirates",330:"United Kingdom",331:"United States",332:"Uruguay",333:"Uzbekistan",334:"Vanuatu",335:"Vatican City",336:"Venezuela",337:"Vietnam",338:"Wallis and Futuna",339:"Western Sahara ",340:"Yemen",341:"Zambia",342:"Zimbabwe",343:"Åland Islands"},codelist={101:"+93",102:"+355",103:"+213",104:"+1684",105:"+376",106:"+244",107:"+1264",108:"+1268",109:"+54",110:"+374",111:"+297",112:"+61",113:"+43",114:"+994",115:"+1242",116:"+973",117:"+880",118:"+1246",119:"+375",120:"+32",121:"+501",122:"+229",123:"+1441",124:"+975",125:"+591",126:"+387",127:"+267",128:"+55",129:"+246",130:"+1284",131:"+673",132:"+359",133:"+226",134:"+257",135:"+855",136:"+237",137:"+1",138:"+238",139:"+599",140:"+1345",141:"+236",142:"+235",143:"+56",144:"+86",145:"+61",146:"+61",147:"+57",148:"+269",149:"+243",150:"+242",151:"+682",152:"+506",153:"+225",154:"+385",155:"+53",156:"+599",157:"+357",158:"+420",159:"+45",160:"+253",161:"+1767",162:"+1",163:"+593",164:"+20",165:"+503",166:"+240",167:"+291",168:"+372",169:"+251",170:"+500",171:"+298",172:"+679",173:"+358",174:"+33",175:"+594",176:"+689",177:"+241",178:"+220",179:"+995",180:"+49",181:"+233",182:"+350",183:"+30",184:"+299",185:"+1473",186:"+590",187:"+1671",188:"+502",189:"+44",190:"+224",191:"+245",192:"+592",193:"+509",194:"+504",195:"+852",196:"+36",197:"+354",198:"+91",199:"+62",200:"+98",201:"+964",202:"+353",203:"+44",204:"+972",205:"+39",206:"+1876",207:"+81",208:"+44",209:"+962",210:"+7",211:"+254",212:"+686",213:"+383",214:"+965",215:"+996",216:"+856",217:"+371",218:"+961",219:"+266",220:"+231",221:"+218",222:"+423",223:"+370",224:"+352",225:"+853",226:"+389",227:"+261",228:"+265",229:"+60",230:"+960",231:"+223",232:"+356",233:"+692",234:"+596",235:"+222",236:"+230",237:"+262",238:"+52",239:"+691",240:"+373",241:"+377",242:"+976",243:"+382",244:"+1664",245:"+212",246:"+258",247:"+95",248:"+264",249:"+674",250:"+977",251:"+31",252:"+687",253:"+64",254:"+505",255:"+227",256:"+234",257:"+683",258:"+672",259:"+850",260:"+1670",261:"+47",262:"+968",263:"+92",264:"+680",265:"+970",266:"+507",267:"+675",268:"+595",269:"+51",270:"+63",271:"+48",272:"+351",273:"+1",274:"+974",275:"+262",276:"+40",277:"+7",278:"+250",279:"+590",280:"+290",281:"+1869",282:"+1758",283:"+590",284:"+508",285:"+1784",286:"+685",287:"+378",288:"+239",289:"+966",290:"+221",291:"+381",292:"+248",293:"+232",294:"+65",295:"+1721",296:"+421",297:"+386",298:"+677",299:"+252",300:"+27",301:"+82",302:"+211",303:"+34",304:"+94",305:"+249",306:"+597",307:"+47",308:"+268",309:"+46",310:"+41",311:"+963",312:"+886",313:"+992",314:"+255",315:"+66",316:"+670",317:"+228",318:"+690",319:"+676",320:"+1868",321:"+216",322:"+90",323:"+993",324:"+1649",325:"+688",326:"+1340",327:"+256",328:"+380",329:"+971",330:"+44",331:"+1",332:"+598",333:"+998",334:"+678",335:"+39",336:"+58",337:"+84",338:"+681",339:"+212",340:"+967",341:"+260",342:"+263",343:"+358"};